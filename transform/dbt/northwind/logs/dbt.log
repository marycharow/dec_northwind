[0m21:54:52.946242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BA9090100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BAD3F7FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BAD3F7F10>]}


============================== 21:54:52.948497 | 01982bb2-2871-4fcc-9757-38c7b6a523e6 ==============================
[0m21:54:52.948497 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:54:52.948497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:54:52.948497 [info ] [MainThread]: dbt version: 1.6.0
[0m21:54:52.948497 [info ] [MainThread]: python version: 3.9.17
[0m21:54:52.948497 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m21:54:52.948497 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m21:54:56.047887 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m21:54:56.047887 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m21:54:56.047887 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m21:54:56.047887 [info ] [MainThread]: adapter type: snowflake
[0m21:54:56.047887 [info ] [MainThread]: adapter version: 1.6.2
[0m21:54:56.047887 [info ] [MainThread]: Configuration:
[0m21:54:56.047887 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:54:56.047887 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m21:54:56.056128 [info ] [MainThread]: Required dependencies:
[0m21:54:56.064135 [debug] [MainThread]: Executing "git --help"
[0m21:54:56.121598 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:54:56.121598 [debug] [MainThread]: STDERR: "b''"
[0m21:54:56.121598 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:54:56.121598 [info ] [MainThread]: Connection:
[0m21:54:56.121598 [info ] [MainThread]:   account: on22484.ca-central-1.aws
[0m21:54:56.121598 [info ] [MainThread]:   user: dbt
[0m21:54:56.130267 [info ] [MainThread]:   database: HR
[0m21:54:56.130267 [info ] [MainThread]:   warehouse: ETL
[0m21:54:56.131547 [info ] [MainThread]:   role: DBT_RW
[0m21:54:56.131547 [info ] [MainThread]:   schema: RAW
[0m21:54:56.132820 [info ] [MainThread]:   authenticator: None
[0m21:54:56.132820 [info ] [MainThread]:   private_key_path: None
[0m21:54:56.132820 [info ] [MainThread]:   token: None
[0m21:54:56.132820 [info ] [MainThread]:   oauth_client_id: None
[0m21:54:56.132820 [info ] [MainThread]:   query_tag: None
[0m21:54:56.132820 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:54:56.132820 [info ] [MainThread]:   host: None
[0m21:54:56.137847 [info ] [MainThread]:   port: None
[0m21:54:56.137847 [info ] [MainThread]:   proxy_host: None
[0m21:54:56.137847 [info ] [MainThread]:   proxy_port: None
[0m21:54:56.137847 [info ] [MainThread]:   protocol: None
[0m21:54:56.137847 [info ] [MainThread]:   connect_retries: 1
[0m21:54:56.137847 [info ] [MainThread]:   connect_timeout: None
[0m21:54:56.137847 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:54:56.144920 [info ] [MainThread]:   retry_all: False
[0m21:54:56.145923 [info ] [MainThread]:   insecure_mode: False
[0m21:54:56.149047 [info ] [MainThread]:   reuse_connections: None
[0m21:54:56.149047 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m21:54:56.149047 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:54:56.149047 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:54:56.149047 [debug] [MainThread]: On debug: select 1 as id
[0m21:54:56.149047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:58.070721 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m21:54:58.070721 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m21:54:58.070721 [debug] [MainThread]: On debug: No close available on handle
[0m21:54:58.070721 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:54:58.070721 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:54:58.070721 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml> not found

[0m21:54:58.086452 [debug] [MainThread]: Command `dbt debug` failed at 21:54:58.086452 after 5.17 seconds
[0m21:54:58.086452 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:54:58.086452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BA9090100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD5F2F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD5F2F2B0>]}
[0m21:54:58.086452 [debug] [MainThread]: Flushing usage events
[0m21:58:17.475967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01CACC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D020E27F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D020E27EB0>]}


============================== 21:58:17.491591 | 69e9b0fa-ab0e-4e59-8099-24063dc78828 ==============================
[0m21:58:17.491591 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:58:17.491591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:17.491591 [info ] [MainThread]: dbt version: 1.6.0
[0m21:58:17.491591 [info ] [MainThread]: python version: 3.9.17
[0m21:58:17.491591 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m21:58:17.491591 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m21:58:17.491591 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m21:58:17.491591 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m21:58:17.501519 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m21:58:17.517554 [info ] [MainThread]: Configuration:
[0m21:58:17.517554 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m21:58:17.517554 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:58:17.517554 [info ] [MainThread]: Required dependencies:
[0m21:58:17.517554 [debug] [MainThread]: Executing "git --help"
[0m21:58:17.566517 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:58:17.566517 [debug] [MainThread]: STDERR: "b''"
[0m21:58:17.566517 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:58:17.566517 [info ] [MainThread]: Connection test skipped since no profile was found
[0m21:58:17.566517 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:58:17.566517 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'northwind'


[0m21:58:17.574659 [debug] [MainThread]: Command `dbt debug` failed at 21:58:17.566517 after 0.11 seconds
[0m21:58:17.574659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D01CACC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D020E9C160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D020E274F0>]}
[0m21:58:17.574659 [debug] [MainThread]: Flushing usage events
[0m21:58:31.483874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182A2F30100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182A7297FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182A7297F40>]}


============================== 21:58:31.492239 | aaed5492-189b-4171-9e69-9fc482d8eab6 ==============================
[0m21:58:31.492239 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:58:31.492239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:58:31.492239 [info ] [MainThread]: dbt version: 1.6.0
[0m21:58:31.492239 [info ] [MainThread]: python version: 3.9.17
[0m21:58:31.492239 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m21:58:31.492239 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m21:58:32.666006 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m21:58:32.668019 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m21:58:32.668019 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m21:58:32.668019 [info ] [MainThread]: adapter type: snowflake
[0m21:58:32.668019 [info ] [MainThread]: adapter version: 1.6.2
[0m21:58:32.684288 [info ] [MainThread]: Configuration:
[0m21:58:32.684288 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:58:32.692462 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:58:32.692462 [info ] [MainThread]: Required dependencies:
[0m21:58:32.692462 [debug] [MainThread]: Executing "git --help"
[0m21:58:32.748715 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:58:32.748715 [debug] [MainThread]: STDERR: "b''"
[0m21:58:32.756715 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:58:32.756715 [info ] [MainThread]: Connection:
[0m21:58:32.756715 [info ] [MainThread]:   account: on22484.ca-central-1.aws
[0m21:58:32.756715 [info ] [MainThread]:   user: dbt
[0m21:58:32.756715 [info ] [MainThread]:   database: NORTHWIND
[0m21:58:32.756715 [info ] [MainThread]:   warehouse: ETL
[0m21:58:32.756715 [info ] [MainThread]:   role: DBT_RW
[0m21:58:32.764842 [info ] [MainThread]:   schema: RAW
[0m21:58:32.766405 [info ] [MainThread]:   authenticator: None
[0m21:58:32.766405 [info ] [MainThread]:   private_key_path: None
[0m21:58:32.766405 [info ] [MainThread]:   token: None
[0m21:58:32.766405 [info ] [MainThread]:   oauth_client_id: None
[0m21:58:32.766405 [info ] [MainThread]:   query_tag: None
[0m21:58:32.766405 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:58:32.766405 [info ] [MainThread]:   host: None
[0m21:58:32.772921 [info ] [MainThread]:   port: None
[0m21:58:32.772921 [info ] [MainThread]:   proxy_host: None
[0m21:58:32.772921 [info ] [MainThread]:   proxy_port: None
[0m21:58:32.772921 [info ] [MainThread]:   protocol: None
[0m21:58:32.772921 [info ] [MainThread]:   connect_retries: 1
[0m21:58:32.772921 [info ] [MainThread]:   connect_timeout: None
[0m21:58:32.772921 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:58:32.772921 [info ] [MainThread]:   retry_all: False
[0m21:58:32.772921 [info ] [MainThread]:   insecure_mode: False
[0m21:58:32.780942 [info ] [MainThread]:   reuse_connections: None
[0m21:58:32.780942 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m21:58:32.780942 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:58:32.780942 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:58:32.780942 [debug] [MainThread]: On debug: select 1 as id
[0m21:58:32.780942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:33.709718 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m21:58:33.709718 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m21:58:33.709718 [debug] [MainThread]: On debug: No close available on handle
[0m21:58:33.709718 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:58:33.725344 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:58:33.725344 [debug] [MainThread]: Command `dbt debug` succeeded at 21:58:33.725344 after 2.27 seconds
[0m21:58:33.725344 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:58:33.725344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182A2F30100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182CFDE00D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182CFDE0250>]}
[0m21:58:33.725344 [debug] [MainThread]: Flushing usage events
[0m21:59:55.503955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561882C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561CB88E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561CB88E50>]}


============================== 21:59:55.513462 | ecca9667-7bfe-43ee-833c-590e7e466202 ==============================
[0m21:59:55.513462 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:59:55.513462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:59:55.513462 [info ] [MainThread]: dbt version: 1.6.0
[0m21:59:55.513462 [info ] [MainThread]: python version: 3.9.17
[0m21:59:55.513462 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m21:59:55.513462 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m21:59:56.483585 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m21:59:56.483585 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m21:59:56.499186 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m21:59:56.499186 [info ] [MainThread]: adapter type: snowflake
[0m21:59:56.499186 [info ] [MainThread]: adapter version: 1.6.2
[0m21:59:56.515795 [info ] [MainThread]: Configuration:
[0m21:59:56.523410 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:59:56.523410 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:59:56.523410 [info ] [MainThread]: Required dependencies:
[0m21:59:56.523410 [debug] [MainThread]: Executing "git --help"
[0m21:59:56.580773 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:59:56.580773 [debug] [MainThread]: STDERR: "b''"
[0m21:59:56.580773 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:59:56.580773 [info ] [MainThread]: Connection:
[0m21:59:56.580773 [info ] [MainThread]:   account: on22484.ca-central-1.aws
[0m21:59:56.580773 [info ] [MainThread]:   user: dbt
[0m21:59:56.580773 [info ] [MainThread]:   database: NORTHWIND
[0m21:59:56.580773 [info ] [MainThread]:   warehouse: ETL
[0m21:59:56.580773 [info ] [MainThread]:   role: DBT_RW
[0m21:59:56.588888 [info ] [MainThread]:   schema: RAW
[0m21:59:56.588888 [info ] [MainThread]:   authenticator: None
[0m21:59:56.588888 [info ] [MainThread]:   private_key_path: None
[0m21:59:56.588888 [info ] [MainThread]:   token: None
[0m21:59:56.588888 [info ] [MainThread]:   oauth_client_id: None
[0m21:59:56.588888 [info ] [MainThread]:   query_tag: None
[0m21:59:56.588888 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:59:56.588888 [info ] [MainThread]:   host: None
[0m21:59:56.588888 [info ] [MainThread]:   port: None
[0m21:59:56.588888 [info ] [MainThread]:   proxy_host: None
[0m21:59:56.596993 [info ] [MainThread]:   proxy_port: None
[0m21:59:56.596993 [info ] [MainThread]:   protocol: None
[0m21:59:56.596993 [info ] [MainThread]:   connect_retries: 1
[0m21:59:56.596993 [info ] [MainThread]:   connect_timeout: None
[0m21:59:56.596993 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:59:56.596993 [info ] [MainThread]:   retry_all: False
[0m21:59:56.596993 [info ] [MainThread]:   insecure_mode: False
[0m21:59:56.596993 [info ] [MainThread]:   reuse_connections: None
[0m21:59:56.596993 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m21:59:56.596993 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:59:56.596993 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:59:56.604994 [debug] [MainThread]: On debug: select 1 as id
[0m21:59:56.604994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:57.405575 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m21:59:57.413582 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m21:59:57.413582 [debug] [MainThread]: On debug: No close available on handle
[0m21:59:57.413582 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:59:57.413582 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:59:57.413582 [debug] [MainThread]: Command `dbt debug` succeeded at 21:59:57.413582 after 1.93 seconds
[0m21:59:57.413582 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:59:57.413582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561882C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256456D0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256456C1D00>]}
[0m21:59:57.413582 [debug] [MainThread]: Flushing usage events
[0m22:00:55.079021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C2CB05E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C7017F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C704C370>]}


============================== 22:00:55.082628 | 716781e3-c7a0-4bd7-a1b5-6385ab41c246 ==============================
[0m22:00:55.082628 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:00:55.082628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select customer_type', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:00:56.402924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '716781e3-c7a0-4bd7-a1b5-6385ab41c246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C7017C70>]}
[0m22:00:56.415277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '716781e3-c7a0-4bd7-a1b5-6385ab41c246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6EFB88EE0>]}
[0m22:00:56.415277 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:00:56.420983 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:00:56.420983 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:00:56.420983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '716781e3-c7a0-4bd7-a1b5-6385ab41c246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6EFB9B400>]}
[0m22:00:57.208559 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "airbyte_territories".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("airbyte", "territories").
  
  To fix this, change the name of one of these resources:
  - source.northwind.airbyte.territories (models\raw\sources.yml)
  - source.northwind.airbyte.territories (models\raw\sources.yml)
[0m22:00:57.208559 [debug] [MainThread]: Command `dbt run` failed at 22:00:57.208559 after 2.16 seconds
[0m22:00:57.208559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C2CB05E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6EFD7F730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6EFD50B80>]}
[0m22:00:57.208559 [debug] [MainThread]: Flushing usage events
[0m22:01:28.130350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F599AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5DD07FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5DD07FD0>]}


============================== 22:01:28.145973 | 1d49d9e5-4c91-4fa9-9e42-52312b0a4f5d ==============================
[0m22:01:28.145973 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:01:28.145973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select customer_type', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:01:29.337160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d49d9e5-4c91-4fa9-9e42-52312b0a4f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F5DD07F10>]}
[0m22:01:29.352923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d49d9e5-4c91-4fa9-9e42-52312b0a4f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F06878E80>]}
[0m22:01:29.352923 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:01:29.369726 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:01:29.369726 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:01:29.377360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1d49d9e5-4c91-4fa9-9e42-52312b0a4f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0688B520>]}
[0m22:01:30.162803 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m22:01:30.166344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d49d9e5-4c91-4fa9-9e42-52312b0a4f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F06994CD0>]}
[0m22:01:30.186928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d49d9e5-4c91-4fa9-9e42-52312b0a4f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0688B340>]}
[0m22:01:30.187972 [info ] [MainThread]: Found 2 models, 14 sources, 0 exposures, 0 metrics, 372 macros, 0 groups, 0 semantic models
[0m22:01:30.188776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d49d9e5-4c91-4fa9-9e42-52312b0a4f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F06A31A90>]}
[0m22:01:30.190637 [info ] [MainThread]: 
[0m22:01:30.190637 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:01:30.193544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind'
[0m22:01:30.203406 [debug] [ThreadPool]: Using snowflake connection "list_northwind"
[0m22:01:30.203406 [debug] [ThreadPool]: On list_northwind: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m22:01:30.203406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:31.110014 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m22:01:31.110014 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:01:31.110014 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:01:31.110014 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:01:31.110014 [debug] [ThreadPool]: On list_northwind: No close available on handle
[0m22:01:31.110014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:31.110014 [debug] [MainThread]: Connection 'list_northwind' was properly closed.
[0m22:01:31.110014 [info ] [MainThread]: 
[0m22:01:31.125647 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m22:01:31.125647 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "northwind"
  Database Error
    250001 (08001): Failed to connect to DB. Verify the account name is correct: on22484.ca-central-1.aws.snowflakecomputing.com:443. HTTP 403: Forbidden
[0m22:01:31.125647 [debug] [MainThread]: Command `dbt run` failed at 22:01:31.125647 after 3.01 seconds
[0m22:01:31.125647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F599AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F06983520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F06A252E0>]}
[0m22:01:31.125647 [debug] [MainThread]: Flushing usage events
[0m22:03:27.406589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232ADF305E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B2297F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B22CB370>]}


============================== 22:03:27.406589 | 76917492-a9a3-43f2-9266-0eb832ce84ca ==============================
[0m22:03:27.406589 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:03:27.406589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select customer_type', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:03:28.496361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76917492-a9a3-43f2-9266-0eb832ce84ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B2297CA0>]}
[0m22:03:28.512884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76917492-a9a3-43f2-9266-0eb832ce84ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DAE08EE0>]}
[0m22:03:28.512884 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:03:28.531597 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:03:28.560691 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:03:28.567701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76917492-a9a3-43f2-9266-0eb832ce84ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DAF60FD0>]}
[0m22:03:29.435629 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m22:03:29.450140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76917492-a9a3-43f2-9266-0eb832ce84ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DAEA88E0>]}
[0m22:03:29.450140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76917492-a9a3-43f2-9266-0eb832ce84ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DAF6A6D0>]}
[0m22:03:29.465839 [info ] [MainThread]: Found 2 models, 14 sources, 0 exposures, 0 metrics, 372 macros, 0 groups, 0 semantic models
[0m22:03:29.467200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76917492-a9a3-43f2-9266-0eb832ce84ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DAFBC550>]}
[0m22:03:29.467200 [info ] [MainThread]: 
[0m22:03:29.467200 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:03:29.471244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind'
[0m22:03:29.482642 [debug] [ThreadPool]: Using snowflake connection "list_northwind"
[0m22:03:29.482642 [debug] [ThreadPool]: On list_northwind: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m22:03:29.482642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:30.402067 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m22:03:30.402067 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:03:30.402067 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:03:30.402067 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:03:30.402067 [debug] [ThreadPool]: On list_northwind: No close available on handle
[0m22:03:30.402067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:30.402067 [debug] [MainThread]: Connection 'list_northwind' was properly closed.
[0m22:03:30.402067 [info ] [MainThread]: 
[0m22:03:30.402067 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m22:03:30.402067 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "northwind"
  Database Error
    250001 (08001): Failed to connect to DB. Verify the account name is correct: on22484.ca-central-1.aws.snowflakecomputing.com:443. HTTP 403: Forbidden
[0m22:03:30.402067 [debug] [MainThread]: Command `dbt run` failed at 22:03:30.402067 after 3.02 seconds
[0m22:03:30.402067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232ADF305E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DB00A670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DB00A5B0>]}
[0m22:03:30.417691 [debug] [MainThread]: Flushing usage events
[0m22:15:49.224216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C2BB0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C6F17FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C6F17EE0>]}


============================== 22:15:49.224216 | 5bf5b8da-eb76-49de-a900-73814cfb9c0c ==============================
[0m22:15:49.224216 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:15:49.224216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:49.234177 [info ] [MainThread]: dbt version: 1.6.0
[0m22:15:49.234177 [info ] [MainThread]: python version: 3.9.17
[0m22:15:49.236321 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m22:15:49.236321 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m22:15:50.650883 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m22:15:50.650883 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m22:15:50.650883 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m22:15:50.655451 [info ] [MainThread]: adapter type: snowflake
[0m22:15:50.655451 [info ] [MainThread]: adapter version: 1.6.2
[0m22:15:50.675382 [info ] [MainThread]: Configuration:
[0m22:15:50.675382 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:15:50.675382 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:15:50.683403 [info ] [MainThread]: Required dependencies:
[0m22:15:50.684207 [debug] [MainThread]: Executing "git --help"
[0m22:15:50.740845 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:15:50.740845 [debug] [MainThread]: STDERR: "b''"
[0m22:15:50.740845 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:15:50.740845 [info ] [MainThread]: Connection:
[0m22:15:50.740845 [info ] [MainThread]:   account: ON22484.ca-central-1.aws
[0m22:15:50.747435 [info ] [MainThread]:   user: dbt
[0m22:15:50.748986 [info ] [MainThread]:   database: NORTHWIND
[0m22:15:50.748986 [info ] [MainThread]:   warehouse: ETL
[0m22:15:50.748986 [info ] [MainThread]:   role: DBT_RW
[0m22:15:50.748986 [info ] [MainThread]:   schema: STAGING
[0m22:15:50.755539 [info ] [MainThread]:   authenticator: None
[0m22:15:50.756552 [info ] [MainThread]:   private_key_path: None
[0m22:15:50.756552 [info ] [MainThread]:   token: None
[0m22:15:50.756552 [info ] [MainThread]:   oauth_client_id: None
[0m22:15:50.756552 [info ] [MainThread]:   query_tag: None
[0m22:15:50.761033 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:15:50.761033 [info ] [MainThread]:   host: None
[0m22:15:50.761033 [info ] [MainThread]:   port: None
[0m22:15:50.761033 [info ] [MainThread]:   proxy_host: None
[0m22:15:50.765327 [info ] [MainThread]:   proxy_port: None
[0m22:15:50.765327 [info ] [MainThread]:   protocol: None
[0m22:15:50.765327 [info ] [MainThread]:   connect_retries: 1
[0m22:15:50.765327 [info ] [MainThread]:   connect_timeout: None
[0m22:15:50.765327 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:15:50.765327 [info ] [MainThread]:   retry_all: False
[0m22:15:50.765327 [info ] [MainThread]:   insecure_mode: False
[0m22:15:50.773341 [info ] [MainThread]:   reuse_connections: None
[0m22:15:50.775311 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:15:50.775311 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:15:50.775311 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:15:50.775311 [debug] [MainThread]: On debug: select 1 as id
[0m22:15:50.775311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:51.830091 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:15:51.830091 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:15:51.830091 [debug] [MainThread]: On debug: No close available on handle
[0m22:15:51.830091 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:15:51.830091 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:15:51.830091 [debug] [MainThread]: Command `dbt debug` succeeded at 22:15:51.830091 after 2.65 seconds
[0m22:15:51.845764 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:15:51.845764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C2BB0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EFA50E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281EFA50070>]}
[0m22:15:51.845764 [debug] [MainThread]: Flushing usage events
[0m22:16:35.415285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B66EE0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B6B247FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B6B247EE0>]}


============================== 22:16:35.415285 | ffdc2cfc-4020-4985-a164-00e65b8eb2a1 ==============================
[0m22:16:35.415285 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:16:35.415285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:16:35.415285 [info ] [MainThread]: dbt version: 1.6.0
[0m22:16:35.415285 [info ] [MainThread]: python version: 3.9.17
[0m22:16:35.415285 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m22:16:35.415285 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m22:16:36.796687 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m22:16:36.796687 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m22:16:36.796687 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m22:16:36.804732 [info ] [MainThread]: adapter type: snowflake
[0m22:16:36.804732 [info ] [MainThread]: adapter version: 1.6.2
[0m22:16:36.828816 [info ] [MainThread]: Configuration:
[0m22:16:36.828816 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:16:36.828816 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:16:36.828816 [info ] [MainThread]: Required dependencies:
[0m22:16:36.828816 [debug] [MainThread]: Executing "git --help"
[0m22:16:36.885306 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:16:36.885306 [debug] [MainThread]: STDERR: "b''"
[0m22:16:36.893304 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:16:36.893304 [info ] [MainThread]: Connection:
[0m22:16:36.893304 [info ] [MainThread]:   account: ON22484.ca-central-1.aws
[0m22:16:36.893304 [info ] [MainThread]:   user: dbt
[0m22:16:36.893304 [info ] [MainThread]:   database: AIRBYTE_DATABASE
[0m22:16:36.893304 [info ] [MainThread]:   warehouse: ETL
[0m22:16:36.893304 [info ] [MainThread]:   role: DBT_RW
[0m22:16:36.893304 [info ] [MainThread]:   schema: AIRBYTE_SCHEMA
[0m22:16:36.901310 [info ] [MainThread]:   authenticator: None
[0m22:16:36.901310 [info ] [MainThread]:   private_key_path: None
[0m22:16:36.901310 [info ] [MainThread]:   token: None
[0m22:16:36.901310 [info ] [MainThread]:   oauth_client_id: None
[0m22:16:36.901310 [info ] [MainThread]:   query_tag: None
[0m22:16:36.901310 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:16:36.901310 [info ] [MainThread]:   host: None
[0m22:16:36.909400 [info ] [MainThread]:   port: None
[0m22:16:36.909400 [info ] [MainThread]:   proxy_host: None
[0m22:16:36.909400 [info ] [MainThread]:   proxy_port: None
[0m22:16:36.909400 [info ] [MainThread]:   protocol: None
[0m22:16:36.909400 [info ] [MainThread]:   connect_retries: 1
[0m22:16:36.909400 [info ] [MainThread]:   connect_timeout: None
[0m22:16:36.909400 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:16:36.917309 [info ] [MainThread]:   retry_all: False
[0m22:16:36.917309 [info ] [MainThread]:   insecure_mode: False
[0m22:16:36.917309 [info ] [MainThread]:   reuse_connections: None
[0m22:16:36.917309 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:16:36.917309 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:16:36.917309 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:16:36.917309 [debug] [MainThread]: On debug: select 1 as id
[0m22:16:36.917309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:37.990736 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:16:37.990736 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:16:37.998776 [debug] [MainThread]: On debug: No close available on handle
[0m22:16:37.998776 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:16:37.998776 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:16:37.998776 [debug] [MainThread]: Command `dbt debug` succeeded at 22:16:37.998776 after 2.62 seconds
[0m22:16:38.006768 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:16:38.006768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B66EE0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B13D80E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B13D80070>]}
[0m22:16:38.006768 [debug] [MainThread]: Flushing usage events
[0m22:16:54.038249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E9290100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245ED5F7FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245ED5F7EE0>]}


============================== 22:16:54.053839 | 6386172f-5690-4434-be3d-b80aab1f6451 ==============================
[0m22:16:54.053839 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:16:54.053839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:16:54.053839 [info ] [MainThread]: dbt version: 1.6.0
[0m22:16:54.053839 [info ] [MainThread]: python version: 3.9.17
[0m22:16:54.053839 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m22:16:54.053839 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m22:16:55.491852 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m22:16:55.491852 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m22:16:55.491852 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m22:16:55.507447 [info ] [MainThread]: adapter type: snowflake
[0m22:16:55.507447 [info ] [MainThread]: adapter version: 1.6.2
[0m22:16:55.531811 [info ] [MainThread]: Configuration:
[0m22:16:55.531811 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:16:55.531811 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:16:55.531811 [info ] [MainThread]: Required dependencies:
[0m22:16:55.531811 [debug] [MainThread]: Executing "git --help"
[0m22:16:55.596248 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:16:55.596248 [debug] [MainThread]: STDERR: "b''"
[0m22:16:55.604468 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:16:55.604468 [info ] [MainThread]: Connection:
[0m22:16:55.604468 [info ] [MainThread]:   account: ON22484.ca-central-1.aws
[0m22:16:55.604468 [info ] [MainThread]:   user: dbt
[0m22:16:55.604468 [info ] [MainThread]:   database: HR
[0m22:16:55.612480 [info ] [MainThread]:   warehouse: ETL
[0m22:16:55.612480 [info ] [MainThread]:   role: DBT_RW
[0m22:16:55.612480 [info ] [MainThread]:   schema: RAW
[0m22:16:55.619991 [info ] [MainThread]:   authenticator: None
[0m22:16:55.619991 [info ] [MainThread]:   private_key_path: None
[0m22:16:55.619991 [info ] [MainThread]:   token: None
[0m22:16:55.619991 [info ] [MainThread]:   oauth_client_id: None
[0m22:16:55.619991 [info ] [MainThread]:   query_tag: None
[0m22:16:55.619991 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:16:55.619991 [info ] [MainThread]:   host: None
[0m22:16:55.628093 [info ] [MainThread]:   port: None
[0m22:16:55.628093 [info ] [MainThread]:   proxy_host: None
[0m22:16:55.628093 [info ] [MainThread]:   proxy_port: None
[0m22:16:55.628093 [info ] [MainThread]:   protocol: None
[0m22:16:55.628093 [info ] [MainThread]:   connect_retries: 1
[0m22:16:55.628093 [info ] [MainThread]:   connect_timeout: None
[0m22:16:55.628093 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:16:55.628093 [info ] [MainThread]:   retry_all: False
[0m22:16:55.636106 [info ] [MainThread]:   insecure_mode: False
[0m22:16:55.636106 [info ] [MainThread]:   reuse_connections: None
[0m22:16:55.636106 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:16:55.636106 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:16:55.636106 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:16:55.636106 [debug] [MainThread]: On debug: select 1 as id
[0m22:16:55.644099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:56.700623 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:16:56.700623 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:16:56.700623 [debug] [MainThread]: On debug: No close available on handle
[0m22:16:56.700623 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:16:56.700623 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:16:56.716254 [debug] [MainThread]: Command `dbt debug` succeeded at 22:16:56.716254 after 2.70 seconds
[0m22:16:56.716254 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:16:56.716254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E9290100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024596130E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024596130070>]}
[0m22:16:56.716254 [debug] [MainThread]: Flushing usage events
[0m22:17:40.638294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AE99C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B2CF8F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182B2CF8EB0>]}


============================== 22:17:40.638294 | 9d0c7ffe-4d36-4e2c-b5a9-90618035cf25 ==============================
[0m22:17:40.638294 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:17:40.638294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:17:40.638294 [info ] [MainThread]: dbt version: 1.6.0
[0m22:17:40.654036 [info ] [MainThread]: python version: 3.9.17
[0m22:17:40.654036 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m22:17:40.654036 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m22:17:42.062200 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m22:17:42.062200 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m22:17:42.077885 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m22:17:42.077885 [info ] [MainThread]: adapter type: snowflake
[0m22:17:42.077885 [info ] [MainThread]: adapter version: 1.6.2
[0m22:17:42.102111 [info ] [MainThread]: Configuration:
[0m22:17:42.102111 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:17:42.102111 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:17:42.102111 [info ] [MainThread]: Required dependencies:
[0m22:17:42.102111 [debug] [MainThread]: Executing "git --help"
[0m22:17:42.172632 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:17:42.172632 [debug] [MainThread]: STDERR: "b''"
[0m22:17:42.172632 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:17:42.175353 [info ] [MainThread]: Connection:
[0m22:17:42.175353 [info ] [MainThread]:   account: oqcoskt-on22484.ca-central-1.aws
[0m22:17:42.175353 [info ] [MainThread]:   user: dbt
[0m22:17:42.175353 [info ] [MainThread]:   database: NORTHWIND
[0m22:17:42.175353 [info ] [MainThread]:   warehouse: ETL
[0m22:17:42.175353 [info ] [MainThread]:   role: DBT_RW
[0m22:17:42.175353 [info ] [MainThread]:   schema: RAW
[0m22:17:42.175353 [info ] [MainThread]:   authenticator: None
[0m22:17:42.183492 [info ] [MainThread]:   private_key_path: None
[0m22:17:42.183492 [info ] [MainThread]:   token: None
[0m22:17:42.183492 [info ] [MainThread]:   oauth_client_id: None
[0m22:17:42.183492 [info ] [MainThread]:   query_tag: None
[0m22:17:42.183492 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:17:42.183492 [info ] [MainThread]:   host: None
[0m22:17:42.183492 [info ] [MainThread]:   port: None
[0m22:17:42.191434 [info ] [MainThread]:   proxy_host: None
[0m22:17:42.191434 [info ] [MainThread]:   proxy_port: None
[0m22:17:42.191434 [info ] [MainThread]:   protocol: None
[0m22:17:42.191434 [info ] [MainThread]:   connect_retries: 1
[0m22:17:42.191434 [info ] [MainThread]:   connect_timeout: None
[0m22:17:42.191434 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:17:42.191434 [info ] [MainThread]:   retry_all: False
[0m22:17:42.191434 [info ] [MainThread]:   insecure_mode: False
[0m22:17:42.191434 [info ] [MainThread]:   reuse_connections: None
[0m22:17:42.199758 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:17:42.199758 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:17:42.199758 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:17:42.203460 [debug] [MainThread]: On debug: select 1 as id
[0m22:17:42.204563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:43.612922 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:17:43.612922 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:17:43.612922 [debug] [MainThread]: On debug: No close available on handle
[0m22:17:43.612922 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:17:43.612922 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:17:43.622473 [debug] [MainThread]: Command `dbt debug` succeeded at 22:17:43.612922 after 3.01 seconds
[0m22:17:43.623088 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:17:43.623088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AE99C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182DB830FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182DB830910>]}
[0m22:17:43.624088 [debug] [MainThread]: Flushing usage events
[0m22:18:00.749832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583A2DC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583E638E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583E638E80>]}


============================== 22:18:00.749832 | 4cfbe02e-af4d-4397-91bb-f77af4881d0f ==============================
[0m22:18:00.749832 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:18:00.749832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:18:00.749832 [info ] [MainThread]: dbt version: 1.6.0
[0m22:18:00.749832 [info ] [MainThread]: python version: 3.9.17
[0m22:18:00.749832 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m22:18:00.749832 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m22:18:02.150836 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m22:18:02.150836 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m22:18:02.150836 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m22:18:02.150836 [info ] [MainThread]: adapter type: snowflake
[0m22:18:02.158951 [info ] [MainThread]: adapter version: 1.6.2
[0m22:18:02.181659 [info ] [MainThread]: Configuration:
[0m22:18:02.183177 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:18:02.184602 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:18:02.185229 [info ] [MainThread]: Required dependencies:
[0m22:18:02.186166 [debug] [MainThread]: Executing "git --help"
[0m22:18:02.249872 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:18:02.249872 [debug] [MainThread]: STDERR: "b''"
[0m22:18:02.249872 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:18:02.252467 [info ] [MainThread]: Connection:
[0m22:18:02.252467 [info ] [MainThread]:   account: on22484.ca-central-1.aws
[0m22:18:02.252467 [info ] [MainThread]:   user: dbt
[0m22:18:02.252467 [info ] [MainThread]:   database: NORTHWIND
[0m22:18:02.257692 [info ] [MainThread]:   warehouse: ETL
[0m22:18:02.257692 [info ] [MainThread]:   role: DBT_RW
[0m22:18:02.257692 [info ] [MainThread]:   schema: RAW
[0m22:18:02.257692 [info ] [MainThread]:   authenticator: None
[0m22:18:02.257692 [info ] [MainThread]:   private_key_path: None
[0m22:18:02.257692 [info ] [MainThread]:   token: None
[0m22:18:02.257692 [info ] [MainThread]:   oauth_client_id: None
[0m22:18:02.257692 [info ] [MainThread]:   query_tag: None
[0m22:18:02.257692 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:18:02.265246 [info ] [MainThread]:   host: None
[0m22:18:02.265246 [info ] [MainThread]:   port: None
[0m22:18:02.265246 [info ] [MainThread]:   proxy_host: None
[0m22:18:02.268537 [info ] [MainThread]:   proxy_port: None
[0m22:18:02.268724 [info ] [MainThread]:   protocol: None
[0m22:18:02.268724 [info ] [MainThread]:   connect_retries: 1
[0m22:18:02.268724 [info ] [MainThread]:   connect_timeout: None
[0m22:18:02.268724 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:18:02.272667 [info ] [MainThread]:   retry_all: False
[0m22:18:02.273677 [info ] [MainThread]:   insecure_mode: False
[0m22:18:02.273677 [info ] [MainThread]:   reuse_connections: None
[0m22:18:02.273677 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:18:02.273677 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:18:02.273677 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:18:02.273677 [debug] [MainThread]: On debug: select 1 as id
[0m22:18:02.273677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:03.335899 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:18:03.335899 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:18:03.335899 [debug] [MainThread]: On debug: No close available on handle
[0m22:18:03.335899 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:18:03.335899 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:18:03.335899 [debug] [MainThread]: Command `dbt debug` succeeded at 22:18:03.335899 after 2.62 seconds
[0m22:18:03.335899 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:18:03.335899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583A2DC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015867180490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158671708E0>]}
[0m22:18:03.335899 [debug] [MainThread]: Flushing usage events
[0m06:47:02.623496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002350DFBC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023512317FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023512317F10>]}


============================== 06:47:02.635495 | 4868badd-ee9f-472d-9c0f-b659de972cfa ==============================
[0m06:47:02.635495 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:47:02.635495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m06:47:02.635495 [info ] [MainThread]: dbt version: 1.6.0
[0m06:47:02.644101 [info ] [MainThread]: python version: 3.9.17
[0m06:47:02.644101 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m06:47:02.644101 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m06:47:05.043775 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m06:47:05.043775 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m06:47:05.049969 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m06:47:05.049969 [info ] [MainThread]: adapter type: snowflake
[0m06:47:05.054307 [info ] [MainThread]: adapter version: 1.6.2
[0m06:47:05.078083 [info ] [MainThread]: Configuration:
[0m06:47:05.078083 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:47:05.085599 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:47:05.085822 [info ] [MainThread]: Required dependencies:
[0m06:47:05.088024 [debug] [MainThread]: Executing "git --help"
[0m06:47:05.206640 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:47:05.207717 [debug] [MainThread]: STDERR: "b''"
[0m06:47:05.208830 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:47:05.210369 [info ] [MainThread]: Connection:
[0m06:47:05.211801 [info ] [MainThread]:   account: on22484.ca-central-1.aws
[0m06:47:05.212332 [info ] [MainThread]:   user: dbt
[0m06:47:05.213875 [info ] [MainThread]:   database: NORTHWIND
[0m06:47:05.214909 [info ] [MainThread]:   warehouse: ETL
[0m06:47:05.216297 [info ] [MainThread]:   role: DBT_RW
[0m06:47:05.217526 [info ] [MainThread]:   schema: RAW
[0m06:47:05.219144 [info ] [MainThread]:   authenticator: None
[0m06:47:05.220584 [info ] [MainThread]:   private_key_path: None
[0m06:47:05.222165 [info ] [MainThread]:   token: None
[0m06:47:05.223691 [info ] [MainThread]:   oauth_client_id: None
[0m06:47:05.224763 [info ] [MainThread]:   query_tag: None
[0m06:47:05.226774 [info ] [MainThread]:   client_session_keep_alive: False
[0m06:47:05.227586 [info ] [MainThread]:   host: None
[0m06:47:05.229279 [info ] [MainThread]:   port: None
[0m06:47:05.231137 [info ] [MainThread]:   proxy_host: None
[0m06:47:05.231868 [info ] [MainThread]:   proxy_port: None
[0m06:47:05.232701 [info ] [MainThread]:   protocol: None
[0m06:47:05.234362 [info ] [MainThread]:   connect_retries: 1
[0m06:47:05.235533 [info ] [MainThread]:   connect_timeout: None
[0m06:47:05.237078 [info ] [MainThread]:   retry_on_database_errors: False
[0m06:47:05.237835 [info ] [MainThread]:   retry_all: False
[0m06:47:05.239388 [info ] [MainThread]:   insecure_mode: False
[0m06:47:05.240450 [info ] [MainThread]:   reuse_connections: None
[0m06:47:05.242411 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m06:47:05.244030 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m06:47:05.245735 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:47:05.246272 [debug] [MainThread]: On debug: select 1 as id
[0m06:47:05.246953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:47:06.305556 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m06:47:06.305556 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m06:47:06.305556 [debug] [MainThread]: On debug: No close available on handle
[0m06:47:06.305556 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m06:47:06.310658 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:47:06.310658 [debug] [MainThread]: Command `dbt debug` succeeded at 06:47:06.310658 after 3.71 seconds
[0m06:47:06.310658 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:47:06.310658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002350DFBC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002353AE602E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002353AE8DA30>]}
[0m06:47:06.310658 [debug] [MainThread]: Flushing usage events
[0m06:52:16.090083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186E2A7C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186E6DD7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186E6DD7FA0>]}


============================== 06:52:16.098625 | 14383164-31ad-4bb6-9ac8-49e859ad8868 ==============================
[0m06:52:16.098625 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:52:16.102147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select customer_type', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:52:18.744149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14383164-31ad-4bb6-9ac8-49e859ad8868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186E6DD7F10>]}
[0m06:52:18.753659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14383164-31ad-4bb6-9ac8-49e859ad8868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868F948E80>]}
[0m06:52:18.756674 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m06:52:18.768815 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:52:18.793924 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m06:52:18.796061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '14383164-31ad-4bb6-9ac8-49e859ad8868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868F95A4F0>]}
[0m06:52:19.729525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m06:52:19.736933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14383164-31ad-4bb6-9ac8-49e859ad8868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868F9ECD90>]}
[0m06:52:19.750381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14383164-31ad-4bb6-9ac8-49e859ad8868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868FB72FA0>]}
[0m06:52:19.751352 [info ] [MainThread]: Found 2 models, 14 sources, 0 exposures, 0 metrics, 372 macros, 0 groups, 0 semantic models
[0m06:52:19.752335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14383164-31ad-4bb6-9ac8-49e859ad8868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868FA58280>]}
[0m06:52:19.754344 [info ] [MainThread]: 
[0m06:52:19.756342 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:52:19.758436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind'
[0m06:52:19.774955 [debug] [ThreadPool]: Using snowflake connection "list_northwind"
[0m06:52:19.774955 [debug] [ThreadPool]: On list_northwind: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m06:52:19.776107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:52:20.774614 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m06:52:20.775614 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m06:52:20.775614 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m06:52:20.776616 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m06:52:20.776616 [debug] [ThreadPool]: On list_northwind: No close available on handle
[0m06:52:20.778619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:52:20.779619 [debug] [MainThread]: Connection 'list_northwind' was properly closed.
[0m06:52:20.779619 [info ] [MainThread]: 
[0m06:52:20.780624 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m06:52:20.783068 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "northwind"
  Database Error
    250001 (08001): Failed to connect to DB. Verify the account name is correct: on22484.ca-central-1.aws.snowflakecomputing.com:443. HTTP 403: Forbidden
[0m06:52:20.786059 [debug] [MainThread]: Command `dbt run` failed at 06:52:20.786059 after 4.72 seconds
[0m06:52:20.787164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186E2A7C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868F9ED2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868FA58280>]}
[0m06:52:20.788058 [debug] [MainThread]: Flushing usage events
[0m06:56:53.139495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132D8F1C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132DD247FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132DD247F40>]}


============================== 06:56:53.146906 | d63cb62a-c6ef-4d56-a3af-fd9061d368b0 ==============================
[0m06:56:53.146906 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:56:53.148908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:56:53.149904 [info ] [MainThread]: dbt version: 1.6.0
[0m06:56:53.150920 [info ] [MainThread]: python version: 3.9.17
[0m06:56:53.152445 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m06:56:53.153454 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m06:56:56.015762 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m06:56:56.017883 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m06:56:56.019154 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m06:56:56.022585 [info ] [MainThread]: adapter type: snowflake
[0m06:56:56.024530 [info ] [MainThread]: adapter version: 1.6.2
[0m06:56:56.053183 [info ] [MainThread]: Configuration:
[0m06:56:56.054199 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:56:56.056198 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:56:56.057715 [info ] [MainThread]: Required dependencies:
[0m06:56:56.058776 [debug] [MainThread]: Executing "git --help"
[0m06:56:56.137641 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:56:56.138951 [debug] [MainThread]: STDERR: "b''"
[0m06:56:56.139624 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:56:56.142036 [info ] [MainThread]: Connection:
[0m06:56:56.143681 [info ] [MainThread]:   account: qg94207.ca-central-1.aws
[0m06:56:56.144976 [info ] [MainThread]:   user: dbt
[0m06:56:56.146463 [info ] [MainThread]:   database: NORTHWIND
[0m06:56:56.148137 [info ] [MainThread]:   warehouse: ETL
[0m06:56:56.149390 [info ] [MainThread]:   role: DBT_RW
[0m06:56:56.150796 [info ] [MainThread]:   schema: RAW
[0m06:56:56.151913 [info ] [MainThread]:   authenticator: None
[0m06:56:56.154513 [info ] [MainThread]:   private_key_path: None
[0m06:56:56.155894 [info ] [MainThread]:   token: None
[0m06:56:56.157305 [info ] [MainThread]:   oauth_client_id: None
[0m06:56:56.159138 [info ] [MainThread]:   query_tag: None
[0m06:56:56.160528 [info ] [MainThread]:   client_session_keep_alive: False
[0m06:56:56.162271 [info ] [MainThread]:   host: None
[0m06:56:56.164108 [info ] [MainThread]:   port: None
[0m06:56:56.165584 [info ] [MainThread]:   proxy_host: None
[0m06:56:56.167812 [info ] [MainThread]:   proxy_port: None
[0m06:56:56.169186 [info ] [MainThread]:   protocol: None
[0m06:56:56.169972 [info ] [MainThread]:   connect_retries: 1
[0m06:56:56.171402 [info ] [MainThread]:   connect_timeout: None
[0m06:56:56.173080 [info ] [MainThread]:   retry_on_database_errors: False
[0m06:56:56.174878 [info ] [MainThread]:   retry_all: False
[0m06:56:56.176604 [info ] [MainThread]:   insecure_mode: False
[0m06:56:56.178258 [info ] [MainThread]:   reuse_connections: None
[0m06:56:56.180468 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m06:56:56.183331 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m06:56:56.186141 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:56:56.187879 [debug] [MainThread]: On debug: select 1 as id
[0m06:56:56.188601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:56:57.535198 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:56:57.536239 [debug] [MainThread]: On debug: Close
[0m06:56:57.623466 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:56:57.626465 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:56:57.629479 [debug] [MainThread]: Command `dbt debug` succeeded at 06:56:57.629479 after 4.52 seconds
[0m06:56:57.630478 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:56:57.630478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132D8F1C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013285DC01C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013285879E80>]}
[0m06:56:57.631487 [debug] [MainThread]: Flushing usage events
[0m06:58:25.137260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB950C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EBD877F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EBD877FD0>]}


============================== 06:58:25.142265 | fa938720-3ca1-44c6-b72a-702244430cda ==============================
[0m06:58:25.142265 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:58:25.143147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select customer_type', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:58:26.503806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa938720-3ca1-44c6-b72a-702244430cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EBD877EB0>]}
[0m06:58:26.510812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa938720-3ca1-44c6-b72a-702244430cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE63E6E20>]}
[0m06:58:26.511816 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m06:58:26.523854 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:58:26.553366 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m06:58:26.554587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa938720-3ca1-44c6-b72a-702244430cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE63FA340>]}
[0m06:58:27.330267 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m06:58:27.335890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa938720-3ca1-44c6-b72a-702244430cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE648E940>]}
[0m06:58:27.351827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa938720-3ca1-44c6-b72a-702244430cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE64F3250>]}
[0m06:58:27.353413 [info ] [MainThread]: Found 2 models, 14 sources, 0 exposures, 0 metrics, 372 macros, 0 groups, 0 semantic models
[0m06:58:27.355422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa938720-3ca1-44c6-b72a-702244430cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE65AEB50>]}
[0m06:58:27.356423 [info ] [MainThread]: 
[0m06:58:27.358425 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:58:27.361759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind'
[0m06:58:27.375992 [debug] [ThreadPool]: Using snowflake connection "list_northwind"
[0m06:58:27.376992 [debug] [ThreadPool]: On list_northwind: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m06:58:27.376992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:28.455606 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m06:58:28.457610 [debug] [ThreadPool]: On list_northwind: Close
[0m06:58:28.549449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northwind, now create_northwind_RAW_staging)
[0m06:58:28.550472 [debug] [ThreadPool]: Creating schema "database: "northwind"
schema: "RAW_staging"
"
[0m06:58:28.555971 [debug] [ThreadPool]: Using snowflake connection "create_northwind_RAW_staging"
[0m06:58:28.556972 [debug] [ThreadPool]: On create_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "create_northwind_RAW_staging"} */
create schema if not exists northwind.RAW_staging
[0m06:58:28.556972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:58:29.464404 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:58:29.466412 [debug] [ThreadPool]: On create_northwind_RAW_staging: Close
[0m06:58:29.559924 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_sales_RAW_staging'
[0m06:58:29.567442 [debug] [ThreadPool]: Using snowflake connection "list_sales_RAW_staging"
[0m06:58:29.568442 [debug] [ThreadPool]: On list_sales_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_sales_RAW_staging"} */
show terse objects in sales.RAW_staging limit 10000
[0m06:58:29.569443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:30.301164 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b04d0e-3200-f449-0004-6e5200013062
[0m06:58:30.302167 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m06:58:30.303067 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m06:58:30.303574 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m06:58:30.304583 [debug] [ThreadPool]: On list_sales_RAW_staging: Close
[0m06:58:30.396615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_RAW_staging, now list_northwind_RAW_staging)
[0m06:58:30.398566 [debug] [ThreadPool]: Using snowflake connection "list_northwind_RAW_staging"
[0m06:58:30.399554 [debug] [ThreadPool]: On list_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind_RAW_staging"} */
show terse objects in northwind.RAW_staging limit 10000
[0m06:58:30.399554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:58:31.060808 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m06:58:31.061763 [debug] [ThreadPool]: On list_northwind_RAW_staging: Close
[0m06:58:31.141401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa938720-3ca1-44c6-b72a-702244430cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE64DF2E0>]}
[0m06:58:31.143408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:58:31.144582 [info ] [MainThread]: 
[0m06:58:31.151581 [debug] [Thread-1  ]: Began running node model.northwind.customer_type
[0m06:58:31.153092 [info ] [Thread-1  ]: 1 of 1 START sql table model northwind.RAW_staging.customer_type ............... [RUN]
[0m06:58:31.155132 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.customer_type'
[0m06:58:31.155132 [debug] [Thread-1  ]: Began compiling node model.northwind.customer_type
[0m06:58:31.165488 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.customer_type"
[0m06:58:31.168081 [debug] [Thread-1  ]: Timing info for model.northwind.customer_type (compile): 06:58:31.156216 => 06:58:31.168081
[0m06:58:31.169107 [debug] [Thread-1  ]: Began executing node model.northwind.customer_type
[0m06:58:31.200200 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.customer_type"
[0m06:58:31.202120 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.customer_type"
[0m06:58:31.203106 [debug] [Thread-1  ]: On model.northwind.customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.customer_type"} */
create or replace transient table northwind.RAW_staging.customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m06:58:31.204247 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:58:31.901254 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b04d0e-3200-f44a-0004-6e5200012622
[0m06:58:31.901254 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'AIRBYTE_DATABASE.AIRBYTE_SCHEMA' does not exist or not authorized.
[0m06:58:31.902232 [debug] [Thread-1  ]: Timing info for model.northwind.customer_type (execute): 06:58:31.169107 => 06:58:31.902232
[0m06:58:31.902232 [debug] [Thread-1  ]: On model.northwind.customer_type: Close
[0m06:58:31.991447 [debug] [Thread-1  ]: Database Error in model customer_type (models\staging\customer_type.sql)
  002003 (02000): SQL compilation error:
  Schema 'AIRBYTE_DATABASE.AIRBYTE_SCHEMA' does not exist or not authorized.
  compiled Code at target\run\northwind\models\staging\customer_type.sql
[0m06:58:31.992447 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa938720-3ca1-44c6-b72a-702244430cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE6BB8130>]}
[0m06:58:31.994003 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model northwind.RAW_staging.customer_type ...... [[31mERROR[0m in 0.84s]
[0m06:58:31.995020 [debug] [Thread-1  ]: Finished running node model.northwind.customer_type
[0m06:58:32.000225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:58:32.000225 [debug] [MainThread]: Connection 'create_northwind_RAW_staging' was properly closed.
[0m06:58:32.001164 [debug] [MainThread]: Connection 'list_northwind_RAW_staging' was properly closed.
[0m06:58:32.001164 [debug] [MainThread]: Connection 'model.northwind.customer_type' was properly closed.
[0m06:58:32.001164 [info ] [MainThread]: 
[0m06:58:32.003159 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.64 seconds (4.64s).
[0m06:58:32.004342 [debug] [MainThread]: Command end result
[0m06:58:32.017527 [info ] [MainThread]: 
[0m06:58:32.018525 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:58:32.019522 [info ] [MainThread]: 
[0m06:58:32.020525 [error] [MainThread]: [33mDatabase Error in model customer_type (models\staging\customer_type.sql)[0m
[0m06:58:32.021523 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m06:58:32.023077 [error] [MainThread]:   Schema 'AIRBYTE_DATABASE.AIRBYTE_SCHEMA' does not exist or not authorized.
[0m06:58:32.024033 [error] [MainThread]:   compiled Code at target\run\northwind\models\staging\customer_type.sql
[0m06:58:32.025032 [info ] [MainThread]: 
[0m06:58:32.026036 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:58:32.028555 [debug] [MainThread]: Command `dbt run` failed at 06:58:32.028555 after 6.91 seconds
[0m06:58:32.029562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EB950C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE63E6E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE63FA100>]}
[0m06:58:32.030562 [debug] [MainThread]: Flushing usage events
[0m07:04:39.524326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D42500100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D46867FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4689B340>]}


============================== 07:04:39.528966 | 517abd3f-11b7-4d4d-ae47-f3c4254200e4 ==============================
[0m07:04:39.528966 [info ] [MainThread]: Running with dbt=1.6.0
[0m07:04:39.530154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select customer_type', 'send_anonymous_usage_stats': 'True'}
[0m07:04:40.764694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '517abd3f-11b7-4d4d-ae47-f3c4254200e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D46867F40>]}
[0m07:04:40.773229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '517abd3f-11b7-4d4d-ae47-f3c4254200e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D6F3D6EB0>]}
[0m07:04:40.775229 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m07:04:40.785344 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m07:04:40.902416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:04:40.903453 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:04:40.904422 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m07:04:40.910164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '517abd3f-11b7-4d4d-ae47-f3c4254200e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D6F56DF10>]}
[0m07:04:40.919408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '517abd3f-11b7-4d4d-ae47-f3c4254200e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D6F4A6D90>]}
[0m07:04:40.920406 [info ] [MainThread]: Found 2 models, 14 sources, 0 exposures, 0 metrics, 372 macros, 0 groups, 0 semantic models
[0m07:04:40.921446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '517abd3f-11b7-4d4d-ae47-f3c4254200e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D6F4A6A30>]}
[0m07:04:40.922429 [info ] [MainThread]: 
[0m07:04:40.924423 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:04:40.926931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind'
[0m07:04:40.939996 [debug] [ThreadPool]: Using snowflake connection "list_northwind"
[0m07:04:40.939996 [debug] [ThreadPool]: On list_northwind: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m07:04:40.941510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:04:42.128829 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m07:04:42.129932 [debug] [ThreadPool]: On list_northwind: Close
[0m07:04:42.209159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_sales_RAW_staging'
[0m07:04:42.216170 [debug] [ThreadPool]: Using snowflake connection "list_sales_RAW_staging"
[0m07:04:42.217388 [debug] [ThreadPool]: On list_sales_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_sales_RAW_staging"} */
show terse objects in sales.RAW_staging limit 10000
[0m07:04:42.218393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:04:42.891450 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b04d14-3200-f43f-0004-6e5200014092
[0m07:04:42.891450 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m07:04:42.892500 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:04:42.893395 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:04:42.893395 [debug] [ThreadPool]: On list_sales_RAW_staging: Close
[0m07:04:42.994467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_RAW_staging, now list_northwind_RAW_staging)
[0m07:04:42.998978 [debug] [ThreadPool]: Using snowflake connection "list_northwind_RAW_staging"
[0m07:04:42.999975 [debug] [ThreadPool]: On list_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind_RAW_staging"} */
show terse objects in northwind.RAW_staging limit 10000
[0m07:04:42.999975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:04:43.864458 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m07:04:43.866981 [debug] [ThreadPool]: On list_northwind_RAW_staging: Close
[0m07:04:43.970937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '517abd3f-11b7-4d4d-ae47-f3c4254200e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D6F4A65E0>]}
[0m07:04:43.971875 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:04:43.972873 [info ] [MainThread]: 
[0m07:04:43.977390 [debug] [Thread-1  ]: Began running node model.northwind.customer_type
[0m07:04:43.977390 [info ] [Thread-1  ]: 1 of 1 START sql table model northwind.RAW_staging.customer_type ............... [RUN]
[0m07:04:43.979390 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.customer_type'
[0m07:04:43.979390 [debug] [Thread-1  ]: Began compiling node model.northwind.customer_type
[0m07:04:43.988000 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.customer_type"
[0m07:04:43.990007 [debug] [Thread-1  ]: Timing info for model.northwind.customer_type (compile): 07:04:43.980397 => 07:04:43.988999
[0m07:04:43.990007 [debug] [Thread-1  ]: Began executing node model.northwind.customer_type
[0m07:04:44.018573 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.customer_type"
[0m07:04:44.019573 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.customer_type"
[0m07:04:44.020579 [debug] [Thread-1  ]: On model.northwind.customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.customer_type"} */
create or replace transient table northwind.RAW_staging.customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m07:04:44.021578 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:04:44.685235 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b04d14-3200-f44a-0004-6e5200012712
[0m07:04:44.686238 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBYTE_DATABASE.AIRBYTE_SCHEMA.CUSTOMER_TYPE' does not exist or not authorized.
[0m07:04:44.687353 [debug] [Thread-1  ]: Timing info for model.northwind.customer_type (execute): 07:04:43.990007 => 07:04:44.686238
[0m07:04:44.688355 [debug] [Thread-1  ]: On model.northwind.customer_type: Close
[0m07:04:44.776393 [debug] [Thread-1  ]: Database Error in model customer_type (models\staging\customer_type.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBYTE_DATABASE.AIRBYTE_SCHEMA.CUSTOMER_TYPE' does not exist or not authorized.
  compiled Code at target\run\northwind\models\staging\customer_type.sql
[0m07:04:44.777201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517abd3f-11b7-4d4d-ae47-f3c4254200e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D6F9BA070>]}
[0m07:04:44.778201 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model northwind.RAW_staging.customer_type ...... [[31mERROR[0m in 0.80s]
[0m07:04:44.780216 [debug] [Thread-1  ]: Finished running node model.northwind.customer_type
[0m07:04:44.783267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:04:44.783267 [debug] [MainThread]: Connection 'list_northwind' was properly closed.
[0m07:04:44.784211 [debug] [MainThread]: Connection 'list_northwind_RAW_staging' was properly closed.
[0m07:04:44.784211 [debug] [MainThread]: Connection 'model.northwind.customer_type' was properly closed.
[0m07:04:44.784211 [info ] [MainThread]: 
[0m07:04:44.786211 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m07:04:44.787734 [debug] [MainThread]: Command end result
[0m07:04:44.798260 [info ] [MainThread]: 
[0m07:04:44.799255 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:04:44.800269 [info ] [MainThread]: 
[0m07:04:44.801261 [error] [MainThread]: [33mDatabase Error in model customer_type (models\staging\customer_type.sql)[0m
[0m07:04:44.802261 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m07:04:44.803262 [error] [MainThread]:   Object 'AIRBYTE_DATABASE.AIRBYTE_SCHEMA.CUSTOMER_TYPE' does not exist or not authorized.
[0m07:04:44.804262 [error] [MainThread]:   compiled Code at target\run\northwind\models\staging\customer_type.sql
[0m07:04:44.805272 [info ] [MainThread]: 
[0m07:04:44.806261 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:04:44.808434 [debug] [MainThread]: Command `dbt run` failed at 07:04:44.808434 after 5.30 seconds
[0m07:04:44.809809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D42500100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D6F3D6EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D6F9D0220>]}
[0m07:04:44.810328 [debug] [MainThread]: Flushing usage events
[0m07:05:59.733964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019616DD0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001961B137FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001961B137F70>]}


============================== 07:05:59.739471 | ad45c9f1-e6bb-488a-8862-3a8aa7fde3a7 ==============================
[0m07:05:59.739471 [info ] [MainThread]: Running with dbt=1.6.0
[0m07:05:59.741472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m07:05:59.742471 [info ] [MainThread]: dbt version: 1.6.0
[0m07:05:59.743473 [info ] [MainThread]: python version: 3.9.17
[0m07:05:59.744469 [info ] [MainThread]: python path: C:\Users\maryc\anaconda3\envs\dec\python.exe
[0m07:05:59.745470 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m07:06:00.879312 [info ] [MainThread]: Using profiles dir at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind
[0m07:06:00.880854 [info ] [MainThread]: Using profiles.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\profiles.yml
[0m07:06:00.881862 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\maryc\Code\dec_northwind\transform\dbt\northwind\dbt_project.yml
[0m07:06:00.883861 [info ] [MainThread]: adapter type: snowflake
[0m07:06:00.885875 [info ] [MainThread]: adapter version: 1.6.2
[0m07:06:00.907958 [info ] [MainThread]: Configuration:
[0m07:06:00.909979 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:06:00.911149 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:06:00.912289 [info ] [MainThread]: Required dependencies:
[0m07:06:00.913286 [debug] [MainThread]: Executing "git --help"
[0m07:06:00.964717 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:06:00.965718 [debug] [MainThread]: STDERR: "b''"
[0m07:06:00.966719 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:06:00.967971 [info ] [MainThread]: Connection:
[0m07:06:00.968970 [info ] [MainThread]:   account: qg94207.ca-central-1.aws
[0m07:06:00.970970 [info ] [MainThread]:   user: dbt
[0m07:06:00.972972 [info ] [MainThread]:   database: NORTHWIND
[0m07:06:00.973661 [info ] [MainThread]:   warehouse: ETL
[0m07:06:00.975662 [info ] [MainThread]:   role: DBT_RW
[0m07:06:00.975662 [info ] [MainThread]:   schema: RAW
[0m07:06:00.977170 [info ] [MainThread]:   authenticator: None
[0m07:06:00.978195 [info ] [MainThread]:   private_key_path: None
[0m07:06:00.979177 [info ] [MainThread]:   token: None
[0m07:06:00.980176 [info ] [MainThread]:   oauth_client_id: None
[0m07:06:00.981176 [info ] [MainThread]:   query_tag: None
[0m07:06:00.982176 [info ] [MainThread]:   client_session_keep_alive: False
[0m07:06:00.984177 [info ] [MainThread]:   host: None
[0m07:06:00.985175 [info ] [MainThread]:   port: None
[0m07:06:00.986685 [info ] [MainThread]:   proxy_host: None
[0m07:06:00.988698 [info ] [MainThread]:   proxy_port: None
[0m07:06:00.989695 [info ] [MainThread]:   protocol: None
[0m07:06:00.991703 [info ] [MainThread]:   connect_retries: 1
[0m07:06:00.992702 [info ] [MainThread]:   connect_timeout: None
[0m07:06:00.993708 [info ] [MainThread]:   retry_on_database_errors: False
[0m07:06:00.994717 [info ] [MainThread]:   retry_all: False
[0m07:06:00.995703 [info ] [MainThread]:   insecure_mode: False
[0m07:06:00.997999 [info ] [MainThread]:   reuse_connections: None
[0m07:06:00.998995 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m07:06:01.000088 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m07:06:01.000994 [debug] [MainThread]: Using snowflake connection "debug"
[0m07:06:01.000994 [debug] [MainThread]: On debug: select 1 as id
[0m07:06:01.002151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:06:02.121933 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:06:02.123935 [debug] [MainThread]: On debug: Close
[0m07:06:02.200879 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:06:02.202880 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:06:02.203888 [debug] [MainThread]: Command `dbt debug` succeeded at 07:06:02.203888 after 2.49 seconds
[0m07:06:02.204918 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:06:02.204918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019616DD0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019643C80130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019643739EB0>]}
[0m07:06:02.205888 [debug] [MainThread]: Flushing usage events
[0m07:06:12.096067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE9626C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE9A5D8E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE9A5D8F70>]}


============================== 07:06:12.100707 | f2ca3d32-a1b1-4446-8c4f-727e129161d5 ==============================
[0m07:06:12.100707 [info ] [MainThread]: Running with dbt=1.6.0
[0m07:06:12.102586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select customer_type', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:06:13.130011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2ca3d32-a1b1-4446-8c4f-727e129161d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE9A5D8FA0>]}
[0m07:06:13.138106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2ca3d32-a1b1-4446-8c4f-727e129161d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC3147DC0>]}
[0m07:06:13.140101 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m07:06:13.150632 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m07:06:13.283019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:06:13.283019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:06:13.284005 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m07:06:13.289579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2ca3d32-a1b1-4446-8c4f-727e129161d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC32DEE20>]}
[0m07:06:13.298036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2ca3d32-a1b1-4446-8c4f-727e129161d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC322BCA0>]}
[0m07:06:13.299026 [info ] [MainThread]: Found 2 models, 14 sources, 0 exposures, 0 metrics, 372 macros, 0 groups, 0 semantic models
[0m07:06:13.300025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2ca3d32-a1b1-4446-8c4f-727e129161d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC322B940>]}
[0m07:06:13.302032 [info ] [MainThread]: 
[0m07:06:13.303033 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:06:13.306028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind'
[0m07:06:13.320572 [debug] [ThreadPool]: Using snowflake connection "list_northwind"
[0m07:06:13.320572 [debug] [ThreadPool]: On list_northwind: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m07:06:13.321578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:06:14.329141 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m07:06:14.330141 [debug] [ThreadPool]: On list_northwind: Close
[0m07:06:14.407128 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind_RAW_staging'
[0m07:06:14.415143 [debug] [ThreadPool]: Using snowflake connection "list_northwind_RAW_staging"
[0m07:06:14.416143 [debug] [ThreadPool]: On list_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind_RAW_staging"} */
show terse objects in northwind.RAW_staging limit 10000
[0m07:06:14.416143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:06:15.067049 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m07:06:15.069066 [debug] [ThreadPool]: On list_northwind_RAW_staging: Close
[0m07:06:15.155684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northwind_RAW_staging, now list_sales_RAW_staging)
[0m07:06:15.157827 [debug] [ThreadPool]: Using snowflake connection "list_sales_RAW_staging"
[0m07:06:15.158832 [debug] [ThreadPool]: On list_sales_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_sales_RAW_staging"} */
show terse objects in sales.RAW_staging limit 10000
[0m07:06:15.158832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:06:16.172158 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b04d16-3200-f449-0004-6e520001316e
[0m07:06:16.173167 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m07:06:16.173167 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:06:16.174170 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:06:16.174170 [debug] [ThreadPool]: On list_sales_RAW_staging: Close
[0m07:06:16.255343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2ca3d32-a1b1-4446-8c4f-727e129161d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC322B7C0>]}
[0m07:06:16.256855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:06:16.257874 [info ] [MainThread]: 
[0m07:06:16.262860 [debug] [Thread-1  ]: Began running node model.northwind.customer_type
[0m07:06:16.262860 [info ] [Thread-1  ]: 1 of 1 START sql table model northwind.RAW_staging.customer_type ............... [RUN]
[0m07:06:16.264860 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.customer_type'
[0m07:06:16.264860 [debug] [Thread-1  ]: Began compiling node model.northwind.customer_type
[0m07:06:16.273180 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.customer_type"
[0m07:06:16.274179 [debug] [Thread-1  ]: Timing info for model.northwind.customer_type (compile): 07:06:16.265860 => 07:06:16.274179
[0m07:06:16.274179 [debug] [Thread-1  ]: Began executing node model.northwind.customer_type
[0m07:06:16.300707 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.customer_type"
[0m07:06:16.302713 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.customer_type"
[0m07:06:16.303712 [debug] [Thread-1  ]: On model.northwind.customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.customer_type"} */
create or replace transient table northwind.RAW_staging.customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m07:06:16.303712 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:06:17.076173 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b04d16-3200-f449-0004-6e5200013172
[0m07:06:17.077173 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'AIRBYTE_DATABASE.AIRBYTE_SCHEMA.CUSTOMER_TYPE' does not exist or not authorized.
[0m07:06:17.077682 [debug] [Thread-1  ]: Timing info for model.northwind.customer_type (execute): 07:06:16.275182 => 07:06:17.077682
[0m07:06:17.078696 [debug] [Thread-1  ]: On model.northwind.customer_type: Close
[0m07:06:17.173655 [debug] [Thread-1  ]: Database Error in model customer_type (models\staging\customer_type.sql)
  002003 (42S02): SQL compilation error:
  Object 'AIRBYTE_DATABASE.AIRBYTE_SCHEMA.CUSTOMER_TYPE' does not exist or not authorized.
  compiled Code at target\run\northwind\models\staging\customer_type.sql
[0m07:06:17.174431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2ca3d32-a1b1-4446-8c4f-727e129161d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC3645A30>]}
[0m07:06:17.174937 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model northwind.RAW_staging.customer_type ...... [[31mERROR[0m in 0.91s]
[0m07:06:17.176022 [debug] [Thread-1  ]: Finished running node model.northwind.customer_type
[0m07:06:17.178662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:06:17.179296 [debug] [MainThread]: Connection 'list_northwind' was properly closed.
[0m07:06:17.179802 [debug] [MainThread]: Connection 'list_sales_RAW_staging' was properly closed.
[0m07:06:17.180330 [debug] [MainThread]: Connection 'model.northwind.customer_type' was properly closed.
[0m07:06:17.180330 [info ] [MainThread]: 
[0m07:06:17.181417 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m07:06:17.182486 [debug] [MainThread]: Command end result
[0m07:06:17.191583 [info ] [MainThread]: 
[0m07:06:17.192576 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:06:17.192576 [info ] [MainThread]: 
[0m07:06:17.193579 [error] [MainThread]: [33mDatabase Error in model customer_type (models\staging\customer_type.sql)[0m
[0m07:06:17.194625 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m07:06:17.195577 [error] [MainThread]:   Object 'AIRBYTE_DATABASE.AIRBYTE_SCHEMA.CUSTOMER_TYPE' does not exist or not authorized.
[0m07:06:17.195577 [error] [MainThread]:   compiled Code at target\run\northwind\models\staging\customer_type.sql
[0m07:06:17.197082 [info ] [MainThread]: 
[0m07:06:17.198088 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:06:17.199087 [debug] [MainThread]: Command `dbt run` failed at 07:06:17.198088 after 5.12 seconds
[0m07:06:17.199087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE9626C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC3147DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC36ECC70>]}
[0m07:06:17.200092 [debug] [MainThread]: Flushing usage events
[0m07:54:16.259864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115F5B30100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115F9E97FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115F9ECC340>]}


============================== 07:54:16.259864 | d3891d06-2610-490c-9407-d4070658d81f ==============================
[0m07:54:16.259864 [info ] [MainThread]: Running with dbt=1.6.0
[0m07:54:16.259864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select customer_type', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:54:17.713323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3891d06-2610-490c-9407-d4070658d81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115F9E97F40>]}
[0m07:54:17.719701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3891d06-2610-490c-9407-d4070658d81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFA38EB0>]}
[0m07:54:17.719701 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m07:54:17.719701 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m07:54:17.834864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:54:17.834864 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:54:17.834864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m07:54:17.834864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3891d06-2610-490c-9407-d4070658d81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFBCDF10>]}
[0m07:54:17.851140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3891d06-2610-490c-9407-d4070658d81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB0AD90>]}
[0m07:54:17.851140 [info ] [MainThread]: Found 2 models, 14 sources, 0 exposures, 0 metrics, 372 macros, 0 groups, 0 semantic models
[0m07:54:17.858265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3891d06-2610-490c-9407-d4070658d81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB0AA30>]}
[0m07:54:17.859266 [info ] [MainThread]: 
[0m07:54:17.860267 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:54:17.863268 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind'
[0m07:54:17.874725 [debug] [ThreadPool]: Using snowflake connection "list_northwind"
[0m07:54:17.874725 [debug] [ThreadPool]: On list_northwind: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m07:54:17.874725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:54:19.017373 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m07:54:19.019092 [debug] [ThreadPool]: On list_northwind: Close
[0m07:54:19.100209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northwind, now create_northwind_RAW_staging)
[0m07:54:19.101217 [debug] [ThreadPool]: Creating schema "database: "northwind"
schema: "RAW_staging"
"
[0m07:54:19.105218 [debug] [ThreadPool]: Using snowflake connection "create_northwind_RAW_staging"
[0m07:54:19.106219 [debug] [ThreadPool]: On create_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "create_northwind_RAW_staging"} */
create schema if not exists northwind.RAW_staging
[0m07:54:19.106219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:54:19.756483 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:54:19.756483 [debug] [ThreadPool]: On create_northwind_RAW_staging: Close
[0m07:54:19.841672 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind_RAW_staging'
[0m07:54:19.841672 [debug] [ThreadPool]: Using snowflake connection "list_northwind_RAW_staging"
[0m07:54:19.857396 [debug] [ThreadPool]: On list_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind_RAW_staging"} */
show terse objects in northwind.RAW_staging limit 10000
[0m07:54:19.857396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:54:20.637714 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m07:54:20.638717 [debug] [ThreadPool]: On list_northwind_RAW_staging: Close
[0m07:54:20.716073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northwind_RAW_staging, now list_sales_RAW_staging)
[0m07:54:20.718070 [debug] [ThreadPool]: Using snowflake connection "list_sales_RAW_staging"
[0m07:54:20.719684 [debug] [ThreadPool]: On list_sales_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_sales_RAW_staging"} */
show terse objects in sales.RAW_staging limit 10000
[0m07:54:20.719684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:54:21.544147 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b04d46-3200-f43f-0004-6e520001455a
[0m07:54:21.545167 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m07:54:21.545167 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m07:54:21.546147 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:54:21.547148 [debug] [ThreadPool]: On list_sales_RAW_staging: Close
[0m07:54:21.621693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3891d06-2610-490c-9407-d4070658d81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FFB0A8B0>]}
[0m07:54:21.621693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:54:21.621693 [info ] [MainThread]: 
[0m07:54:21.637330 [debug] [Thread-1  ]: Began running node model.northwind.customer_type
[0m07:54:21.637330 [info ] [Thread-1  ]: 1 of 1 START sql table model northwind.RAW_staging.customer_type ............... [RUN]
[0m07:54:21.637330 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.customer_type'
[0m07:54:21.637330 [debug] [Thread-1  ]: Began compiling node model.northwind.customer_type
[0m07:54:21.650388 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.customer_type"
[0m07:54:21.656401 [debug] [Thread-1  ]: Timing info for model.northwind.customer_type (compile): 07:54:21.647112 => 07:54:21.656401
[0m07:54:21.657422 [debug] [Thread-1  ]: Began executing node model.northwind.customer_type
[0m07:54:21.678063 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.customer_type"
[0m07:54:21.678063 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.customer_type"
[0m07:54:21.678063 [debug] [Thread-1  ]: On model.northwind.customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.customer_type"} */
create or replace transient table northwind.RAW_staging.customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m07:54:21.678063 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:54:22.889866 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:54:22.905629 [debug] [Thread-1  ]: Timing info for model.northwind.customer_type (execute): 07:54:21.658415 => 07:54:22.905629
[0m07:54:22.906629 [debug] [Thread-1  ]: On model.northwind.customer_type: Close
[0m07:54:22.996513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3891d06-2610-490c-9407-d4070658d81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115A31A79A0>]}
[0m07:54:22.996513 [info ] [Thread-1  ]: 1 of 1 OK created sql table model northwind.RAW_staging.customer_type .......... [[32mSUCCESS 1[0m in 1.36s]
[0m07:54:22.996513 [debug] [Thread-1  ]: Finished running node model.northwind.customer_type
[0m07:54:22.996513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:54:22.996513 [debug] [MainThread]: Connection 'create_northwind_RAW_staging' was properly closed.
[0m07:54:22.996513 [debug] [MainThread]: Connection 'list_sales_RAW_staging' was properly closed.
[0m07:54:22.996513 [debug] [MainThread]: Connection 'model.northwind.customer_type' was properly closed.
[0m07:54:22.996513 [info ] [MainThread]: 
[0m07:54:22.996513 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m07:54:22.996513 [debug] [MainThread]: Command end result
[0m07:54:23.047972 [info ] [MainThread]: 
[0m07:54:23.047972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:54:23.047972 [info ] [MainThread]: 
[0m07:54:23.047972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:54:23.047972 [debug] [MainThread]: Command `dbt run` succeeded at 07:54:23.047972 after 6.83 seconds
[0m07:54:23.047972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115F5B30100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115FA01A9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115A2FF21C0>]}
[0m07:54:23.047972 [debug] [MainThread]: Flushing usage events
[0m07:55:34.731626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181E88AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181ECC07FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181ECC07FA0>]}


============================== 07:55:34.747252 | a76adedb-cceb-4e03-92a1-8e7da70d451c ==============================
[0m07:55:34.747252 [info ] [MainThread]: Running with dbt=1.6.0
[0m07:55:34.747252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select customers', 'send_anonymous_usage_stats': 'True'}
[0m07:55:35.629401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a76adedb-cceb-4e03-92a1-8e7da70d451c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181ECC07F10>]}
[0m07:55:35.629401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a76adedb-cceb-4e03-92a1-8e7da70d451c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018195776E80>]}
[0m07:55:35.629401 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m07:55:35.645013 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m07:55:35.716104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:55:35.716104 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\customers.sql
[0m07:55:35.754376 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m07:55:35.758396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a76adedb-cceb-4e03-92a1-8e7da70d451c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181958F90D0>]}
[0m07:55:35.765804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a76adedb-cceb-4e03-92a1-8e7da70d451c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819584AAC0>]}
[0m07:55:35.766803 [info ] [MainThread]: Found 2 models, 14 sources, 0 exposures, 0 metrics, 372 macros, 0 groups, 0 semantic models
[0m07:55:35.767675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a76adedb-cceb-4e03-92a1-8e7da70d451c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181958D0E80>]}
[0m07:55:35.767675 [info ] [MainThread]: 
[0m07:55:35.767675 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:55:35.767675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind'
[0m07:55:35.780503 [debug] [ThreadPool]: Using snowflake connection "list_northwind"
[0m07:55:35.780503 [debug] [ThreadPool]: On list_northwind: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m07:55:35.781639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:55:36.830289 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m07:55:36.830289 [debug] [ThreadPool]: On list_northwind: Close
[0m07:55:36.924676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind_RAW_staging'
[0m07:55:36.942268 [debug] [ThreadPool]: Using snowflake connection "list_northwind_RAW_staging"
[0m07:55:36.942268 [debug] [ThreadPool]: On list_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind_RAW_staging"} */
show terse objects in northwind.RAW_staging limit 10000
[0m07:55:36.942268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:55:37.804691 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:55:37.805273 [debug] [ThreadPool]: On list_northwind_RAW_staging: Close
[0m07:55:37.899855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a76adedb-cceb-4e03-92a1-8e7da70d451c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819584AA60>]}
[0m07:55:37.899855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:55:37.899855 [info ] [MainThread]: 
[0m07:55:37.911501 [debug] [Thread-1  ]: Began running node model.northwind.customers
[0m07:55:37.911501 [info ] [Thread-1  ]: 1 of 1 START sql table model northwind.RAW_staging.customers ................... [RUN]
[0m07:55:37.913158 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.customers'
[0m07:55:37.914222 [debug] [Thread-1  ]: Began compiling node model.northwind.customers
[0m07:55:37.917827 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.customers"
[0m07:55:37.917827 [debug] [Thread-1  ]: Timing info for model.northwind.customers (compile): 07:55:37.914222 => 07:55:37.917827
[0m07:55:37.917827 [debug] [Thread-1  ]: Began executing node model.northwind.customers
[0m07:55:37.935442 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.customers"
[0m07:55:37.935442 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.customers"
[0m07:55:37.935442 [debug] [Thread-1  ]: On model.northwind.customers: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.customers"} */
create or replace transient table northwind.RAW_staging.customers
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m07:55:37.935442 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:55:39.124620 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:55:39.139112 [debug] [Thread-1  ]: Timing info for model.northwind.customers (execute): 07:55:37.917827 => 07:55:39.139112
[0m07:55:39.139694 [debug] [Thread-1  ]: On model.northwind.customers: Close
[0m07:55:39.227453 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a76adedb-cceb-4e03-92a1-8e7da70d451c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018195D83FD0>]}
[0m07:55:39.228883 [info ] [Thread-1  ]: 1 of 1 OK created sql table model northwind.RAW_staging.customers .............. [[32mSUCCESS 1[0m in 1.31s]
[0m07:55:39.229999 [debug] [Thread-1  ]: Finished running node model.northwind.customers
[0m07:55:39.232521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:55:39.232823 [debug] [MainThread]: Connection 'list_northwind' was properly closed.
[0m07:55:39.233327 [debug] [MainThread]: Connection 'list_northwind_RAW_staging' was properly closed.
[0m07:55:39.233516 [debug] [MainThread]: Connection 'model.northwind.customers' was properly closed.
[0m07:55:39.234107 [info ] [MainThread]: 
[0m07:55:39.234704 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m07:55:39.235917 [debug] [MainThread]: Command end result
[0m07:55:39.286840 [info ] [MainThread]: 
[0m07:55:39.288006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:55:39.289177 [info ] [MainThread]: 
[0m07:55:39.290162 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:55:39.290971 [debug] [MainThread]: Command `dbt run` succeeded at 07:55:39.290971 after 4.56 seconds
[0m07:55:39.290971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181E88AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181958B89A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181ECD8A970>]}
[0m07:55:39.290971 [debug] [MainThread]: Flushing usage events
[0m10:27:03.811050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7D85CC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DC927FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DC927FA0>]}


============================== 10:27:03.816075 | 1b9188f9-7ef0-41b6-881d-5014f7d2e5d1 ==============================
[0m10:27:03.816075 [info ] [MainThread]: Running with dbt=1.6.0
[0m10:27:03.816075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customer', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:27:06.116177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b9188f9-7ef0-41b6-881d-5014f7d2e5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DC927F10>]}
[0m10:27:06.126428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b9188f9-7ef0-41b6-881d-5014f7d2e5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A785498E80>]}
[0m10:27:06.126428 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m10:27:06.131691 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 15 files added, 0 files changed.
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_customer.sql
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_order_detail.sql
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_supplier.sql
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_product.sql
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_supplier.sql
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_category.sql
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_customer_customer_type.sql
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_order.sql
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_product.sql
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_customer.sql
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_customer.yml
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_product.yml
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_supplier.yml
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\sources\sources.yml
[0m10:27:06.281425 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_customer_type.sql
[0m10:27:06.291134 [debug] [MainThread]: Partial parsing: deleted file: northwind://models\staging\customers.sql
[0m10:27:06.291755 [debug] [MainThread]: Partial parsing: deleted file: northwind://models\staging\customer_type.sql
[0m10:27:06.411029 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m10:27:06.417970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b9188f9-7ef0-41b6-881d-5014f7d2e5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78569C160>]}
[0m10:27:06.431391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b9188f9-7ef0-41b6-881d-5014f7d2e5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7855689A0>]}
[0m10:27:06.431391 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 372 macros, 0 groups, 0 semantic models
[0m10:27:06.432897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b9188f9-7ef0-41b6-881d-5014f7d2e5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7855686A0>]}
[0m10:27:06.434218 [info ] [MainThread]: 
[0m10:27:06.435084 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:27:06.435084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NORTHWIND'
[0m10:27:06.451281 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND"
[0m10:27:06.451281 [debug] [ThreadPool]: On list_NORTHWIND: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND"} */
show terse schemas in database NORTHWIND
    limit 10000
[0m10:27:06.451281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:08.847109 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m10:27:08.852785 [debug] [ThreadPool]: On list_NORTHWIND: Close
[0m10:27:08.961238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NORTHWIND, now create_NORTHWIND_RAW_CURATED)
[0m10:27:08.966397 [debug] [ThreadPool]: Creating schema "database: "NORTHWIND"
schema: "RAW_CURATED"
"
[0m10:27:08.976556 [debug] [ThreadPool]: Using snowflake connection "create_NORTHWIND_RAW_CURATED"
[0m10:27:08.981705 [debug] [ThreadPool]: On create_NORTHWIND_RAW_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "create_NORTHWIND_RAW_CURATED"} */
create schema if not exists NORTHWIND.RAW_CURATED
[0m10:27:08.981705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:10.051300 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:27:10.051300 [debug] [ThreadPool]: On create_NORTHWIND_RAW_CURATED: Close
[0m10:27:10.149976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NORTHWIND_RAW'
[0m10:27:10.156522 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_RAW"
[0m10:27:10.156522 [debug] [ThreadPool]: On list_NORTHWIND_RAW: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND_RAW"} */
show terse objects in NORTHWIND.RAW limit 10000
[0m10:27:10.156522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:10.927816 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:27:10.927816 [debug] [ThreadPool]: On list_NORTHWIND_RAW: Close
[0m10:27:11.021599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NORTHWIND_RAW, now list_northwind_RAW_staging)
[0m10:27:11.025702 [debug] [ThreadPool]: Using snowflake connection "list_northwind_RAW_staging"
[0m10:27:11.025702 [debug] [ThreadPool]: On list_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind_RAW_staging"} */
show terse objects in northwind.RAW_staging limit 10000
[0m10:27:11.025702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:11.791596 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m10:27:11.791596 [debug] [ThreadPool]: On list_northwind_RAW_staging: Close
[0m10:27:11.891498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northwind_RAW_staging, now list_NORTHWIND_RAW_CURATED)
[0m10:27:11.899260 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_RAW_CURATED"
[0m10:27:11.899260 [debug] [ThreadPool]: On list_NORTHWIND_RAW_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND_RAW_CURATED"} */
show terse objects in NORTHWIND.RAW_CURATED limit 10000
[0m10:27:11.901559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:12.799602 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:27:12.801667 [debug] [ThreadPool]: On list_NORTHWIND_RAW_CURATED: Close
[0m10:27:12.911357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b9188f9-7ef0-41b6-881d-5014f7d2e5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78575EB80>]}
[0m10:27:12.911357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:12.911357 [info ] [MainThread]: 
[0m10:27:12.921448 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m10:27:12.921448 [info ] [Thread-1  ]: 1 of 1 START sql view model RAW_CURATED.dim_customer ........................... [RUN]
[0m10:27:12.921448 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer'
[0m10:27:12.924253 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m10:27:12.932533 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 10:27:12.924253 => 10:27:12.932533
[0m10:27:12.941077 [debug] [Thread-1  ]: Compilation Error in model dim_customer (models\serving\dim_customer.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:27:12.941077 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b9188f9-7ef0-41b6-881d-5014f7d2e5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A785D7BEB0>]}
[0m10:27:12.941077 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model RAW_CURATED.dim_customer .................. [[31mERROR[0m in 0.02s]
[0m10:27:12.941077 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m10:27:12.952004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:12.952004 [debug] [MainThread]: Connection 'create_NORTHWIND_RAW_CURATED' was properly closed.
[0m10:27:12.953569 [debug] [MainThread]: Connection 'list_NORTHWIND_RAW_CURATED' was properly closed.
[0m10:27:12.954125 [debug] [MainThread]: Connection 'model.northwind.dim_customer' was properly closed.
[0m10:27:12.954938 [info ] [MainThread]: 
[0m10:27:12.954938 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.52 seconds (6.52s).
[0m10:27:12.954938 [debug] [MainThread]: Command end result
[0m10:27:12.961460 [info ] [MainThread]: 
[0m10:27:12.970233 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:27:12.970233 [info ] [MainThread]: 
[0m10:27:12.971242 [error] [MainThread]: [33mCompilation Error in model dim_customer (models\serving\dim_customer.sql)[0m
[0m10:27:12.971242 [error] [MainThread]:   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:27:12.971242 [info ] [MainThread]: 
[0m10:27:12.971242 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:27:12.975554 [debug] [MainThread]: Command `dbt run` failed at 10:27:12.975554 after 9.18 seconds
[0m10:27:12.975554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7D85CC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A785498E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A785B53EE0>]}
[0m10:27:12.975554 [debug] [MainThread]: Flushing usage events
[0m10:28:10.896569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B356C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B78C7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B78C7F10>]}


============================== 10:28:10.899575 | 34a87291-3d4d-4c4f-9e8f-ad3add2ed689 ==============================
[0m10:28:10.899575 [info ] [MainThread]: Running with dbt=1.6.0
[0m10:28:10.901703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:28:10.975702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34a87291-3d4d-4c4f-9e8f-ad3add2ed689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B793AC10>]}
[0m10:28:10.981863 [debug] [MainThread]: Set downloads directory='C:\Users\maryc\AppData\Local\Temp\dbt-downloads-7npl48be'
[0m10:28:10.981863 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:28:12.032154 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:28:12.042060 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:28:12.702210 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:28:12.702210 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m10:28:13.292240 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m10:28:13.311994 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:28:14.354429 [info ] [MainThread]: Installed from version 1.0.0
[0m10:28:14.354429 [info ] [MainThread]: Updated version available: 1.1.1
[0m10:28:14.354429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '34a87291-3d4d-4c4f-9e8f-ad3add2ed689', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B7953F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B79530D0>]}
[0m10:28:14.354429 [info ] [MainThread]: Installing calogica/dbt_date
[0m10:28:15.196708 [info ] [MainThread]: Installed from version 0.9.2
[0m10:28:15.196708 [info ] [MainThread]: Updated version available: 0.10.0
[0m10:28:15.196708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '34a87291-3d4d-4c4f-9e8f-ad3add2ed689', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B7930D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B7930700>]}
[0m10:28:15.196708 [info ] [MainThread]: 
[0m10:28:15.201915 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m10:28:15.204423 [debug] [MainThread]: Command `dbt deps` succeeded at 10:28:15.204423 after 4.33 seconds
[0m10:28:15.204423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B356C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0E85E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B0E85F10>]}
[0m10:28:15.204423 [debug] [MainThread]: Flushing usage events
[0m10:28:28.812819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D3287C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D36BD7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D36BD7FA0>]}


============================== 10:28:28.812819 | dd58e694-07ac-47bc-87ce-ca3588291cba ==============================
[0m10:28:28.812819 [info ] [MainThread]: Running with dbt=1.6.0
[0m10:28:28.821945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customer', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:28:29.922049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd58e694-07ac-47bc-87ce-ca3588291cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D36BD7F40>]}
[0m10:28:29.932147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd58e694-07ac-47bc-87ce-ca3588291cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D5F742C10>]}
[0m10:28:29.932147 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m10:28:29.992120 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m10:28:30.015277 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m10:28:30.021928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd58e694-07ac-47bc-87ce-ca3588291cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D5F7546A0>]}
[0m10:28:32.247130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m10:28:32.252400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd58e694-07ac-47bc-87ce-ca3588291cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D5FBCD0D0>]}
[0m10:28:32.272282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd58e694-07ac-47bc-87ce-ca3588291cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D5F754790>]}
[0m10:28:32.272282 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 604 macros, 0 groups, 0 semantic models
[0m10:28:32.272282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd58e694-07ac-47bc-87ce-ca3588291cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D5F849070>]}
[0m10:28:32.276049 [info ] [MainThread]: 
[0m10:28:32.276049 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:28:32.280674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NORTHWIND'
[0m10:28:32.292999 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND"
[0m10:28:32.292999 [debug] [ThreadPool]: On list_NORTHWIND: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND"} */
show terse schemas in database NORTHWIND
    limit 10000
[0m10:28:32.297111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:33.731988 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m10:28:33.732995 [debug] [ThreadPool]: On list_NORTHWIND: Close
[0m10:28:33.822024 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NORTHWIND_RAW_CURATED'
[0m10:28:33.843675 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_RAW_CURATED"
[0m10:28:33.843675 [debug] [ThreadPool]: On list_NORTHWIND_RAW_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND_RAW_CURATED"} */
show terse objects in NORTHWIND.RAW_CURATED limit 10000
[0m10:28:33.843675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:34.791840 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:28:34.796891 [debug] [ThreadPool]: On list_NORTHWIND_RAW_CURATED: Close
[0m10:28:34.892018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NORTHWIND_RAW_CURATED, now list_northwind_RAW_staging)
[0m10:28:34.896035 [debug] [ThreadPool]: Using snowflake connection "list_northwind_RAW_staging"
[0m10:28:34.896035 [debug] [ThreadPool]: On list_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind_RAW_staging"} */
show terse objects in northwind.RAW_staging limit 10000
[0m10:28:34.896035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:36.242631 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m10:28:36.242631 [debug] [ThreadPool]: On list_northwind_RAW_staging: Close
[0m10:28:36.342698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northwind_RAW_staging, now list_NORTHWIND_RAW)
[0m10:28:36.342698 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_RAW"
[0m10:28:36.342698 [debug] [ThreadPool]: On list_NORTHWIND_RAW: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND_RAW"} */
show terse objects in NORTHWIND.RAW limit 10000
[0m10:28:36.351985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:37.422080 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:28:37.422080 [debug] [ThreadPool]: On list_NORTHWIND_RAW: Close
[0m10:28:37.521860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd58e694-07ac-47bc-87ce-ca3588291cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D5FB7A3A0>]}
[0m10:28:37.521860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:28:37.532813 [info ] [MainThread]: 
[0m10:28:37.539784 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m10:28:37.539784 [info ] [Thread-1  ]: 1 of 1 START sql view model RAW_CURATED.dim_customer ........................... [RUN]
[0m10:28:37.543107 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer'
[0m10:28:37.543734 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m10:28:37.554838 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer"
[0m10:28:37.556410 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 10:28:37.543734 => 10:28:37.556410
[0m10:28:37.556410 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer
[0m10:28:37.586359 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer"
[0m10:28:37.589328 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer"
[0m10:28:37.589328 [debug] [Thread-1  ]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace   view NORTHWIND.RAW_CURATED.dim_customer
  
   as (
    with stg_customer as (
    select *
    from northwind.RAW_staging.stg_customer
)

select
    
    
md5(cast(coalesce(cast(stg_customer.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_customer.company_name,
    stg_customer.contact_name,
    stg_customer.contact_title,
    stg_customer.address,
    stg_customer.city,
    stg_customer.region,
    stg_customer.postal_code,
    stg_customer.country,
    stg_customer.phone
from stg_customer
  );
[0m10:28:37.589328 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:28:38.622134 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b05ec0-3200-f583-0004-6e520001c026
[0m10:28:38.622134 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'NORTHWIND.RAW_STAGING.STG_CUSTOMER' does not exist or not authorized.
[0m10:28:38.622134 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (execute): 10:28:37.556410 => 10:28:38.622134
[0m10:28:38.622134 [debug] [Thread-1  ]: On model.northwind.dim_customer: Close
[0m10:28:38.725221 [debug] [Thread-1  ]: Database Error in model dim_customer (models\serving\dim_customer.sql)
  002003 (42S02): SQL compilation error:
  Object 'NORTHWIND.RAW_STAGING.STG_CUSTOMER' does not exist or not authorized.
  compiled Code at target\run\northwind\models\serving\dim_customer.sql
[0m10:28:38.731833 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd58e694-07ac-47bc-87ce-ca3588291cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D600ED6D0>]}
[0m10:28:38.731833 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model RAW_CURATED.dim_customer .................. [[31mERROR[0m in 1.18s]
[0m10:28:38.736960 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m10:28:38.742226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:38.742226 [debug] [MainThread]: Connection 'list_NORTHWIND' was properly closed.
[0m10:28:38.742226 [debug] [MainThread]: Connection 'list_NORTHWIND_RAW' was properly closed.
[0m10:28:38.742226 [debug] [MainThread]: Connection 'model.northwind.dim_customer' was properly closed.
[0m10:28:38.742226 [info ] [MainThread]: 
[0m10:28:38.742226 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.47 seconds (6.47s).
[0m10:28:38.746861 [debug] [MainThread]: Command end result
[0m10:28:38.835144 [info ] [MainThread]: 
[0m10:28:38.835503 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:28:38.835503 [info ] [MainThread]: 
[0m10:28:38.835503 [error] [MainThread]: [33mDatabase Error in model dim_customer (models\serving\dim_customer.sql)[0m
[0m10:28:38.835503 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m10:28:38.835503 [error] [MainThread]:   Object 'NORTHWIND.RAW_STAGING.STG_CUSTOMER' does not exist or not authorized.
[0m10:28:38.841147 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\dim_customer.sql
[0m10:28:38.841229 [info ] [MainThread]: 
[0m10:28:38.842235 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:28:38.842235 [debug] [MainThread]: Command `dbt run` failed at 10:28:38.842235 after 10.05 seconds
[0m10:28:38.842235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D3287C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D5FFC35E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D5FFC3250>]}
[0m10:28:38.842235 [debug] [MainThread]: Flushing usage events
[0m10:29:23.152728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6B89CC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6BCD27FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6BCD27F70>]}


============================== 10:29:23.157340 | 0b1ad7aa-d2d8-4a60-814c-bfe7db617a1c ==============================
[0m10:29:23.157340 [info ] [MainThread]: Running with dbt=1.6.0
[0m10:29:23.157340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_customer', 'send_anonymous_usage_stats': 'True'}
[0m10:29:24.365326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b1ad7aa-d2d8-4a60-814c-bfe7db617a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6BCD27F10>]}
[0m10:29:24.382263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b1ad7aa-d2d8-4a60-814c-bfe7db617a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E5898F70>]}
[0m10:29:24.382263 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m10:29:24.406737 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m10:29:24.552523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:24.552523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:24.556630 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m10:29:24.562981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b1ad7aa-d2d8-4a60-814c-bfe7db617a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E5B3A0D0>]}
[0m10:29:24.582285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b1ad7aa-d2d8-4a60-814c-bfe7db617a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E59F8880>]}
[0m10:29:24.582285 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 604 macros, 0 groups, 0 semantic models
[0m10:29:24.586290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1ad7aa-d2d8-4a60-814c-bfe7db617a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E59F8670>]}
[0m10:29:24.586290 [info ] [MainThread]: 
[0m10:29:24.586290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:29:24.586290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind'
[0m10:29:24.604510 [debug] [ThreadPool]: Using snowflake connection "list_northwind"
[0m10:29:24.604510 [debug] [ThreadPool]: On list_northwind: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m10:29:24.608226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:25.792763 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m10:29:25.805466 [debug] [ThreadPool]: On list_northwind: Close
[0m10:29:25.892627 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NORTHWIND_RAW_CURATED'
[0m10:29:25.902912 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_RAW_CURATED"
[0m10:29:25.902912 [debug] [ThreadPool]: On list_NORTHWIND_RAW_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND_RAW_CURATED"} */
show terse objects in NORTHWIND.RAW_CURATED limit 10000
[0m10:29:25.902912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:26.702394 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:29:26.702394 [debug] [ThreadPool]: On list_NORTHWIND_RAW_CURATED: Close
[0m10:29:26.786671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NORTHWIND_RAW_CURATED, now list_northwind_RAW_staging)
[0m10:29:26.796322 [debug] [ThreadPool]: Using snowflake connection "list_northwind_RAW_staging"
[0m10:29:26.796322 [debug] [ThreadPool]: On list_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind_RAW_staging"} */
show terse objects in northwind.RAW_staging limit 10000
[0m10:29:26.796322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:27.807983 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m10:29:27.812499 [debug] [ThreadPool]: On list_northwind_RAW_staging: Close
[0m10:29:27.922852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northwind_RAW_staging, now list_NORTHWIND_RAW)
[0m10:29:27.922852 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_RAW"
[0m10:29:27.932865 [debug] [ThreadPool]: On list_NORTHWIND_RAW: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND_RAW"} */
show terse objects in NORTHWIND.RAW limit 10000
[0m10:29:27.934377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:29.025902 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:29:29.025902 [debug] [ThreadPool]: On list_NORTHWIND_RAW: Close
[0m10:29:29.112645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1ad7aa-d2d8-4a60-814c-bfe7db617a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E5329F40>]}
[0m10:29:29.117297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:29.118980 [info ] [MainThread]: 
[0m10:29:29.122893 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m10:29:29.122893 [info ] [Thread-1  ]: 1 of 1 START sql table model northwind.RAW_staging.stg_customer ................ [RUN]
[0m10:29:29.133121 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_customer'
[0m10:29:29.133121 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m10:29:29.143776 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m10:29:29.152359 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 10:29:29.133121 => 10:29:29.152359
[0m10:29:29.152359 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m10:29:29.182361 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m10:29:29.188272 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m10:29:29.188272 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_customer"} */
create or replace transient table northwind.RAW_staging.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m10:29:29.188272 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:29:31.192421 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:29:31.222815 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 10:29:29.157247 => 10:29:31.222815
[0m10:29:31.222815 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m10:29:31.332269 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b1ad7aa-d2d8-4a60-814c-bfe7db617a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E603DAF0>]}
[0m10:29:31.332269 [info ] [Thread-1  ]: 1 of 1 OK created sql table model northwind.RAW_staging.stg_customer ........... [[32mSUCCESS 1[0m in 2.20s]
[0m10:29:31.332269 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m10:29:31.342285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:31.342285 [debug] [MainThread]: Connection 'list_northwind' was properly closed.
[0m10:29:31.344314 [debug] [MainThread]: Connection 'list_NORTHWIND_RAW' was properly closed.
[0m10:29:31.345714 [debug] [MainThread]: Connection 'model.northwind.stg_customer' was properly closed.
[0m10:29:31.346617 [info ] [MainThread]: 
[0m10:29:31.348684 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.76 seconds (6.76s).
[0m10:29:31.348684 [debug] [MainThread]: Command end result
[0m10:29:31.362510 [info ] [MainThread]: 
[0m10:29:31.362510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:31.362510 [info ] [MainThread]: 
[0m10:29:31.362510 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:31.362510 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:31.362510 after 8.23 seconds
[0m10:29:31.362510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6B89CC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E5E64580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E5B36400>]}
[0m10:29:31.362510 [debug] [MainThread]: Flushing usage events
[0m10:29:41.653343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001805215C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180564B7F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180564B7FA0>]}


============================== 10:29:41.653343 | 475fb3f4-9026-4976-8432-7cad8f3f1590 ==============================
[0m10:29:41.653343 [info ] [MainThread]: Running with dbt=1.6.0
[0m10:29:41.662476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customer', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:42.742463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '475fb3f4-9026-4976-8432-7cad8f3f1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180564B7F40>]}
[0m10:29:42.758409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '475fb3f4-9026-4976-8432-7cad8f3f1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807F027FA0>]}
[0m10:29:42.758409 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m10:29:42.809161 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m10:29:42.972536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:42.972536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:42.972536 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind.example
[0m10:29:42.982583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '475fb3f4-9026-4976-8432-7cad8f3f1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807F2C80D0>]}
[0m10:29:42.992636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '475fb3f4-9026-4976-8432-7cad8f3f1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807F2948B0>]}
[0m10:29:42.992636 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 604 macros, 0 groups, 0 semantic models
[0m10:29:42.992636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '475fb3f4-9026-4976-8432-7cad8f3f1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807F2946A0>]}
[0m10:29:42.992636 [info ] [MainThread]: 
[0m10:29:43.002731 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:29:43.002731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NORTHWIND'
[0m10:29:43.018689 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND"
[0m10:29:43.019224 [debug] [ThreadPool]: On list_NORTHWIND: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND"} */
show terse schemas in database NORTHWIND
    limit 10000
[0m10:29:43.019224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:44.282449 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m10:29:44.287565 [debug] [ThreadPool]: On list_NORTHWIND: Close
[0m10:29:44.382592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NORTHWIND_RAW_CURATED'
[0m10:29:44.397760 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_RAW_CURATED"
[0m10:29:44.400371 [debug] [ThreadPool]: On list_NORTHWIND_RAW_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND_RAW_CURATED"} */
show terse objects in NORTHWIND.RAW_CURATED limit 10000
[0m10:29:44.400371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:45.512858 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:29:45.517978 [debug] [ThreadPool]: On list_NORTHWIND_RAW_CURATED: Close
[0m10:29:45.612867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NORTHWIND_RAW_CURATED, now list_northwind_RAW_staging)
[0m10:29:45.617192 [debug] [ThreadPool]: Using snowflake connection "list_northwind_RAW_staging"
[0m10:29:45.617192 [debug] [ThreadPool]: On list_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind_RAW_staging"} */
show terse objects in northwind.RAW_staging limit 10000
[0m10:29:45.617192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:46.577885 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:29:46.582683 [debug] [ThreadPool]: On list_northwind_RAW_staging: Close
[0m10:29:46.666685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northwind_RAW_staging, now list_NORTHWIND_RAW)
[0m10:29:46.677469 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_RAW"
[0m10:29:46.677469 [debug] [ThreadPool]: On list_NORTHWIND_RAW: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND_RAW"} */
show terse objects in NORTHWIND.RAW limit 10000
[0m10:29:46.677469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:47.422904 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:29:47.422904 [debug] [ThreadPool]: On list_NORTHWIND_RAW: Close
[0m10:29:47.517854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '475fb3f4-9026-4976-8432-7cad8f3f1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807EAB9F70>]}
[0m10:29:47.517854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:47.522663 [info ] [MainThread]: 
[0m10:29:47.532391 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m10:29:47.532391 [info ] [Thread-1  ]: 1 of 1 START sql view model RAW_CURATED.dim_customer ........................... [RUN]
[0m10:29:47.536855 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer'
[0m10:29:47.536855 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m10:29:47.562473 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer"
[0m10:29:47.562658 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 10:29:47.536855 => 10:29:47.562658
[0m10:29:47.562658 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer
[0m10:29:47.592938 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer"
[0m10:29:47.597085 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer"
[0m10:29:47.597085 [debug] [Thread-1  ]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace   view NORTHWIND.RAW_CURATED.dim_customer
  
   as (
    with stg_customer as (
    select *
    from northwind.RAW_staging.stg_customer
)

select
    
    
md5(cast(coalesce(cast(stg_customer.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_customer.company_name,
    stg_customer.contact_name,
    stg_customer.contact_title,
    stg_customer.address,
    stg_customer.city,
    stg_customer.region,
    stg_customer.postal_code,
    stg_customer.country,
    stg_customer.phone
from stg_customer
  );
[0m10:29:47.598187 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:29:48.607670 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:29:48.637301 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (execute): 10:29:47.562658 => 10:29:48.637301
[0m10:29:48.637301 [debug] [Thread-1  ]: On model.northwind.dim_customer: Close
[0m10:29:48.722693 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '475fb3f4-9026-4976-8432-7cad8f3f1590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001807F6EDD00>]}
[0m10:29:48.722693 [info ] [Thread-1  ]: 1 of 1 OK created sql view model RAW_CURATED.dim_customer ...................... [[32mSUCCESS 1[0m in 1.19s]
[0m10:29:48.733569 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m10:29:48.733569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:48.733569 [debug] [MainThread]: Connection 'list_NORTHWIND' was properly closed.
[0m10:29:48.733569 [debug] [MainThread]: Connection 'list_NORTHWIND_RAW' was properly closed.
[0m10:29:48.733569 [debug] [MainThread]: Connection 'model.northwind.dim_customer' was properly closed.
[0m10:29:48.733569 [info ] [MainThread]: 
[0m10:29:48.733569 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m10:29:48.742383 [debug] [MainThread]: Command end result
[0m10:29:48.754261 [info ] [MainThread]: 
[0m10:29:48.754261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:48.754261 [info ] [MainThread]: 
[0m10:29:48.768706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:48.772715 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:48.768706 after 7.14 seconds
[0m10:29:48.772715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001805215C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180564B73D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180564B7520>]}
[0m10:29:48.772715 [debug] [MainThread]: Flushing usage events
[0m10:33:39.702403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785D1EC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027861547FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027861547F70>]}


============================== 10:33:39.705950 | d0dfb46f-04dc-45af-b952-b794ee0afda3 ==============================
[0m10:33:39.705950 [info ] [MainThread]: Running with dbt=1.6.0
[0m10:33:39.705950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_customer', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:33:40.757368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0dfb46f-04dc-45af-b952-b794ee0afda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027861547F10>]}
[0m10:33:40.764374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0dfb46f-04dc-45af-b952-b794ee0afda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002780A0B3BE0>]}
[0m10:33:40.774231 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m10:33:40.794242 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m10:33:40.809370 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:33:40.809370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0dfb46f-04dc-45af-b952-b794ee0afda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002780A0C86A0>]}
[0m10:33:42.234599 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m10:33:42.234599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0dfb46f-04dc-45af-b952-b794ee0afda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002780A48AF10>]}
[0m10:33:42.258593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0dfb46f-04dc-45af-b952-b794ee0afda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002780A0C87F0>]}
[0m10:33:42.258593 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 604 macros, 0 groups, 0 semantic models
[0m10:33:42.258593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0dfb46f-04dc-45af-b952-b794ee0afda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002786157D340>]}
[0m10:33:42.264340 [info ] [MainThread]: 
[0m10:33:42.264340 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:33:42.264340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NORTHWIND'
[0m10:33:42.277515 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND"
[0m10:33:42.277515 [debug] [ThreadPool]: On list_NORTHWIND: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND"} */
show terse schemas in database NORTHWIND
    limit 10000
[0m10:33:42.284535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:43.624585 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m10:33:43.624585 [debug] [ThreadPool]: On list_NORTHWIND: Close
[0m10:33:43.715226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind_RAW_staging'
[0m10:33:43.730600 [debug] [ThreadPool]: Using snowflake connection "list_northwind_RAW_staging"
[0m10:33:43.730600 [debug] [ThreadPool]: On list_northwind_RAW_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_northwind_RAW_staging"} */
show terse objects in northwind.RAW_staging limit 10000
[0m10:33:43.730600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:44.585203 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:33:44.585203 [debug] [ThreadPool]: On list_northwind_RAW_staging: Close
[0m10:33:44.689573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northwind_RAW_staging, now list_NORTHWIND_RAW_CURATED)
[0m10:33:44.694395 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_RAW_CURATED"
[0m10:33:44.694395 [debug] [ThreadPool]: On list_NORTHWIND_RAW_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND_RAW_CURATED"} */
show terse objects in NORTHWIND.RAW_CURATED limit 10000
[0m10:33:44.694395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:33:45.746711 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:33:45.749225 [debug] [ThreadPool]: On list_NORTHWIND_RAW_CURATED: Close
[0m10:33:45.858056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NORTHWIND_RAW_CURATED, now list_NORTHWIND_RAW)
[0m10:33:45.864591 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_RAW"
[0m10:33:45.864728 [debug] [ThreadPool]: On list_NORTHWIND_RAW: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_NORTHWIND_RAW"} */
show terse objects in NORTHWIND.RAW limit 10000
[0m10:33:45.864728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:33:46.626975 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:33:46.632613 [debug] [ThreadPool]: On list_NORTHWIND_RAW: Close
[0m10:33:46.734586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0dfb46f-04dc-45af-b952-b794ee0afda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002780A52C100>]}
[0m10:33:46.734586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:33:46.738210 [info ] [MainThread]: 
[0m10:33:46.744398 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m10:33:46.744398 [info ] [Thread-1  ]: 1 of 1 START sql view model RAW_CURATED.dim_customer ........................... [RUN]
[0m10:33:46.750785 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer'
[0m10:33:46.750785 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m10:33:46.760237 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer"
[0m10:33:46.760237 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 10:33:46.752157 => 10:33:46.760237
[0m10:33:46.760237 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer
[0m10:33:46.852806 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer"
[0m10:33:46.855492 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer"
[0m10:33:46.856059 [debug] [Thread-1  ]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace   view NORTHWIND.RAW_CURATED.dim_customer
  
   as (
    with stg_customer as (
    select *
    from northwind.RAW_staging.stg_customer
)

select
    
    
md5(cast(coalesce(cast(stg_customer.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_customer.company_name,
    stg_customer.contact_name,
    stg_customer.contact_title,
    stg_customer.address,
    stg_customer.city,
    stg_customer.region,
    stg_customer.postal_code,
    stg_customer.country,
    stg_customer.phone
from stg_customer
  );
[0m10:33:46.856641 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:33:48.021460 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:33:48.059450 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (execute): 10:33:46.764432 => 10:33:48.059450
[0m10:33:48.059450 [debug] [Thread-1  ]: On model.northwind.dim_customer: Close
[0m10:33:48.154799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0dfb46f-04dc-45af-b952-b794ee0afda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002780AA4DD60>]}
[0m10:33:48.154799 [info ] [Thread-1  ]: 1 of 1 OK created sql view model RAW_CURATED.dim_customer ...................... [[32mSUCCESS 1[0m in 1.41s]
[0m10:33:48.154799 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m10:33:48.162638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:48.163646 [debug] [MainThread]: Connection 'list_NORTHWIND' was properly closed.
[0m10:33:48.164185 [debug] [MainThread]: Connection 'list_NORTHWIND_RAW' was properly closed.
[0m10:33:48.164692 [debug] [MainThread]: Connection 'model.northwind.dim_customer' was properly closed.
[0m10:33:48.165184 [info ] [MainThread]: 
[0m10:33:48.165184 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m10:33:48.166777 [debug] [MainThread]: Command end result
[0m10:33:48.181097 [info ] [MainThread]: 
[0m10:33:48.181097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:48.181097 [info ] [MainThread]: 
[0m10:33:48.184607 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:33:48.184607 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:48.184607 after 8.51 seconds
[0m10:33:48.184607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785D1EC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002780A9FBF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002780AA00490>]}
[0m10:33:48.184607 [debug] [MainThread]: Flushing usage events
[0m10:37:32.165952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D649CC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D68D27F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D68D27FD0>]}


============================== 10:37:32.165952 | a978a7c3-631d-4810-8f2b-21ad10be23e0 ==============================
[0m10:37:32.165952 [info ] [MainThread]: Running with dbt=1.6.0
[0m10:37:32.165952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customer', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:37:33.189169 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "northwind", target "prod" invalid: 'schema' is a required property
[0m10:37:33.189169 [debug] [MainThread]: Command `dbt run` failed at 10:37:33.189169 after 1.05 seconds
[0m10:37:33.196218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D649CC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1185F220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1185FE50>]}
[0m10:37:33.196218 [debug] [MainThread]: Flushing usage events
[0m10:39:20.577059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E31F7C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E362D7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E362D7FA0>]}


============================== 10:39:20.582174 | 373543e5-e341-4bc6-a9e3-921850c5cc5d ==============================
[0m10:39:20.582174 [info ] [MainThread]: Running with dbt=1.6.0
[0m10:39:20.582174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_customer', 'send_anonymous_usage_stats': 'True'}
[0m10:39:21.655056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '373543e5-e341-4bc6-a9e3-921850c5cc5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E362D7F40>]}
[0m10:39:21.667393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '373543e5-e341-4bc6-a9e3-921850c5cc5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E5EE49FA0>]}
[0m10:39:21.677157 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m10:39:21.710609 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m10:39:21.740821 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:39:21.746832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '373543e5-e341-4bc6-a9e3-921850c5cc5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E5EE5BE50>]}
[0m10:39:23.149906 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m10:39:23.157161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '373543e5-e341-4bc6-a9e3-921850c5cc5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E5F2200D0>]}
[0m10:39:23.177143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '373543e5-e341-4bc6-a9e3-921850c5cc5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E5EE5BA90>]}
[0m10:39:23.177143 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 604 macros, 0 groups, 0 semantic models
[0m10:39:23.177143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '373543e5-e341-4bc6-a9e3-921850c5cc5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E5EF188E0>]}
[0m10:39:23.183022 [info ] [MainThread]: 
[0m10:39:23.183022 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:39:23.187191 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NORTHWIND'
[0m10:39:23.200573 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND"
[0m10:39:23.200573 [debug] [ThreadPool]: On list_NORTHWIND: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_NORTHWIND"} */
show terse schemas in database NORTHWIND
    limit 10000
[0m10:39:23.200573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:24.506981 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m10:39:24.507110 [debug] [ThreadPool]: On list_NORTHWIND: Close
[0m10:39:24.600831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NORTHWIND, now create_NORTHWIND_prod_CURATED)
[0m10:39:24.607120 [debug] [ThreadPool]: Creating schema "database: "NORTHWIND"
schema: "prod_CURATED"
"
[0m10:39:24.611259 [debug] [ThreadPool]: Using snowflake connection "create_NORTHWIND_prod_CURATED"
[0m10:39:24.617358 [debug] [ThreadPool]: On create_NORTHWIND_prod_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "create_NORTHWIND_prod_CURATED"} */
create schema if not exists NORTHWIND.prod_CURATED
[0m10:39:24.617358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:25.667589 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:39:25.673624 [debug] [ThreadPool]: On create_NORTHWIND_prod_CURATED: Close
[0m10:39:25.757460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NORTHWIND_prod_CURATED'
[0m10:39:25.772393 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_prod_CURATED"
[0m10:39:25.772393 [debug] [ThreadPool]: On list_NORTHWIND_prod_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_NORTHWIND_prod_CURATED"} */
show terse objects in NORTHWIND.prod_CURATED limit 10000
[0m10:39:25.772393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:26.877119 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:39:26.877119 [debug] [ThreadPool]: On list_NORTHWIND_prod_CURATED: Close
[0m10:39:26.972148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NORTHWIND_prod_CURATED, now list_NORTHWIND_prod)
[0m10:39:26.977155 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_prod"
[0m10:39:26.977155 [debug] [ThreadPool]: On list_NORTHWIND_prod: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_NORTHWIND_prod"} */
show terse objects in NORTHWIND.prod limit 10000
[0m10:39:26.977155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:27.807155 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05ecb-3200-f580-0004-6e520001d06a
[0m10:39:27.817556 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:39:27.817556 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:39:27.817556 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:39:27.817556 [debug] [ThreadPool]: On list_NORTHWIND_prod: Close
[0m10:39:27.917423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NORTHWIND_prod, now list_northwind_prod_staging)
[0m10:39:27.922438 [debug] [ThreadPool]: Using snowflake connection "list_northwind_prod_staging"
[0m10:39:27.922438 [debug] [ThreadPool]: On list_northwind_prod_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_northwind_prod_staging"} */
show terse objects in northwind.prod_staging limit 10000
[0m10:39:27.927088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:28.734658 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05ecb-3200-f55a-0004-6e520001e076
[0m10:39:28.735941 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:39:28.735941 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:39:28.737072 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:39:28.737072 [debug] [ThreadPool]: On list_northwind_prod_staging: Close
[0m10:39:28.829816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '373543e5-e341-4bc6-a9e3-921850c5cc5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E5F2CF250>]}
[0m10:39:28.830969 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m10:39:28.832088 [info ] [MainThread]: 
[0m10:39:28.837104 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m10:39:28.837633 [info ] [Thread-1  ]: 1 of 1 START sql view model prod_CURATED.dim_customer .......................... [RUN]
[0m10:39:28.839242 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer'
[0m10:39:28.840315 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m10:39:28.853126 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer"
[0m10:39:28.855277 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 10:39:28.841013 => 10:39:28.854753
[0m10:39:28.856330 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer
[0m10:39:28.901937 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer"
[0m10:39:28.904135 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer"
[0m10:39:28.904778 [debug] [Thread-1  ]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer"} */
create or replace   view NORTHWIND.prod_CURATED.dim_customer
  
   as (
    with stg_customer as (
    select *
    from northwind.prod_staging.stg_customer
)

select
    
    
md5(cast(coalesce(cast(stg_customer.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_customer.company_name,
    stg_customer.contact_name,
    stg_customer.contact_title,
    stg_customer.address,
    stg_customer.city,
    stg_customer.region,
    stg_customer.postal_code,
    stg_customer.country,
    stg_customer.phone
from stg_customer
  );
[0m10:39:28.905323 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:39:29.847381 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b05ecb-3200-f596-0004-6e520001a082
[0m10:39:29.847381 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'NORTHWIND.PROD_STAGING' does not exist or not authorized.
[0m10:39:29.850903 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (execute): 10:39:28.856842 => 10:39:29.847381
[0m10:39:29.851977 [debug] [Thread-1  ]: On model.northwind.dim_customer: Close
[0m10:39:29.937270 [debug] [Thread-1  ]: Database Error in model dim_customer (models\serving\dim_customer.sql)
  002003 (02000): SQL compilation error:
  Schema 'NORTHWIND.PROD_STAGING' does not exist or not authorized.
  compiled Code at target\run\northwind\models\serving\dim_customer.sql
[0m10:39:29.937270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373543e5-e341-4bc6-a9e3-921850c5cc5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E5F14B2E0>]}
[0m10:39:29.937270 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model prod_CURATED.dim_customer ................. [[31mERROR[0m in 1.10s]
[0m10:39:29.947949 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m10:39:29.951419 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:29.951419 [debug] [MainThread]: Connection 'create_NORTHWIND_prod_CURATED' was properly closed.
[0m10:39:29.951419 [debug] [MainThread]: Connection 'list_northwind_prod_staging' was properly closed.
[0m10:39:29.951419 [debug] [MainThread]: Connection 'model.northwind.dim_customer' was properly closed.
[0m10:39:29.951419 [info ] [MainThread]: 
[0m10:39:29.951419 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m10:39:29.957528 [debug] [MainThread]: Command end result
[0m10:39:29.967028 [info ] [MainThread]: 
[0m10:39:29.972800 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:39:29.972800 [info ] [MainThread]: 
[0m10:39:29.972800 [error] [MainThread]: [33mDatabase Error in model dim_customer (models\serving\dim_customer.sql)[0m
[0m10:39:29.972800 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m10:39:29.977373 [error] [MainThread]:   Schema 'NORTHWIND.PROD_STAGING' does not exist or not authorized.
[0m10:39:29.977373 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\dim_customer.sql
[0m10:39:29.977373 [info ] [MainThread]: 
[0m10:39:29.980222 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:39:29.981228 [debug] [MainThread]: Command `dbt run` failed at 10:39:29.981228 after 9.42 seconds
[0m10:39:29.981228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E31F7C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E5EE63BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E5F2D9730>]}
[0m10:39:29.981228 [debug] [MainThread]: Flushing usage events
[0m10:53:19.084495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486F9AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024873D08FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024873D08F40>]}


============================== 10:53:19.093563 | 601aff75-9d55-4f3e-8068-3336c35aca9c ==============================
[0m10:53:19.093563 [info ] [MainThread]: Running with dbt=1.6.0
[0m10:53:19.093563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_customer', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:53:20.263770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '601aff75-9d55-4f3e-8068-3336c35aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024873D08EE0>]}
[0m10:53:20.281543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '601aff75-9d55-4f3e-8068-3336c35aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481C877F40>]}
[0m10:53:20.283631 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m10:53:20.307260 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m10:53:20.333804 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:53:20.333804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '601aff75-9d55-4f3e-8068-3336c35aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481C88C3D0>]}
[0m10:53:21.568630 [debug] [MainThread]: Setting Default Schema: prod
[0m10:53:21.580027 [debug] [MainThread]: Setting Default Schema: prod
[0m10:53:21.583754 [debug] [MainThread]: Setting Default Schema: prod
[0m10:53:21.588926 [debug] [MainThread]: Setting Custom Schema: staging
[0m10:53:21.593645 [debug] [MainThread]: Setting Custom Schema: staging
[0m10:53:21.597501 [debug] [MainThread]: Setting Custom Schema: staging
[0m10:53:21.597501 [debug] [MainThread]: Setting Custom Schema: staging
[0m10:53:21.610245 [debug] [MainThread]: Setting Custom Schema: staging
[0m10:53:21.617994 [debug] [MainThread]: Setting Custom Schema: staging
[0m10:53:21.621473 [debug] [MainThread]: Setting Custom Schema: staging
[0m10:53:21.624743 [debug] [MainThread]: Setting Custom Schema: staging
[0m10:53:21.663713 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m10:53:21.678569 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m10:53:21.683776 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m10:53:21.683776 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m10:53:21.683776 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m10:53:21.683776 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m10:53:21.741244 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m10:53:21.748586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '601aff75-9d55-4f3e-8068-3336c35aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481CC4F0D0>]}
[0m10:53:21.764701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '601aff75-9d55-4f3e-8068-3336c35aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481C88C610>]}
[0m10:53:21.764701 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m10:53:21.764701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '601aff75-9d55-4f3e-8068-3336c35aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481C872EB0>]}
[0m10:53:21.764701 [info ] [MainThread]: 
[0m10:53:21.764701 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:53:21.773698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_northwind'
[0m10:53:21.783742 [debug] [ThreadPool]: Using snowflake connection "list_northwind"
[0m10:53:21.783742 [debug] [ThreadPool]: On list_northwind: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_northwind"} */
show terse schemas in database northwind
    limit 10000
[0m10:53:21.788952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:23.023973 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m10:53:23.025236 [debug] [ThreadPool]: On list_northwind: Close
[0m10:53:23.124177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NORTHWIND_CURATED'
[0m10:53:23.144148 [debug] [ThreadPool]: Using snowflake connection "list_NORTHWIND_CURATED"
[0m10:53:23.144148 [debug] [ThreadPool]: On list_NORTHWIND_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_NORTHWIND_CURATED"} */
show terse objects in NORTHWIND.CURATED limit 10000
[0m10:53:23.147039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:24.185959 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:53:24.193783 [debug] [ThreadPool]: On list_NORTHWIND_CURATED: Close
[0m10:53:24.286601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NORTHWIND_CURATED, now list_PROD_prod)
[0m10:53:24.294020 [debug] [ThreadPool]: Using snowflake connection "list_PROD_prod"
[0m10:53:24.294020 [debug] [ThreadPool]: On list_PROD_prod: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_prod"} */
show terse objects in PROD.prod limit 10000
[0m10:53:24.294020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:25.433500 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05ed9-3200-f583-0004-6e520001c08e
[0m10:53:25.433500 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:53:25.433500 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:53:25.433500 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:53:25.433500 [debug] [ThreadPool]: On list_PROD_prod: Close
[0m10:53:25.528492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_prod, now list_PROD_CURATED)
[0m10:53:25.528492 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m10:53:25.533501 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m10:53:25.533501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:26.339874 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05ed9-3200-f589-0004-6e520001b06e
[0m10:53:26.343694 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:53:26.343694 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:53:26.343694 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:53:26.343694 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m10:53:26.443847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_CURATED, now list_northwind_staging)
[0m10:53:26.451373 [debug] [ThreadPool]: Using snowflake connection "list_northwind_staging"
[0m10:53:26.451373 [debug] [ThreadPool]: On list_northwind_staging: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_northwind_staging"} */
show terse objects in northwind.staging limit 10000
[0m10:53:26.451373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:27.343576 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:53:27.353572 [debug] [ThreadPool]: On list_northwind_staging: Close
[0m10:53:27.458905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '601aff75-9d55-4f3e-8068-3336c35aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481CC4F3A0>]}
[0m10:53:27.458905 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m10:53:27.458905 [info ] [MainThread]: 
[0m10:53:27.468573 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m10:53:27.471600 [info ] [Thread-1  ]: 1 of 1 START sql table model northwind.staging.stg_customer .................... [RUN]
[0m10:53:27.473583 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_customer'
[0m10:53:27.473583 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m10:53:27.487576 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m10:53:27.489576 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 10:53:27.473583 => 10:53:27.489576
[0m10:53:27.489576 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m10:53:27.524598 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m10:53:27.524598 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m10:53:27.524598 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer"} */
create or replace transient table northwind.staging.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m10:53:27.524598 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:53:29.434118 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:53:29.454084 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 10:53:27.489576 => 10:53:29.454084
[0m10:53:29.455131 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m10:53:29.542383 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '601aff75-9d55-4f3e-8068-3336c35aca9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481C952FA0>]}
[0m10:53:29.542999 [info ] [Thread-1  ]: 1 of 1 OK created sql table model northwind.staging.stg_customer ............... [[32mSUCCESS 1[0m in 2.07s]
[0m10:53:29.544603 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m10:53:29.547612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:29.548670 [debug] [MainThread]: Connection 'list_northwind' was properly closed.
[0m10:53:29.549193 [debug] [MainThread]: Connection 'list_northwind_staging' was properly closed.
[0m10:53:29.549740 [debug] [MainThread]: Connection 'model.northwind.stg_customer' was properly closed.
[0m10:53:29.550412 [info ] [MainThread]: 
[0m10:53:29.550573 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.79 seconds (7.79s).
[0m10:53:29.552724 [debug] [MainThread]: Command end result
[0m10:53:29.568888 [info ] [MainThread]: 
[0m10:53:29.571790 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:53:29.572456 [info ] [MainThread]: 
[0m10:53:29.572965 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:53:29.575108 [debug] [MainThread]: Command `dbt run` succeeded at 10:53:29.575108 after 10.50 seconds
[0m10:53:29.575811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486F9AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481C970580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481C952FA0>]}
[0m10:53:29.576441 [debug] [MainThread]: Flushing usage events
[0m11:05:39.729188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1476C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A18AC7FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A18AC7FD0>]}


============================== 11:05:39.729188 | cffc1aeb-65e8-448b-9d53-3b871f0b00b3 ==============================
[0m11:05:39.729188 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:05:39.729188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_customer', 'send_anonymous_usage_stats': 'True'}
[0m11:05:40.799630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cffc1aeb-65e8-448b-9d53-3b871f0b00b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A18AC7F70>]}
[0m11:05:40.809512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cffc1aeb-65e8-448b-9d53-3b871f0b00b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A41639FD0>]}
[0m11:05:40.809512 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m11:05:40.839833 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m11:05:40.869620 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:05:40.869620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cffc1aeb-65e8-448b-9d53-3b871f0b00b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A4164B5B0>]}
[0m11:05:42.102053 [debug] [MainThread]: Setting Default Schema: dev
[0m11:05:42.119313 [debug] [MainThread]: Setting Default Schema: dev
[0m11:05:42.124392 [debug] [MainThread]: Setting Default Schema: dev
[0m11:05:42.129398 [debug] [MainThread]: Setting Custom Schema: staging
[0m11:05:42.129398 [debug] [MainThread]: Setting Custom Schema: staging
[0m11:05:42.133422 [debug] [MainThread]: Setting Custom Schema: staging
[0m11:05:42.139474 [debug] [MainThread]: Setting Custom Schema: staging
[0m11:05:42.142660 [debug] [MainThread]: Setting Custom Schema: staging
[0m11:05:42.142660 [debug] [MainThread]: Setting Custom Schema: staging
[0m11:05:42.142660 [debug] [MainThread]: Setting Custom Schema: staging
[0m11:05:42.149667 [debug] [MainThread]: Setting Custom Schema: staging
[0m11:05:42.197003 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m11:05:42.209360 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:05:42.212881 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:05:42.212881 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m11:05:42.219513 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:05:42.219513 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:05:42.272257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m11:05:42.275311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cffc1aeb-65e8-448b-9d53-3b871f0b00b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A41A110D0>]}
[0m11:05:42.292629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cffc1aeb-65e8-448b-9d53-3b871f0b00b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A4164B1C0>]}
[0m11:05:42.295579 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m11:05:42.296714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cffc1aeb-65e8-448b-9d53-3b871f0b00b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A416DBE20>]}
[0m11:05:42.296714 [info ] [MainThread]: 
[0m11:05:42.299232 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:05:42.299232 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}'
[0m11:05:42.319213 [debug] [ThreadPool]: Using snowflake connection "list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}"
[0m11:05:42.319743 [debug] [ThreadPool]: On list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}"} */
show terse schemas in database {{ 'PROD' if target.name == 'prod' else 'DEV' }}
    limit 10000
[0m11:05:42.322309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:43.564583 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05ee5-3200-f580-0004-6e520001d0d6
[0m11:05:43.564583 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 31 unexpected '{'.
[0m11:05:43.569866 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:05:43.569866 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:05:43.573905 [debug] [ThreadPool]: On list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}: Close
[0m11:05:43.671542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:43.671542 [debug] [MainThread]: Connection 'list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}' was properly closed.
[0m11:05:43.674695 [info ] [MainThread]: 
[0m11:05:43.674695 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m11:05:43.674695 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "{{ 'PROD' if target.name == 'prod' else 'DEV' }}"
  Database Error
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 31 unexpected '{'.
[0m11:05:43.680114 [debug] [MainThread]: Command `dbt run` failed at 11:05:43.680114 after 3.98 seconds
[0m11:05:43.680114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A1476C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A416FEBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A41A1CF10>]}
[0m11:05:43.680114 [debug] [MainThread]: Flushing usage events
[0m11:14:41.973919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FB7CFC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FBC057FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FBC057FD0>]}


============================== 11:14:41.973919 | 2e3a60b1-d4df-4b95-9602-6e4a1a4631b5 ==============================
[0m11:14:41.973919 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:14:41.973919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_customer', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:14:43.232353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e3a60b1-d4df-4b95-9602-6e4a1a4631b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FBC057F70>]}
[0m11:14:43.243819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e3a60b1-d4df-4b95-9602-6e4a1a4631b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE4BC9FD0>]}
[0m11:14:43.246199 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m11:14:43.267552 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m11:14:43.535560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 7 files added, 7 files changed.
[0m11:14:43.539178 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_supplier.yml
[0m11:14:43.539178 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_customer_customer_type.yml
[0m11:14:43.539178 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_product.yml
[0m11:14:43.539178 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_order_detail.yml
[0m11:14:43.539178 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_category.yml
[0m11:14:43.539178 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_order.yml
[0m11:14:43.539178 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_customer_type.yml
[0m11:14:43.543751 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_category.sql
[0m11:14:43.544354 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_product.sql
[0m11:14:43.544354 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_customer_type.sql
[0m11:14:43.544354 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_order.sql
[0m11:14:43.544354 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_customer_customer_type.sql
[0m11:14:43.544354 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_order_detail.sql
[0m11:14:43.544354 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_supplier.sql
[0m11:14:43.563707 [debug] [MainThread]: Setting Default Schema: dev
[0m11:14:43.575066 [debug] [MainThread]: Setting Default Schema: dev
[0m11:14:43.575066 [debug] [MainThread]: Setting Default Schema: dev
[0m11:14:43.575066 [debug] [MainThread]: Setting Default Schema: dev
[0m11:14:43.583977 [debug] [MainThread]: Setting Default Schema: dev
[0m11:14:43.583977 [debug] [MainThread]: Setting Default Schema: dev
[0m11:14:43.591031 [debug] [MainThread]: Setting Default Schema: dev
[0m11:14:43.606972 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:14:43.606972 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:14:43.614242 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:14:43.614242 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:14:43.614242 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:14:43.624153 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:14:43.624153 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:14:43.633918 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m11:14:43.644330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e3a60b1-d4df-4b95-9602-6e4a1a4631b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE4F70F10>]}
[0m11:14:43.655994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e3a60b1-d4df-4b95-9602-6e4a1a4631b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE4E3D190>]}
[0m11:14:43.659950 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m11:14:43.661404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e3a60b1-d4df-4b95-9602-6e4a1a4631b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE4E3D250>]}
[0m11:14:43.662902 [info ] [MainThread]: 
[0m11:14:43.664065 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:43.664065 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}'
[0m11:14:43.733893 [debug] [ThreadPool]: Using snowflake connection "list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}"
[0m11:14:43.733893 [debug] [ThreadPool]: On list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}"} */
show terse schemas in database {{ 'PROD' if target.name == 'prod' else 'DEV' }}
    limit 10000
[0m11:14:43.733893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:44.973673 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05eee-3200-f583-0004-6e520001c112
[0m11:14:44.973673 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 31 unexpected '{'.
[0m11:14:44.973673 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:14:44.978716 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:14:44.978716 [debug] [ThreadPool]: On list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}: Close
[0m11:14:45.073938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:45.073938 [debug] [MainThread]: Connection 'list_{{ 'PROD' if target.name == 'prod' else 'DEV' }}' was properly closed.
[0m11:14:45.073938 [info ] [MainThread]: 
[0m11:14:45.078953 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m11:14:45.082456 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "{{ 'PROD' if target.name == 'prod' else 'DEV' }}"
  Database Error
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 31 unexpected '{'.
[0m11:14:45.085929 [debug] [MainThread]: Command `dbt run` failed at 11:14:45.083969 after 3.13 seconds
[0m11:14:45.085929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FB7CFC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE4EE01C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE4E27F40>]}
[0m11:14:45.085929 [debug] [MainThread]: Flushing usage events
[0m11:15:45.514051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33553C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B339897F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B339897FA0>]}


============================== 11:15:45.514051 | a9d7e8e9-8469-4a96-81a7-b165c258ad3a ==============================
[0m11:15:45.514051 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:15:45.520389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_customer', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:15:46.569398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9d7e8e9-8469-4a96-81a7-b165c258ad3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B339897F40>]}
[0m11:15:46.579377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9d7e8e9-8469-4a96-81a7-b165c258ad3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B362405FA0>]}
[0m11:15:46.579377 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m11:15:46.599499 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m11:15:46.819168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:15:46.819168 [debug] [MainThread]: Partial parsing: added file: northwind://models\staging\stg_customer.yml
[0m11:15:46.819168 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_customer.sql
[0m11:15:46.844289 [debug] [MainThread]: Setting Default Schema: dev
[0m11:15:46.865592 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:15:46.869860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m11:15:46.879637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9d7e8e9-8469-4a96-81a7-b165c258ad3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B362851F70>]}
[0m11:15:46.894115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9d7e8e9-8469-4a96-81a7-b165c258ad3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B36256F730>]}
[0m11:15:46.899178 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m11:15:46.900669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9d7e8e9-8469-4a96-81a7-b165c258ad3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B36256F520>]}
[0m11:15:46.904285 [info ] [MainThread]: 
[0m11:15:46.904285 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:15:46.909703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m11:15:46.926570 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m11:15:46.926570 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m11:15:46.926570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:48.339247 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05eef-3200-f55a-0004-6e520001e0da
[0m11:15:48.339247 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:15:48.339247 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:15:48.339247 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:15:48.339247 [debug] [ThreadPool]: On list_DEV: Close
[0m11:15:48.434569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:48.439207 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m11:15:48.439279 [info ] [MainThread]: 
[0m11:15:48.440921 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m11:15:48.440921 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m11:15:48.444627 [debug] [MainThread]: Command `dbt run` failed at 11:15:48.444627 after 2.95 seconds
[0m11:15:48.444627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33553C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B36256F2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B36256F4F0>]}
[0m11:15:48.444627 [debug] [MainThread]: Flushing usage events
[0m11:18:28.225352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34951C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34D877FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34D877FD0>]}


============================== 11:18:28.226595 | c4fabbcd-1876-4ad5-a27b-423115062e35 ==============================
[0m11:18:28.226595 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:18:28.226595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_customer', 'send_anonymous_usage_stats': 'True'}
[0m11:18:29.266386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4fabbcd-1876-4ad5-a27b-423115062e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34D877F70>]}
[0m11:18:29.275419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4fabbcd-1876-4ad5-a27b-423115062e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3763E8FD0>]}
[0m11:18:29.280470 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m11:18:29.301900 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m11:18:29.325470 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:18:29.328988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4fabbcd-1876-4ad5-a27b-423115062e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3763FDDC0>]}
[0m11:18:30.595859 [debug] [MainThread]: Setting Default Schema: prod
[0m11:18:30.606135 [debug] [MainThread]: Setting Default Schema: prod
[0m11:18:30.606135 [debug] [MainThread]: Setting Default Schema: prod
[0m11:18:30.606135 [debug] [MainThread]: Setting Default Schema: prod
[0m11:18:30.616502 [debug] [MainThread]: Setting Default Schema: prod
[0m11:18:30.616502 [debug] [MainThread]: Setting Default Schema: prod
[0m11:18:30.616502 [debug] [MainThread]: Setting Default Schema: prod
[0m11:18:30.626580 [debug] [MainThread]: Setting Default Schema: prod
[0m11:18:30.630337 [debug] [MainThread]: Setting Default Schema: prod
[0m11:18:30.632742 [debug] [MainThread]: Setting Default Schema: prod
[0m11:18:30.635753 [debug] [MainThread]: Setting Default Schema: prod
[0m11:18:30.682590 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m11:18:30.695582 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:18:30.697413 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:18:30.704044 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m11:18:30.705674 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:18:30.708841 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:18:30.726107 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:18:30.731169 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:18:30.734867 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:18:30.738359 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:18:30.743108 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:18:30.745406 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:18:30.750898 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:18:30.754135 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:18:30.794620 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m11:18:30.801122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4fabbcd-1876-4ad5-a27b-423115062e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3768520D0>]}
[0m11:18:30.824651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4fabbcd-1876-4ad5-a27b-423115062e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3763FD160>]}
[0m11:18:30.825160 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m11:18:30.826241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4fabbcd-1876-4ad5-a27b-423115062e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B376471E50>]}
[0m11:18:30.827892 [info ] [MainThread]: 
[0m11:18:30.830722 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:18:30.835127 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m11:18:30.851920 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m11:18:30.852670 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m11:18:30.853181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:32.035839 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:18:32.035839 [debug] [ThreadPool]: On list_PROD: Close
[0m11:18:32.137820 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_CURATED'
[0m11:18:32.155636 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m11:18:32.155636 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m11:18:32.155636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:33.181885 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m11:18:33.181885 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m11:18:33.265977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_CURATED, now list_PROD_prod)
[0m11:18:33.325852 [debug] [ThreadPool]: Using snowflake connection "list_PROD_prod"
[0m11:18:33.325852 [debug] [ThreadPool]: On list_PROD_prod: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_prod"} */
show terse objects in PROD.prod limit 10000
[0m11:18:33.325852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:34.241789 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05ef2-3200-f55a-0004-6e520001e0de
[0m11:18:34.241789 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:18:34.245931 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:18:34.245931 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:18:34.245931 [debug] [ThreadPool]: On list_PROD_prod: Close
[0m11:18:34.337749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_prod, now list_PROD_STAGING)
[0m11:18:34.340783 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m11:18:34.345973 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m11:18:34.345973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:35.401407 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m11:18:35.401407 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m11:18:35.495932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4fabbcd-1876-4ad5-a27b-423115062e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B376BFAA90>]}
[0m11:18:35.495932 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:18:35.499376 [info ] [MainThread]: 
[0m11:18:35.505835 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m11:18:35.505835 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING.stg_customer .............................. [RUN]
[0m11:18:35.507846 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_customer'
[0m11:18:35.507846 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m11:18:35.518317 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m11:18:35.518317 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 11:18:35.507846 => 11:18:35.518317
[0m11:18:35.518317 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m11:18:35.552088 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m11:18:35.555595 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m11:18:35.555595 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer"} */
create or replace transient table PROD.STAGING.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m11:18:35.555595 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:18:37.712096 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:18:37.725522 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 11:18:35.518317 => 11:18:37.725522
[0m11:18:37.725522 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m11:18:37.821502 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4fabbcd-1876-4ad5-a27b-423115062e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B376358A00>]}
[0m11:18:37.825517 [info ] [Thread-1  ]: 1 of 1 OK created sql table model STAGING.stg_customer ......................... [[32mSUCCESS 1[0m in 2.31s]
[0m11:18:37.825517 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m11:18:37.825517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:37.825517 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m11:18:37.835929 [debug] [MainThread]: Connection 'list_PROD_STAGING' was properly closed.
[0m11:18:37.838990 [debug] [MainThread]: Connection 'model.northwind.stg_customer' was properly closed.
[0m11:18:37.838990 [info ] [MainThread]: 
[0m11:18:37.841714 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.01 seconds (7.01s).
[0m11:18:37.841714 [debug] [MainThread]: Command end result
[0m11:18:37.859780 [info ] [MainThread]: 
[0m11:18:37.859780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:37.859780 [info ] [MainThread]: 
[0m11:18:37.859780 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:18:37.865881 [debug] [MainThread]: Command `dbt run` succeeded at 11:18:37.865881 after 9.66 seconds
[0m11:18:37.865881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34951C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B376358A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34CE79EE0>]}
[0m11:18:37.865881 [debug] [MainThread]: Flushing usage events
[0m11:20:06.296307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164363AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001643A707F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001643A707FA0>]}


============================== 11:20:06.296307 | 740d6f57-c99a-4a7e-9aa1-4e5d0bb0da41 ==============================
[0m11:20:06.296307 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:20:06.296307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_customer', 'send_anonymous_usage_stats': 'True'}
[0m11:20:07.416604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '740d6f57-c99a-4a7e-9aa1-4e5d0bb0da41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001643A707F40>]}
[0m11:20:07.430412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '740d6f57-c99a-4a7e-9aa1-4e5d0bb0da41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016463278FA0>]}
[0m11:20:07.430412 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m11:20:07.461136 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m11:20:07.486251 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:20:07.486251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '740d6f57-c99a-4a7e-9aa1-4e5d0bb0da41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001646328B190>]}
[0m11:20:08.716790 [debug] [MainThread]: Setting Default Schema: dev
[0m11:20:08.726634 [debug] [MainThread]: Setting Default Schema: dev
[0m11:20:08.731746 [debug] [MainThread]: Setting Default Schema: dev
[0m11:20:08.736470 [debug] [MainThread]: Setting Default Schema: dev
[0m11:20:08.736470 [debug] [MainThread]: Setting Default Schema: dev
[0m11:20:08.743337 [debug] [MainThread]: Setting Default Schema: dev
[0m11:20:08.746547 [debug] [MainThread]: Setting Default Schema: dev
[0m11:20:08.746547 [debug] [MainThread]: Setting Default Schema: dev
[0m11:20:08.751654 [debug] [MainThread]: Setting Default Schema: dev
[0m11:20:08.756262 [debug] [MainThread]: Setting Default Schema: dev
[0m11:20:08.756262 [debug] [MainThread]: Setting Default Schema: dev
[0m11:20:08.806649 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m11:20:08.816617 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:20:08.816617 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:20:08.816617 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m11:20:08.826498 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:20:08.826498 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m11:20:08.843568 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:20:08.846818 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:20:08.851438 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:20:08.851438 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:20:08.856569 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:20:08.861697 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:20:08.862808 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:20:08.866524 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m11:20:08.901675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m11:20:08.910821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '740d6f57-c99a-4a7e-9aa1-4e5d0bb0da41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164636DF0D0>]}
[0m11:20:08.921592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '740d6f57-c99a-4a7e-9aa1-4e5d0bb0da41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001646328BDC0>]}
[0m11:20:08.921592 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m11:20:08.926731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '740d6f57-c99a-4a7e-9aa1-4e5d0bb0da41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164632789D0>]}
[0m11:20:08.927800 [info ] [MainThread]: 
[0m11:20:08.927800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:20:08.931461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m11:20:08.946700 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m11:20:08.946863 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m11:20:08.946863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:10.171452 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:20:10.176758 [debug] [ThreadPool]: On list_DEV: Close
[0m11:20:10.276328 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_dev'
[0m11:20:10.286564 [debug] [ThreadPool]: Using snowflake connection "list_DEV_dev"
[0m11:20:10.286564 [debug] [ThreadPool]: On list_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_dev"} */
show terse objects in DEV.dev limit 10000
[0m11:20:10.286564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:11.406860 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05ef4-3200-f583-0004-6e520001c166
[0m11:20:11.406860 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:20:11.406860 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:20:11.411373 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:20:11.411373 [debug] [ThreadPool]: On list_DEV_dev: Close
[0m11:20:11.526659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_dev, now list_DEV_STAGING)
[0m11:20:11.586753 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m11:20:11.586753 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m11:20:11.586753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:12.559520 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m11:20:12.566677 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m11:20:12.657638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_CURATED)
[0m11:20:12.657638 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m11:20:12.657638 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m11:20:12.657638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:13.636215 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m11:20:13.646564 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m11:20:13.736483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '740d6f57-c99a-4a7e-9aa1-4e5d0bb0da41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016463A89A30>]}
[0m11:20:13.736483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:20:13.746308 [info ] [MainThread]: 
[0m11:20:13.749350 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m11:20:13.749350 [info ] [Thread-1  ]: 1 of 1 START sql table model STAGING.stg_customer .............................. [RUN]
[0m11:20:13.753578 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_customer'
[0m11:20:13.753578 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m11:20:13.761243 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m11:20:13.761243 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 11:20:13.754584 => 11:20:13.761243
[0m11:20:13.761243 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m11:20:13.796241 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m11:20:13.796241 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m11:20:13.796241 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_customer"} */
create or replace transient table DEV.STAGING.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m11:20:13.796241 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:20:15.710205 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:20:15.731814 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 11:20:13.761243 => 11:20:15.731814
[0m11:20:15.731814 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m11:20:15.831962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740d6f57-c99a-4a7e-9aa1-4e5d0bb0da41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164635275B0>]}
[0m11:20:15.831962 [info ] [Thread-1  ]: 1 of 1 OK created sql table model STAGING.stg_customer ......................... [[32mSUCCESS 1[0m in 2.08s]
[0m11:20:15.831962 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m11:20:15.837903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:15.837903 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m11:20:15.842049 [debug] [MainThread]: Connection 'list_DEV_CURATED' was properly closed.
[0m11:20:15.842049 [debug] [MainThread]: Connection 'model.northwind.stg_customer' was properly closed.
[0m11:20:15.842049 [info ] [MainThread]: 
[0m11:20:15.842049 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.91 seconds (6.91s).
[0m11:20:15.846189 [debug] [MainThread]: Command end result
[0m11:20:15.857334 [info ] [MainThread]: 
[0m11:20:15.857334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:20:15.857334 [info ] [MainThread]: 
[0m11:20:15.857334 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:20:15.857334 [debug] [MainThread]: Command `dbt run` succeeded at 11:20:15.857334 after 9.59 seconds
[0m11:20:15.857334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164363AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164632B56A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016463AC5D90>]}
[0m11:20:15.857334 [debug] [MainThread]: Flushing usage events
[0m11:22:11.113024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024125B6D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024129EC8FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024129EC8F40>]}


============================== 11:22:11.116463 | 0be01556-2ffe-4adc-9fe1-2ffde46d9813 ==============================
[0m11:22:11.116463 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:22:11.118132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models staging.*', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:22:12.159445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024129EC8EE0>]}
[0m11:22:12.172286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024152A3AF40>]}
[0m11:22:12.172286 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m11:22:12.192188 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m11:22:12.382265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:12.382265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:12.382265 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m11:22:12.392493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024152CE19A0>]}
[0m11:22:12.407765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024152B9D760>]}
[0m11:22:12.407765 [info ] [MainThread]: Found 11 models, 4 tests, 14 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m11:22:12.409684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024152B9D550>]}
[0m11:22:12.411802 [info ] [MainThread]: 
[0m11:22:12.411802 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:22:12.411802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m11:22:12.427228 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m11:22:12.427228 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m11:22:12.427228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:13.664278 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:22:13.667289 [debug] [ThreadPool]: On list_DEV: Close
[0m11:22:13.747803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_CURATED'
[0m11:22:13.798043 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m11:22:13.798043 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m11:22:13.798043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:14.588074 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m11:22:14.588074 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m11:22:14.687778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_STAGING)
[0m11:22:14.691416 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m11:22:14.691416 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m11:22:14.691416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:22:15.458874 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:22:15.462485 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m11:22:15.562590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_dev)
[0m11:22:15.571045 [debug] [ThreadPool]: Using snowflake connection "list_DEV_dev"
[0m11:22:15.571045 [debug] [ThreadPool]: On list_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_dev"} */
show terse objects in DEV.dev limit 10000
[0m11:22:15.571045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:22:16.849282 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05ef6-3200-f589-0004-6e520001b182
[0m11:22:16.849282 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:22:16.849282 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:22:16.849282 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:22:16.849282 [debug] [ThreadPool]: On list_DEV_dev: Close
[0m11:22:16.937622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024152A4CC10>]}
[0m11:22:16.937622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:22:16.942637 [info ] [MainThread]: 
[0m11:22:16.947604 [debug] [Thread-1  ]: Began running node model.northwind.stg_category
[0m11:22:16.947604 [info ] [Thread-1  ]: 1 of 8 START sql table model STAGING.stg_category .............................. [RUN]
[0m11:22:16.955875 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_category'
[0m11:22:16.956868 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_category
[0m11:22:16.969421 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_category"
[0m11:22:16.971763 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (compile): 11:22:16.957925 => 11:22:16.970913
[0m11:22:16.972827 [debug] [Thread-1  ]: Began executing node model.northwind.stg_category
[0m11:22:17.002433 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_category"
[0m11:22:17.004512 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_category"
[0m11:22:17.005439 [debug] [Thread-1  ]: On model.northwind.stg_category: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_category"} */
create or replace transient table DEV.STAGING.stg_category
         as
        (
select category_id,
category_name,
description
from airbyte_database.airbyte_schema.categories
        );
[0m11:22:17.005439 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:22:19.517654 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m11:22:19.540964 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (execute): 11:22:16.973369 => 11:22:19.540964
[0m11:22:19.540964 [debug] [Thread-1  ]: On model.northwind.stg_category: Close
[0m11:22:19.627905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002415327BBE0>]}
[0m11:22:19.636219 [info ] [Thread-1  ]: 1 of 8 OK created sql table model STAGING.stg_category ......................... [[32mSUCCESS 1[0m in 2.67s]
[0m11:22:19.637857 [debug] [Thread-1  ]: Finished running node model.northwind.stg_category
[0m11:22:19.637857 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m11:22:19.641237 [info ] [Thread-1  ]: 2 of 8 START sql table model STAGING.stg_customer .............................. [RUN]
[0m11:22:19.641237 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_category, now model.northwind.stg_customer)
[0m11:22:19.641237 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m11:22:19.647863 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m11:22:19.647863 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 11:22:19.641237 => 11:22:19.647863
[0m11:22:19.647863 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m11:22:19.651871 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m11:22:19.651871 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m11:22:19.651871 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_customer"} */
create or replace transient table DEV.STAGING.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m11:22:19.651871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:22:21.563494 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:22:21.572769 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 11:22:19.647863 => 11:22:21.572769
[0m11:22:21.577458 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m11:22:21.667906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241530FC610>]}
[0m11:22:21.672527 [info ] [Thread-1  ]: 2 of 8 OK created sql table model STAGING.stg_customer ......................... [[32mSUCCESS 1[0m in 2.03s]
[0m11:22:21.674104 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m11:22:21.674104 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_customer_type
[0m11:22:21.677723 [info ] [Thread-1  ]: 3 of 8 START sql table model STAGING.stg_customer_customer_type ................ [RUN]
[0m11:22:21.677723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer, now model.northwind.stg_customer_customer_type)
[0m11:22:21.677723 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_customer_type
[0m11:22:21.683912 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_customer_type"
[0m11:22:21.686561 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (compile): 11:22:21.677723 => 11:22:21.686561
[0m11:22:21.690018 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_customer_type
[0m11:22:21.691549 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_customer_type"
[0m11:22:21.691549 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_customer_type"
[0m11:22:21.691549 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_customer_customer_type"} */
create or replace transient table DEV.STAGING.stg_customer_customer_type
         as
        (
select customer_id,
customer_type_id
from airbyte_database.airbyte_schema.customer_customer_type
        );
[0m11:22:21.691549 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:22:22.997643 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:22:22.997643 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (execute): 11:22:21.690018 => 11:22:22.997643
[0m11:22:22.997643 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: Close
[0m11:22:23.098416 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241532DCF40>]}
[0m11:22:23.098416 [info ] [Thread-1  ]: 3 of 8 OK created sql table model STAGING.stg_customer_customer_type ........... [[32mSUCCESS 1[0m in 1.42s]
[0m11:22:23.104434 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_customer_type
[0m11:22:23.104434 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_type
[0m11:22:23.107556 [info ] [Thread-1  ]: 4 of 8 START sql table model STAGING.stg_customer_type ......................... [RUN]
[0m11:22:23.107556 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_customer_type, now model.northwind.stg_customer_type)
[0m11:22:23.107556 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_type
[0m11:22:23.107556 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_type"
[0m11:22:23.107556 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (compile): 11:22:23.107556 => 11:22:23.107556
[0m11:22:23.107556 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_type
[0m11:22:23.117728 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_type"
[0m11:22:23.120302 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_type"
[0m11:22:23.120937 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_customer_type"} */
create or replace transient table DEV.STAGING.stg_customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m11:22:23.121444 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:22:24.737832 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:22:24.737832 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (execute): 11:22:23.107556 => 11:22:24.737832
[0m11:22:24.737832 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: Close
[0m11:22:24.832733 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024153310250>]}
[0m11:22:24.838060 [info ] [Thread-1  ]: 4 of 8 OK created sql table model STAGING.stg_customer_type .................... [[32mSUCCESS 1[0m in 1.73s]
[0m11:22:24.838060 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_type
[0m11:22:24.842697 [debug] [Thread-1  ]: Began running node model.northwind.stg_order
[0m11:22:24.843809 [info ] [Thread-1  ]: 5 of 8 START sql table model STAGING.stg_order ................................. [RUN]
[0m11:22:24.847412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_type, now model.northwind.stg_order)
[0m11:22:24.848163 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order
[0m11:22:24.852588 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order"
[0m11:22:24.852588 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (compile): 11:22:24.848163 => 11:22:24.852588
[0m11:22:24.852588 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order
[0m11:22:24.857858 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order"
[0m11:22:24.860239 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order"
[0m11:22:24.860239 [debug] [Thread-1  ]: On model.northwind.stg_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_order"} */
create or replace transient table DEV.STAGING.stg_order
         as
        (
select order_id,
customer_id,
ship_city,
ship_postal_code,
required_date,
freight,
ship_region,
order_date,
shipped_date,
ship_via,
ship_address,
ship_name,
ship_country
from airbyte_database.airbyte_schema.orders
where _ab_cdc_deleted_at is null
        );
[0m11:22:24.860239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:22:26.697440 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:22:26.702481 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (execute): 11:22:24.852588 => 11:22:26.702481
[0m11:22:26.702481 [debug] [Thread-1  ]: On model.northwind.stg_order: Close
[0m11:22:26.807813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241529BE6D0>]}
[0m11:22:26.807813 [info ] [Thread-1  ]: 5 of 8 OK created sql table model STAGING.stg_order ............................ [[32mSUCCESS 1[0m in 1.96s]
[0m11:22:26.807813 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order
[0m11:22:26.815778 [debug] [Thread-1  ]: Began running node model.northwind.stg_order_detail
[0m11:22:26.815778 [info ] [Thread-1  ]: 6 of 8 START sql table model STAGING.stg_order_detail .......................... [RUN]
[0m11:22:26.817833 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order, now model.northwind.stg_order_detail)
[0m11:22:26.819380 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order_detail
[0m11:22:26.820905 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order_detail"
[0m11:22:26.825052 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (compile): 11:22:26.819380 => 11:22:26.825052
[0m11:22:26.825052 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order_detail
[0m11:22:26.827562 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order_detail"
[0m11:22:26.831059 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order_detail"
[0m11:22:26.831059 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_order_detail"} */
create or replace transient table DEV.STAGING.stg_order_detail
         as
        (
select order_id,
product_id,
unit_price,
quantity,
discount
from airbyte_database.airbyte_schema.order_details
        );
[0m11:22:26.831059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:22:28.727700 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:22:28.733074 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (execute): 11:22:26.825052 => 11:22:28.733074
[0m11:22:28.733074 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: Close
[0m11:22:28.817474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024153346FD0>]}
[0m11:22:28.817474 [info ] [Thread-1  ]: 6 of 8 OK created sql table model STAGING.stg_order_detail ..................... [[32mSUCCESS 1[0m in 2.00s]
[0m11:22:28.822501 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order_detail
[0m11:22:28.825109 [debug] [Thread-1  ]: Began running node model.northwind.stg_product
[0m11:22:28.827623 [info ] [Thread-1  ]: 7 of 8 START sql table model STAGING.stg_product ............................... [RUN]
[0m11:22:28.827623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order_detail, now model.northwind.stg_product)
[0m11:22:28.830723 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_product
[0m11:22:28.832835 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_product"
[0m11:22:28.838677 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (compile): 11:22:28.832835 => 11:22:28.837469
[0m11:22:28.838677 [debug] [Thread-1  ]: Began executing node model.northwind.stg_product
[0m11:22:28.842688 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_product"
[0m11:22:28.845138 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_product"
[0m11:22:28.845138 [debug] [Thread-1  ]: On model.northwind.stg_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_product"} */
create or replace transient table DEV.STAGING.stg_product
         as
        (
select product_id,
product_name,
unit_price,
reorder_level,
discontinued,
category_id,
units_in_stock,
units_on_order,
quantity_per_unit,
supplier_id
from airbyte_database.airbyte_schema.products
        );
[0m11:22:28.845982 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:22:30.567436 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:22:30.579252 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (execute): 11:22:28.838677 => 11:22:30.579252
[0m11:22:30.579252 [debug] [Thread-1  ]: On model.northwind.stg_product: Close
[0m11:22:30.667943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241532BF100>]}
[0m11:22:30.672951 [info ] [Thread-1  ]: 7 of 8 OK created sql table model STAGING.stg_product .......................... [[32mSUCCESS 1[0m in 1.84s]
[0m11:22:30.675460 [debug] [Thread-1  ]: Finished running node model.northwind.stg_product
[0m11:22:30.675460 [debug] [Thread-1  ]: Began running node model.northwind.stg_supplier
[0m11:22:30.677991 [info ] [Thread-1  ]: 8 of 8 START sql table model STAGING.stg_supplier .............................. [RUN]
[0m11:22:30.677991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_product, now model.northwind.stg_supplier)
[0m11:22:30.677991 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_supplier
[0m11:22:30.683848 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_supplier"
[0m11:22:30.684692 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (compile): 11:22:30.677991 => 11:22:30.684692
[0m11:22:30.684692 [debug] [Thread-1  ]: Began executing node model.northwind.stg_supplier
[0m11:22:30.687375 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_supplier"
[0m11:22:30.690513 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_supplier"
[0m11:22:30.690513 [debug] [Thread-1  ]: On model.northwind.stg_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_supplier"} */
create or replace transient table DEV.STAGING.stg_supplier
         as
        (
select supplier_id,
country,
contact_name,
address,
city,
phone,
company_name,
fax,
region,
postal_code,
contact_title
from airbyte_database.airbyte_schema.suppliers
        );
[0m11:22:30.690513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:22:32.347392 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:22:32.355414 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (execute): 11:22:30.686367 => 11:22:32.355414
[0m11:22:32.355414 [debug] [Thread-1  ]: On model.northwind.stg_supplier: Close
[0m11:22:32.452416 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be01556-2ffe-4adc-9fe1-2ffde46d9813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024153359DF0>]}
[0m11:22:32.452416 [info ] [Thread-1  ]: 8 of 8 OK created sql table model STAGING.stg_supplier ......................... [[32mSUCCESS 1[0m in 1.77s]
[0m11:22:32.457427 [debug] [Thread-1  ]: Finished running node model.northwind.stg_supplier
[0m11:22:32.462491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:32.462491 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m11:22:32.462491 [debug] [MainThread]: Connection 'list_DEV_dev' was properly closed.
[0m11:22:32.462491 [debug] [MainThread]: Connection 'model.northwind.stg_supplier' was properly closed.
[0m11:22:32.465503 [info ] [MainThread]: 
[0m11:22:32.466992 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 20.05 seconds (20.05s).
[0m11:22:32.468823 [debug] [MainThread]: Command end result
[0m11:22:32.483077 [info ] [MainThread]: 
[0m11:22:32.483077 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:22:32.483077 [info ] [MainThread]: 
[0m11:22:32.487742 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:22:32.487742 [debug] [MainThread]: Command `dbt run` succeeded at 11:22:32.487742 after 21.40 seconds
[0m11:22:32.490265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024125B6D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002415304AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002415304AE80>]}
[0m11:22:32.490265 [debug] [MainThread]: Flushing usage events
[0m14:20:55.377449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F3350100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F76B7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F76B7F40>]}


============================== 14:20:55.385120 | 8062987c-2a0b-40f1-bcc0-ef745ad34854 ==============================
[0m14:20:55.385120 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:20:55.385120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:20:57.983061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8062987c-2a0b-40f1-bcc0-ef745ad34854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F76B7EE0>]}
[0m14:20:57.998695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8062987c-2a0b-40f1-bcc0-ef745ad34854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A0228F70>]}
[0m14:20:57.998695 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m14:20:58.052062 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:20:58.903361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 94 files changed.
[0m14:20:58.903361 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.sql
[0m14:20:58.903361 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.yml
[0m14:20:58.903361 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_customer_type.sql
[0m14:20:58.903361 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_supplier.yml
[0m14:20:58.916493 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_product.yml
[0m14:20:58.916493 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_week.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\relationships_where.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_null_proportion.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\sequential_values.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\fiscal_date\get_fiscal_periods.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\equality.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\log_info.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\pivot.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\nullcheck.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_product.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\equal_rowcount.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\now.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\unique_combination_of_columns.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_tables_by_pattern_sql.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_week.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\mutually_exclusive_ranges.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\at_least_one.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\cardinality_equality.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_single_value.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\modules_datetime.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\periods_since.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_start.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_week.sql
[0m14:20:58.919163 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\get_date_dimension.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\generate_series.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_parameter.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\get_base_dates.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_month.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\accepted_range.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_days_ago.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\tomorrow.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\date_spine.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\_is_ephemeral.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\date_part.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\slugify.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_host.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_start.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_end.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_relations_by_pattern.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\month_name.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\union.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_empty_string.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_of_year.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\safe_divide.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_weeks_ago.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_path.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\nullcheck_table.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_table_types_sql.sql
[0m14:20:58.934945 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_year.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\pretty_log_format.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month_name.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_months_ago.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\haversine_distance.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_relations_by_prefix.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_query_results_as_dict.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\_is_relation.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month_name.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_name.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\date_spine.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_accepted_values.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\generate_surrogate_key.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\expression_is_true.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month_number.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month_number.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\safe_add.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\fiscal_date\get_fiscal_year_dates.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\width_bucket.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_months_away.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\deduplicate.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_constant.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\surrogate_key.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_days_away.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\from_unixtimestamp.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\to_unixtimestamp.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\convert_timezone.sql
[0m14:20:58.950598 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_end.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\today.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_of_year.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_column_values.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\fewer_rows_than.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\pretty_time.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\unpivot.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_filtered_columns_in_relation.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\yesterday.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\recency.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\round_timestamp.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\groupby.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_weeks_away.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_tables_by_prefix_sql.sql
[0m14:20:58.966190 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\generate_series.sql
[0m14:20:59.343671 [debug] [MainThread]: Setting Default Schema: dev
[0m14:20:59.359312 [debug] [MainThread]: Setting Default Schema: dev
[0m14:20:59.374928 [debug] [MainThread]: Setting Default Schema: dev
[0m14:20:59.421962 [debug] [MainThread]: Setting Default Schema: dev
[0m14:20:59.437722 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m14:20:59.437722 [debug] [MainThread]: Command `dbt snapshot` failed at 14:20:59.437722 after 4.13 seconds
[0m14:20:59.437722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F3350100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A0460490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9A05786D0>]}
[0m14:20:59.437722 [debug] [MainThread]: Flushing usage events
[0m14:21:46.186521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266681AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002666C508FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002666C508EE0>]}


============================== 14:21:46.186521 | 946a8bf5-413e-4e9a-b0e4-69f34e260b76 ==============================
[0m14:21:46.186521 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:21:46.199528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:21:47.342056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '946a8bf5-413e-4e9a-b0e4-69f34e260b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002666C508FD0>]}
[0m14:21:47.342056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '946a8bf5-413e-4e9a-b0e4-69f34e260b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661509AF10>]}
[0m14:21:47.357742 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m14:21:47.374929 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:21:47.526996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 94 files changed.
[0m14:21:47.526996 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_customer_type.sql
[0m14:21:47.532508 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.sql
[0m14:21:47.532508 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.yml
[0m14:21:47.534015 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_supplier.yml
[0m14:21:47.534015 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_product.yml
[0m14:21:47.534694 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_constant.sql
[0m14:21:47.534694 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\get_date_dimension.sql
[0m14:21:47.534694 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_relations_by_pattern.sql
[0m14:21:47.536421 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\cardinality_equality.sql
[0m14:21:47.536421 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\date_spine.sql
[0m14:21:47.536421 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_filtered_columns_in_relation.sql
[0m14:21:47.537936 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\log_info.sql
[0m14:21:47.537936 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month_name.sql
[0m14:21:47.539387 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\from_unixtimestamp.sql
[0m14:21:47.539387 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_accepted_values.sql
[0m14:21:47.539387 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_single_value.sql
[0m14:21:47.539387 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\equal_rowcount.sql
[0m14:21:47.539387 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\fewer_rows_than.sql
[0m14:21:47.542394 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_null_proportion.sql
[0m14:21:47.542610 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_month.sql
[0m14:21:47.542610 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\equality.sql
[0m14:21:47.545103 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\convert_timezone.sql
[0m14:21:47.545103 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_empty_string.sql
[0m14:21:47.545103 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_end.sql
[0m14:21:47.545103 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_query_results_as_dict.sql
[0m14:21:47.545103 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\today.sql
[0m14:21:47.547801 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\deduplicate.sql
[0m14:21:47.547801 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month.sql
[0m14:21:47.548841 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\date_spine.sql
[0m14:21:47.549863 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\get_base_dates.sql
[0m14:21:47.549863 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\groupby.sql
[0m14:21:47.551348 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_tables_by_prefix_sql.sql
[0m14:21:47.551348 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\accepted_range.sql
[0m14:21:47.551348 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_parameter.sql
[0m14:21:47.551348 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\pivot.sql
[0m14:21:47.551348 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_weeks_ago.sql
[0m14:21:47.551348 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month.sql
[0m14:21:47.554481 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_product.sql
[0m14:21:47.554481 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\nullcheck_table.sql
[0m14:21:47.554481 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\pretty_log_format.sql
[0m14:21:47.555852 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\safe_divide.sql
[0m14:21:47.555852 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_week.sql
[0m14:21:47.557059 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_end.sql
[0m14:21:47.557059 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\modules_datetime.sql
[0m14:21:47.557059 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_tables_by_pattern_sql.sql
[0m14:21:47.558499 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\nullcheck.sql
[0m14:21:47.558499 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\relationships_where.sql
[0m14:21:47.558499 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\tomorrow.sql
[0m14:21:47.558499 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\unpivot.sql
[0m14:21:47.558499 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\_is_ephemeral.sql
[0m14:21:47.561686 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month_name.sql
[0m14:21:47.561686 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\safe_add.sql
[0m14:21:47.561686 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\fiscal_date\get_fiscal_periods.sql
[0m14:21:47.563273 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\generate_surrogate_key.sql
[0m14:21:47.563273 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\to_unixtimestamp.sql
[0m14:21:47.564450 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\_is_relation.sql
[0m14:21:47.564450 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\slugify.sql
[0m14:21:47.565644 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\date_part.sql
[0m14:21:47.565644 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_months_ago.sql
[0m14:21:47.566814 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_weeks_away.sql
[0m14:21:47.566814 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_months_away.sql
[0m14:21:47.566814 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\surrogate_key.sql
[0m14:21:47.568214 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_days_away.sql
[0m14:21:47.568214 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\width_bucket.sql
[0m14:21:47.568214 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_of_year.sql
[0m14:21:47.569618 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\round_timestamp.sql
[0m14:21:47.569618 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_table_types_sql.sql
[0m14:21:47.569618 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_start.sql
[0m14:21:47.570955 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_path.sql
[0m14:21:47.570955 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_days_ago.sql
[0m14:21:47.570955 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\now.sql
[0m14:21:47.572517 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\month_name.sql
[0m14:21:47.572517 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\union.sql
[0m14:21:47.573626 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\mutually_exclusive_ranges.sql
[0m14:21:47.573626 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_week.sql
[0m14:21:47.574719 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\expression_is_true.sql
[0m14:21:47.574719 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month_number.sql
[0m14:21:47.574719 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\fiscal_date\get_fiscal_year_dates.sql
[0m14:21:47.576227 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_of_year.sql
[0m14:21:47.576227 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\periods_since.sql
[0m14:21:47.576227 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\yesterday.sql
[0m14:21:47.577793 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month_number.sql
[0m14:21:47.577793 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\haversine_distance.sql
[0m14:21:47.577793 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\pretty_time.sql
[0m14:21:47.579144 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\at_least_one.sql
[0m14:21:47.579144 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\generate_series.sql
[0m14:21:47.580372 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_start.sql
[0m14:21:47.580372 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\sequential_values.sql
[0m14:21:47.581846 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_name.sql
[0m14:21:47.581846 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_relations_by_prefix.sql
[0m14:21:47.581846 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_week.sql
[0m14:21:47.581846 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\generate_series.sql
[0m14:21:47.581846 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_year.sql
[0m14:21:47.581846 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\unique_combination_of_columns.sql
[0m14:21:47.581846 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_column_values.sql
[0m14:21:47.585486 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_host.sql
[0m14:21:47.585486 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\recency.sql
[0m14:21:47.954222 [debug] [MainThread]: Setting Default Schema: dev
[0m14:21:47.969325 [debug] [MainThread]: Setting Default Schema: dev
[0m14:21:47.969325 [debug] [MainThread]: Setting Default Schema: dev
[0m14:21:48.033716 [debug] [MainThread]: Setting Default Schema: dev
[0m14:21:48.052764 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snp_customer_customer_type (snapshots\snp_customer_customer_type.sql)
  expected token ',', got 'strategy'
    line 6
      strategy='check',
[0m14:21:48.052764 [debug] [MainThread]: Command `dbt snapshot` failed at 14:21:48.052764 after 1.88 seconds
[0m14:21:48.052764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266681AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266152A3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266153DFDF0>]}
[0m14:21:48.052764 [debug] [MainThread]: Flushing usage events
[0m14:22:04.812763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA46DD6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA8A38FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA8A38EE0>]}


============================== 14:22:04.812763 | a898ef76-8627-400d-b576-8881e4124a0d ==============================
[0m14:22:04.812763 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:22:04.812763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:05.889379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a898ef76-8627-400d-b576-8881e4124a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA8A38FD0>]}
[0m14:22:05.889379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a898ef76-8627-400d-b576-8881e4124a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCD15A1BB0>]}
[0m14:22:05.905114 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m14:22:05.925708 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 94 files changed.
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.sql
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.yml
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_customer_type.sql
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_product.yml
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_supplier.yml
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_weeks_away.sql
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month_name.sql
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\slugify.sql
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_constant.sql
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_table_types_sql.sql
[0m14:22:06.103435 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\mutually_exclusive_ranges.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\now.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_host.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\date_spine.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_of_year.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_single_value.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\periods_since.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\equal_rowcount.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\date_spine.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month_number.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\relationships_where.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\safe_divide.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_path.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\fiscal_date\get_fiscal_year_dates.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_start.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\date_part.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\today.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\surrogate_key.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_product.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_end.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\generate_surrogate_key.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\pivot.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\width_bucket.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_days_ago.sql
[0m14:22:06.119062 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_months_away.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\expression_is_true.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month_name.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\round_timestamp.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\unique_combination_of_columns.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_null_proportion.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\convert_timezone.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\tomorrow.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\generate_series.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\month_name.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\accepted_range.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month_number.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_tables_by_pattern_sql.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_start.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\_is_ephemeral.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\at_least_one.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_relations_by_prefix.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\nullcheck_table.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_tables_by_prefix_sql.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_empty_string.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\nullcheck.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\groupby.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_year.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\get_date_dimension.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\unpivot.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\pretty_log_format.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_query_results_as_dict.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_week.sql
[0m14:22:06.134688 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_end.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\generate_series.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\pretty_time.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_parameter.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\from_unixtimestamp.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_accepted_values.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_filtered_columns_in_relation.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\safe_add.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\sequential_values.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_months_ago.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_of_year.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\fiscal_date\get_fiscal_periods.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_column_values.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_name.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_relations_by_pattern.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\get_base_dates.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\equality.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\recency.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\haversine_distance.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_week.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\log_info.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\modules_datetime.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_weeks_ago.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\union.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\cardinality_equality.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\deduplicate.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\_is_relation.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\to_unixtimestamp.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_week.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_days_away.sql
[0m14:22:06.150344 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_month.sql
[0m14:22:06.165935 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\yesterday.sql
[0m14:22:06.165935 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\fewer_rows_than.sql
[0m14:22:06.544317 [debug] [MainThread]: Setting Default Schema: dev
[0m14:22:06.565434 [debug] [MainThread]: Setting Default Schema: dev
[0m14:22:06.573583 [debug] [MainThread]: Setting Default Schema: dev
[0m14:22:06.613471 [debug] [MainThread]: Setting Default Schema: dev
[0m14:22:06.644941 [debug] [MainThread]: Setting Default Schema: dev
[0m14:22:06.660669 [warn ] [MainThread]: [[33mWARNING[0m]: 'snp_customer_customer_type' is a snapshot node, but it is specified in the
models section of snapshots\snp_customer_customer_type.yml. To fix this error,
place the `snp_customer_customer_type` specification under the snapshots key
instead.
[0m14:22:06.660669 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:22:06.678458 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:06.681340 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:06.701313 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:22:06.707880 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:06.711552 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:06.716116 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:22:06.718865 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:06.721051 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:06.721051 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.northwind.snp_customer_customer_type' (snapshots\snp_customer_customer_type.sql) depends on a source named 'staging.customer_customer_type' which was not found
[0m14:22:06.723896 [debug] [MainThread]: Command `dbt snapshot` failed at 14:22:06.723896 after 1.93 seconds
[0m14:22:06.723896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA46DD6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCD18E08B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCD1868F10>]}
[0m14:22:06.723896 [debug] [MainThread]: Flushing usage events
[0m14:22:54.185004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BE0600100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BE4967FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BE4967F40>]}


============================== 14:22:54.185004 | 2f56b7c7-9b05-4cc6-a5ca-ae642cd0f198 ==============================
[0m14:22:54.185004 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:22:54.185004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:55.245820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f56b7c7-9b05-4cc6-a5ca-ae642cd0f198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BE4967EE0>]}
[0m14:22:55.245820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f56b7c7-9b05-4cc6-a5ca-ae642cd0f198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B8D4D8F70>]}
[0m14:22:55.261497 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m14:22:55.278460 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 94 files changed.
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_customer_type.sql
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.sql
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.yml
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_supplier.yml
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_product.yml
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\recency.sql
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\at_least_one.sql
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\slugify.sql
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_tables_by_pattern_sql.sql
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\union.sql
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month_number.sql
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_of_year.sql
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_tables_by_prefix_sql.sql
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_start.sql
[0m14:22:55.463912 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\nullcheck.sql
[0m14:22:55.480046 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\date_spine.sql
[0m14:22:55.480492 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\pretty_log_format.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\month_name.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\yesterday.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month_name.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_week.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_days_ago.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\generate_series.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_week.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\_utils\modules_datetime.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\expression_is_true.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month_name.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\get_base_dates.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\pretty_time.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_name.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\_is_relation.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_relations_by_prefix.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\fewer_rows_than.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_filtered_columns_in_relation.sql
[0m14:22:55.480998 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\now.sql
[0m14:22:55.491568 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_empty_string.sql
[0m14:22:55.491568 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\relationships_where.sql
[0m14:22:55.491568 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\get_date_dimension.sql
[0m14:22:55.491568 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_of_year.sql
[0m14:22:55.491568 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\equality.sql
[0m14:22:55.491568 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_column_values.sql
[0m14:22:55.491568 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\surrogate_key.sql
[0m14:22:55.491568 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_start.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_month.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_relations_by_pattern.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\accepted_range.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\sequential_values.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\periods_since.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\to_unixtimestamp.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\cardinality_equality.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_week.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\width_bucket.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\date_part.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\round_timestamp.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\week_end.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\pivot.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\iso_week_end.sql
[0m14:22:55.496122 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\_is_ephemeral.sql
[0m14:22:55.504166 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_days_away.sql
[0m14:22:55.504166 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\last_month.sql
[0m14:22:55.504166 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\mutually_exclusive_ranges.sql
[0m14:22:55.504166 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_weeks_away.sql
[0m14:22:55.504166 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\deduplicate.sql
[0m14:22:55.506382 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_host.sql
[0m14:22:55.506382 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\tomorrow.sql
[0m14:22:55.506382 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_single_value.sql
[0m14:22:55.506382 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_constant.sql
[0m14:22:55.506382 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_months_ago.sql
[0m14:22:55.506382 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\generate_surrogate_key.sql
[0m14:22:55.506382 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\fiscal_date\get_fiscal_year_dates.sql
[0m14:22:55.506382 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\fiscal_date\get_fiscal_periods.sql
[0m14:22:55.510888 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\jinja_helpers\log_info.sql
[0m14:22:55.510888 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\safe_divide.sql
[0m14:22:55.510888 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\nullcheck_table.sql
[0m14:22:55.510888 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\haversine_distance.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_weeks_ago.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\safe_add.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\date_spine.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\unpivot.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\groupby.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_path.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_product.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_accepted_values.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\convert_timezone.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\today.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\not_null_proportion.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\n_months_away.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\unique_combination_of_columns.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\day_of_year.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_query_results_as_dict.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\generate_series.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\sql\get_table_types_sql.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\next_month_number.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\web\get_url_parameter.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros\generic_tests\equal_rowcount.sql
[0m14:22:55.512913 [debug] [MainThread]: Partial parsing: updated file: dbt_date://macros\calendar_date\from_unixtimestamp.sql
[0m14:22:55.899052 [debug] [MainThread]: Setting Default Schema: dev
[0m14:22:55.921677 [debug] [MainThread]: Setting Default Schema: dev
[0m14:22:55.970041 [debug] [MainThread]: Setting Default Schema: dev
[0m14:22:55.985767 [debug] [MainThread]: Setting Default Schema: dev
[0m14:22:56.002853 [debug] [MainThread]: Setting Default Schema: dev
[0m14:22:56.021301 [warn ] [MainThread]: [[33mWARNING[0m]: 'snp_customer_customer_type' is a snapshot node, but it is specified in the
models section of snapshots\snp_customer_customer_type.yml. To fix this error,
place the `snp_customer_customer_type` specification under the snapshots key
instead.
[0m14:22:56.029759 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:22:56.029759 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:56.048773 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:56.048773 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:22:56.048773 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:56.048773 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:56.065014 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:22:56.065014 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:56.065014 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:22:56.065014 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.northwind.snp_customer_customer_type' (snapshots\snp_customer_customer_type.sql) depends on a source named 'staging.stg_customer_customer_type' which was not found
[0m14:22:56.065014 [debug] [MainThread]: Command `dbt snapshot` failed at 14:22:56.065014 after 1.91 seconds
[0m14:22:56.065014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BE0600100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B8D7F44C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B8D7F4070>]}
[0m14:22:56.065014 [debug] [MainThread]: Flushing usage events
[0m14:29:03.321796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7480BC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74C417FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74C417FA0>]}


============================== 14:29:03.321796 | abdc5c4e-b0be-4ef5-b7b9-b89a62d0c576 ==============================
[0m14:29:03.321796 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:29:03.321796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models staging.*', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:29:04.473826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abdc5c4e-b0be-4ef5-b7b9-b89a62d0c576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74C417F40>]}
[0m14:29:04.489433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abdc5c4e-b0be-4ef5-b7b9-b89a62d0c576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F774F86FA0>]}
[0m14:29:04.489433 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m14:29:04.514202 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:29:04.531184 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:29:04.531184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'abdc5c4e-b0be-4ef5-b7b9-b89a62d0c576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F774F9B820>]}
[0m14:29:05.762338 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.777953 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.777953 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.777953 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.793573 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.793573 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.801210 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.801210 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.801210 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.809321 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.809321 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.809321 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.825059 [debug] [MainThread]: Setting Default Schema: prod
[0m14:29:05.872242 [warn ] [MainThread]: [[33mWARNING[0m]: 'snp_customer_customer_type' is a snapshot node, but it is specified in the
models section of snapshots\snp_customer_customer_type.yml. To fix this error,
place the `snp_customer_customer_type` specification under the snapshots key
instead.
[0m14:29:05.887976 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:29:05.901581 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:29:05.905945 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:29:05.907837 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:29:05.907837 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:29:05.920175 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:29:05.920175 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:29:05.920175 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:29:05.920175 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:29:05.936752 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:29:05.951375 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:29:05.953607 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:29:05.953607 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:29:05.953607 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:29:05.953607 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:29:05.965722 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:29:05.967929 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:29:05.974043 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.northwind.snp_customer_customer_type' (snapshots\snp_customer_customer_type.sql) depends on a source named 'staging.stg_customer_customer_type' which was not found
[0m14:29:05.974043 [debug] [MainThread]: Command `dbt run` failed at 14:29:05.974043 after 2.68 seconds
[0m14:29:05.974043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7480BC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F77535CD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F77535C3A0>]}
[0m14:29:05.974043 [debug] [MainThread]: Flushing usage events
[0m14:34:22.068922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016229770100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622DAD7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622DB0E340>]}


============================== 14:34:22.068922 | cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b ==============================
[0m14:34:22.068922 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:34:22.068922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models staging.*', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:34:23.303393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622DAD7FA0>]}
[0m14:34:23.318474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016256642DC0>]}
[0m14:34:23.318986 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m14:34:23.339599 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:34:23.351946 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:34:23.351946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001625665ABE0>]}
[0m14:34:24.527129 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.533276 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.542572 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.542572 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.558780 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.558780 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.558780 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.558780 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.558780 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.575025 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.575025 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.575025 [debug] [MainThread]: Setting Default Schema: prod
[0m14:34:24.620665 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:34:24.637295 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:34:24.637295 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:34:24.637295 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:34:24.652999 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:34:24.654274 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:34:24.660815 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:34:24.660815 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:34:24.660815 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:34:24.685043 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:34:24.685043 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:34:24.691244 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:34:24.691244 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:34:24.691244 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:34:24.700701 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:34:24.700701 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:34:24.704795 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:34:24.750611 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m14:34:24.750611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016256AC70D0>]}
[0m14:34:24.779281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001625665AEE0>]}
[0m14:34:24.779281 [info ] [MainThread]: Found 12 models, 6 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m14:34:24.780338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016256856280>]}
[0m14:34:24.783049 [info ] [MainThread]: 
[0m14:34:24.784739 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:24.784739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m14:34:24.799680 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m14:34:24.799680 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m14:34:24.801733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:26.323686 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m14:34:26.343377 [debug] [ThreadPool]: On list_PROD: Close
[0m14:34:26.433720 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_prod'
[0m14:34:26.511896 [debug] [ThreadPool]: Using snowflake connection "list_PROD_prod"
[0m14:34:26.511896 [debug] [ThreadPool]: On list_PROD_prod: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_prod"} */
show terse objects in PROD.prod limit 10000
[0m14:34:26.511896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:27.684789 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05fb6-3200-f55a-0004-6e520001e1c6
[0m14:34:27.684789 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:34:27.684789 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:34:27.684789 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:34:27.700504 [debug] [ThreadPool]: On list_PROD_prod: Close
[0m14:34:27.779887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_prod, now list_PROD_STAGING)
[0m14:34:27.779887 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m14:34:27.779887 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m14:34:27.779887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:28.566224 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:28.566224 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m14:34:28.666850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_CURATED)
[0m14:34:28.668422 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m14:34:28.668422 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m14:34:28.668422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:29.684430 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:34:29.684430 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m14:34:29.784964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016256AD5C10>]}
[0m14:34:29.793540 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:34:29.793540 [info ] [MainThread]: 
[0m14:34:29.807285 [debug] [Thread-1  ]: Began running node model.northwind.stg_category
[0m14:34:29.809302 [info ] [Thread-1  ]: 1 of 8 START sql table model STAGING.stg_category .............................. [RUN]
[0m14:34:29.810853 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_category'
[0m14:34:29.810853 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_category
[0m14:34:29.820980 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_category"
[0m14:34:29.822797 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (compile): 14:34:29.810853 => 14:34:29.822797
[0m14:34:29.822797 [debug] [Thread-1  ]: Began executing node model.northwind.stg_category
[0m14:34:29.851541 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_category"
[0m14:34:29.851541 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_category"
[0m14:34:29.851541 [debug] [Thread-1  ]: On model.northwind.stg_category: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_category"} */
create or replace transient table PROD.STAGING.stg_category
         as
        (
select category_id,
category_name,
description
from airbyte_database.airbyte_schema.categories
        );
[0m14:34:29.851541 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:34:32.081103 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:34:32.121302 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (execute): 14:34:29.822797 => 14:34:32.121302
[0m14:34:32.121302 [debug] [Thread-1  ]: On model.northwind.stg_category: Close
[0m14:34:32.208683 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016256ADAF40>]}
[0m14:34:32.208683 [info ] [Thread-1  ]: 1 of 8 OK created sql table model STAGING.stg_category ......................... [[32mSUCCESS 1[0m in 2.40s]
[0m14:34:32.208683 [debug] [Thread-1  ]: Finished running node model.northwind.stg_category
[0m14:34:32.221697 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m14:34:32.223714 [info ] [Thread-1  ]: 2 of 8 START sql table model STAGING.stg_customer .............................. [RUN]
[0m14:34:32.225993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_category, now model.northwind.stg_customer)
[0m14:34:32.226854 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m14:34:32.233526 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m14:34:32.233526 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 14:34:32.228802 => 14:34:32.233526
[0m14:34:32.233526 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m14:34:32.233526 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m14:34:32.239532 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m14:34:32.239532 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer"} */
create or replace transient table PROD.STAGING.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m14:34:32.239532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:34:34.198095 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:34:34.206249 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 14:34:32.233526 => 14:34:34.206249
[0m14:34:34.206249 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m14:34:34.312146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016256642250>]}
[0m14:34:34.312146 [info ] [Thread-1  ]: 2 of 8 OK created sql table model STAGING.stg_customer ......................... [[32mSUCCESS 1[0m in 2.08s]
[0m14:34:34.312146 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m14:34:34.312146 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_customer_type
[0m14:34:34.312146 [info ] [Thread-1  ]: 3 of 8 START sql table model STAGING.stg_customer_customer_type ................ [RUN]
[0m14:34:34.312146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer, now model.northwind.stg_customer_customer_type)
[0m14:34:34.323815 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_customer_type
[0m14:34:34.327288 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_customer_type"
[0m14:34:34.331632 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (compile): 14:34:34.323815 => 14:34:34.331632
[0m14:34:34.332983 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_customer_type
[0m14:34:34.335738 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_customer_type"
[0m14:34:34.335738 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_customer_type"
[0m14:34:34.335738 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_customer_type
         as
        (
select customer_id,
customer_type_id
from airbyte_database.airbyte_schema.customer_customer_type
        );
[0m14:34:34.335738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:34:36.144955 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:34:36.144955 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (execute): 14:34:34.332983 => 14:34:36.144955
[0m14:34:36.144955 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: Close
[0m14:34:36.239150 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016256642760>]}
[0m14:34:36.239150 [info ] [Thread-1  ]: 3 of 8 OK created sql table model STAGING.stg_customer_customer_type ........... [[32mSUCCESS 1[0m in 1.93s]
[0m14:34:36.239150 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_customer_type
[0m14:34:36.254903 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_type
[0m14:34:36.254903 [info ] [Thread-1  ]: 4 of 8 START sql table model STAGING.stg_customer_type ......................... [RUN]
[0m14:34:36.254903 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_customer_type, now model.northwind.stg_customer_type)
[0m14:34:36.261204 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_type
[0m14:34:36.265915 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_type"
[0m14:34:36.265915 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (compile): 14:34:36.263320 => 14:34:36.265915
[0m14:34:36.265915 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_type
[0m14:34:36.265915 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_type"
[0m14:34:36.265915 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_type"
[0m14:34:36.265915 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m14:34:36.265915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:34:37.989087 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:34:37.989087 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (execute): 14:34:36.265915 => 14:34:37.989087
[0m14:34:37.989087 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: Close
[0m14:34:38.082825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162568F4A00>]}
[0m14:34:38.082825 [info ] [Thread-1  ]: 4 of 8 OK created sql table model STAGING.stg_customer_type .................... [[32mSUCCESS 1[0m in 1.83s]
[0m14:34:38.082825 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_type
[0m14:34:38.082825 [debug] [Thread-1  ]: Began running node model.northwind.stg_order
[0m14:34:38.082825 [info ] [Thread-1  ]: 5 of 8 START sql table model STAGING.stg_order ................................. [RUN]
[0m14:34:38.082825 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_type, now model.northwind.stg_order)
[0m14:34:38.082825 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order
[0m14:34:38.082825 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order"
[0m14:34:38.082825 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (compile): 14:34:38.082825 => 14:34:38.082825
[0m14:34:38.082825 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order
[0m14:34:38.101545 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order"
[0m14:34:38.101545 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order"
[0m14:34:38.101545 [debug] [Thread-1  ]: On model.northwind.stg_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order"} */
create or replace transient table PROD.STAGING.stg_order
         as
        (
select order_id,
customer_id,
ship_city,
ship_postal_code,
required_date,
freight,
ship_region,
order_date,
shipped_date,
ship_via,
ship_address,
ship_name,
ship_country
from airbyte_database.airbyte_schema.orders
where _ab_cdc_deleted_at is null
        );
[0m14:34:38.101545 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:34:39.527542 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:39.527542 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (execute): 14:34:38.098756 => 14:34:39.527542
[0m14:34:39.527542 [debug] [Thread-1  ]: On model.northwind.stg_order: Close
[0m14:34:39.620309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016256911A60>]}
[0m14:34:39.620309 [info ] [Thread-1  ]: 5 of 8 OK created sql table model STAGING.stg_order ............................ [[32mSUCCESS 1[0m in 1.54s]
[0m14:34:39.620309 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order
[0m14:34:39.620309 [debug] [Thread-1  ]: Began running node model.northwind.stg_order_detail
[0m14:34:39.628491 [info ] [Thread-1  ]: 6 of 8 START sql table model STAGING.stg_order_detail .......................... [RUN]
[0m14:34:39.633209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order, now model.northwind.stg_order_detail)
[0m14:34:39.633886 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order_detail
[0m14:34:39.636719 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order_detail"
[0m14:34:39.641233 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (compile): 14:34:39.633886 => 14:34:39.640226
[0m14:34:39.641706 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order_detail
[0m14:34:39.645711 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order_detail"
[0m14:34:39.645711 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order_detail"
[0m14:34:39.645711 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order_detail"} */
create or replace transient table PROD.STAGING.stg_order_detail
         as
        (
select order_id,
product_id,
unit_price,
quantity,
discount
from airbyte_database.airbyte_schema.order_details
        );
[0m14:34:39.645711 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:34:42.073984 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:34:42.089464 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (execute): 14:34:39.641706 => 14:34:42.089464
[0m14:34:42.089464 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: Close
[0m14:34:42.200575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162568E00A0>]}
[0m14:34:42.200575 [info ] [Thread-1  ]: 6 of 8 OK created sql table model STAGING.stg_order_detail ..................... [[32mSUCCESS 1[0m in 2.57s]
[0m14:34:42.200575 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order_detail
[0m14:34:42.200575 [debug] [Thread-1  ]: Began running node model.northwind.stg_product
[0m14:34:42.200575 [info ] [Thread-1  ]: 7 of 8 START sql table model STAGING.stg_product ............................... [RUN]
[0m14:34:42.200575 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order_detail, now model.northwind.stg_product)
[0m14:34:42.200575 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_product
[0m14:34:42.221393 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_product"
[0m14:34:42.222795 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (compile): 14:34:42.200575 => 14:34:42.222795
[0m14:34:42.222795 [debug] [Thread-1  ]: Began executing node model.northwind.stg_product
[0m14:34:42.222795 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_product"
[0m14:34:42.229935 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_product"
[0m14:34:42.229935 [debug] [Thread-1  ]: On model.northwind.stg_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_product"} */
create or replace transient table PROD.STAGING.stg_product
         as
        (
select product_id,
product_name,
unit_price,
reorder_level,
discontinued,
category_id,
units_in_stock,
units_on_order,
quantity_per_unit,
supplier_id
from airbyte_database.airbyte_schema.products
        );
[0m14:34:42.230997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:34:43.916794 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:34:43.932241 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (execute): 14:34:42.222795 => 14:34:43.932241
[0m14:34:43.932241 [debug] [Thread-1  ]: On model.northwind.stg_product: Close
[0m14:34:44.029630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016256917370>]}
[0m14:34:44.036646 [info ] [Thread-1  ]: 7 of 8 OK created sql table model STAGING.stg_product .......................... [[32mSUCCESS 1[0m in 1.83s]
[0m14:34:44.036646 [debug] [Thread-1  ]: Finished running node model.northwind.stg_product
[0m14:34:44.036646 [debug] [Thread-1  ]: Began running node model.northwind.stg_supplier
[0m14:34:44.036646 [info ] [Thread-1  ]: 8 of 8 START sql table model STAGING.stg_supplier .............................. [RUN]
[0m14:34:44.044757 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_product, now model.northwind.stg_supplier)
[0m14:34:44.044757 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_supplier
[0m14:34:44.044757 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_supplier"
[0m14:34:44.044757 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (compile): 14:34:44.044757 => 14:34:44.044757
[0m14:34:44.051861 [debug] [Thread-1  ]: Began executing node model.northwind.stg_supplier
[0m14:34:44.053227 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_supplier"
[0m14:34:44.053227 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_supplier"
[0m14:34:44.053227 [debug] [Thread-1  ]: On model.northwind.stg_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_supplier"} */
create or replace transient table PROD.STAGING.stg_supplier
         as
        (
select supplier_id,
country,
contact_name,
address,
city,
phone,
company_name,
fax,
region,
postal_code,
contact_title
from airbyte_database.airbyte_schema.suppliers
        );
[0m14:34:44.053227 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:34:45.661262 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:34:45.676889 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (execute): 14:34:44.052123 => 14:34:45.676889
[0m14:34:45.676889 [debug] [Thread-1  ]: On model.northwind.stg_supplier: Close
[0m14:34:45.771072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbefd2c-bc2d-4a25-a2fd-b8198cb53c6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016256EF6D60>]}
[0m14:34:45.771072 [info ] [Thread-1  ]: 8 of 8 OK created sql table model STAGING.stg_supplier ......................... [[32mSUCCESS 1[0m in 1.73s]
[0m14:34:45.771072 [debug] [Thread-1  ]: Finished running node model.northwind.stg_supplier
[0m14:34:45.786817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:45.789128 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m14:34:45.789128 [debug] [MainThread]: Connection 'list_PROD_CURATED' was properly closed.
[0m14:34:45.789128 [debug] [MainThread]: Connection 'model.northwind.stg_supplier' was properly closed.
[0m14:34:45.791925 [info ] [MainThread]: 
[0m14:34:45.794851 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 21.01 seconds (21.01s).
[0m14:34:45.799226 [debug] [MainThread]: Command end result
[0m14:34:45.812099 [info ] [MainThread]: 
[0m14:34:45.812099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:45.812099 [info ] [MainThread]: 
[0m14:34:45.812099 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:34:45.812099 [debug] [MainThread]: Command `dbt run` succeeded at 14:34:45.812099 after 23.77 seconds
[0m14:34:45.812099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016229770100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001625665B6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016256610490>]}
[0m14:34:45.812099 [debug] [MainThread]: Flushing usage events
[0m14:35:16.054759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B89FA8C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8A3DF7FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8A3DF7F70>]}


============================== 14:35:16.054759 | 2b9dcb5d-1c02-4534-83b5-906b20c2498d ==============================
[0m14:35:16.054759 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:35:16.054759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:35:17.273266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b9dcb5d-1c02-4534-83b5-906b20c2498d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8A3DF7F10>]}
[0m14:35:17.288885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b9dcb5d-1c02-4534-83b5-906b20c2498d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CC969FA0>]}
[0m14:35:17.288885 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m14:35:17.322463 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:35:17.384429 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:35:17.386453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b9dcb5d-1c02-4534-83b5-906b20c2498d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CC97AEE0>]}
[0m14:35:18.584981 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.600609 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.600609 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.600609 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.616241 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.616241 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.616241 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.616241 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.616241 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.631874 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.631874 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.631874 [debug] [MainThread]: Setting Default Schema: dev
[0m14:35:18.679448 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:35:18.695084 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:35:18.695084 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:35:18.695084 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:35:18.695084 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:35:18.710703 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:35:18.710703 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m14:35:18.710703 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:35:18.710703 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m14:35:18.726348 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:35:18.726348 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:35:18.741955 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:35:18.745065 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:35:18.745065 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:35:18.745065 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:35:18.745065 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:35:18.758179 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m14:35:18.789535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m14:35:18.805185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b9dcb5d-1c02-4534-83b5-906b20c2498d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CCDE50D0>]}
[0m14:35:18.816006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b9dcb5d-1c02-4534-83b5-906b20c2498d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CC97ADF0>]}
[0m14:35:18.816006 [info ] [MainThread]: Found 12 models, 6 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m14:35:18.816006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b9dcb5d-1c02-4534-83b5-906b20c2498d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CCA9A580>]}
[0m14:35:18.816006 [info ] [MainThread]: 
[0m14:35:18.816006 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:35:18.816006 [debug] [MainThread]: Command end result
[0m14:35:18.845470 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:35:18.845470 after 2.81 seconds
[0m14:35:18.847451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B89FA8C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CCA3A610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CC962820>]}
[0m14:35:18.847451 [debug] [MainThread]: Flushing usage events
[0m14:36:36.830619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F186DC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1CA37EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1CA37F10>]}


============================== 14:36:36.835732 | 710c368d-2073-493e-8451-418b3b52df76 ==============================
[0m14:36:36.835732 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:36:36.835732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:36:38.069986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '710c368d-2073-493e-8451-418b3b52df76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F1CA37FD0>]}
[0m14:36:38.069986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '710c368d-2073-493e-8451-418b3b52df76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F455A7F40>]}
[0m14:36:38.085631 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m14:36:38.111609 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:36:38.292020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m14:36:38.292020 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.sql
[0m14:36:38.292020 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.yml
[0m14:36:38.324209 [debug] [MainThread]: Setting Default Schema: dev
[0m14:36:38.339910 [warn ] [MainThread]: [[33mWARNING[0m]: 'snp_customer_customer_type' is a snapshot node, but it is specified in the
models section of snapshots\snp_customer_customer_type.yml. To fix this error,
place the `snp_customer_customer_type` specification under the snapshots key
instead.
[0m14:36:38.348158 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.northwind.snp_customer_customer_type' (snapshots\snp_customer_customer_type.sql) depends on a source named 'staging.stg_customer_customer_type' which was not found
[0m14:36:38.348158 [debug] [MainThread]: Command `dbt snapshot` failed at 14:36:38.348158 after 1.54 seconds
[0m14:36:38.348158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F186DC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F458D2D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F458D2970>]}
[0m14:36:38.348158 [debug] [MainThread]: Flushing usage events
[0m14:37:45.760005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE3ED0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE8237F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE8237FA0>]}


============================== 14:37:45.775691 | 80c53642-7968-417b-88b7-3f6dfc4bce5f ==============================
[0m14:37:45.775691 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:37:45.776928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:47.228177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80c53642-7968-417b-88b7-3f6dfc4bce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE8237F40>]}
[0m14:37:47.239425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80c53642-7968-417b-88b7-3f6dfc4bce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD921A5FD0>]}
[0m14:37:47.239425 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m14:37:47.252035 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:37:47.475102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m14:37:47.480199 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.yml
[0m14:37:47.480199 [debug] [MainThread]: Partial parsing: added file: northwind://snapshots\snp_customer_customer_type.sql
[0m14:37:47.505296 [debug] [MainThread]: Setting Default Schema: dev
[0m14:37:47.521300 [warn ] [MainThread]: [[33mWARNING[0m]: 'snp_customer_customer_type' is a snapshot node, but it is specified in the
models section of snapshots\snp_customer_customer_type.yml. To fix this error,
place the `snp_customer_customer_type` specification under the snapshots key
instead.
[0m14:37:47.529347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m14:37:47.545158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80c53642-7968-417b-88b7-3f6dfc4bce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD925030D0>]}
[0m14:37:47.572321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80c53642-7968-417b-88b7-3f6dfc4bce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD92329A60>]}
[0m14:37:47.576234 [info ] [MainThread]: Found 12 models, 6 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m14:37:47.576234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80c53642-7968-417b-88b7-3f6dfc4bce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD923298B0>]}
[0m14:37:47.576234 [info ] [MainThread]: 
[0m14:37:47.576234 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:37:47.576234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m14:37:47.650571 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m14:37:47.650571 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m14:37:47.650571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:49.060783 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:37:49.060783 [debug] [ThreadPool]: On list_DEV: Close
[0m14:37:49.154902 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_dev'
[0m14:37:49.154902 [debug] [ThreadPool]: Using snowflake connection "list_DEV_dev"
[0m14:37:49.154902 [debug] [ThreadPool]: On list_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_dev"} */
show terse objects in DEV.dev limit 10000
[0m14:37:49.154902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:50.228243 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b05fb9-3200-f55a-0004-6e520001e1ce
[0m14:37:50.228243 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:37:50.228243 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:37:50.228243 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:37:50.228243 [debug] [ThreadPool]: On list_DEV_dev: Close
[0m14:37:50.338984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_dev, now list_DEV_CURATED)
[0m14:37:50.338984 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m14:37:50.353542 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m14:37:50.353542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:51.197150 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:37:51.197150 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m14:37:51.297607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_SNAPSHOT)
[0m14:37:51.303216 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m14:37:51.303216 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m14:37:51.303216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:52.110723 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:37:52.110723 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m14:37:52.659155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_STAGING)
[0m14:37:52.667143 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m14:37:52.668990 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m14:37:52.668990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:53.770416 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m14:37:53.770416 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m14:37:53.849010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80c53642-7968-417b-88b7-3f6dfc4bce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9285CC70>]}
[0m14:37:53.849010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:53.864656 [info ] [MainThread]: 
[0m14:37:53.864656 [debug] [Thread-1  ]: Began running node snapshot.northwind.snp_customer_customer_type
[0m14:37:53.864656 [info ] [Thread-1  ]: 1 of 1 START snapshot SNAPSHOT.snp_customer_customer_type ...................... [RUN]
[0m14:37:53.874565 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.northwind.snp_customer_customer_type'
[0m14:37:53.874565 [debug] [Thread-1  ]: Began compiling node snapshot.northwind.snp_customer_customer_type
[0m14:37:53.883480 [debug] [Thread-1  ]: Timing info for snapshot.northwind.snp_customer_customer_type (compile): 14:37:53.874565 => 14:37:53.883480
[0m14:37:53.886701 [debug] [Thread-1  ]: Began executing node snapshot.northwind.snp_customer_customer_type
[0m14:37:53.954873 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.northwind.snp_customer_customer_type"
[0m14:37:53.962883 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m14:37:53.962883 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
create or replace transient table DEV.SNAPSHOT.snp_customer_customer_type
         as
        (

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        

select * from prod.staging.stg_customer_customer_type
    ) sbq



        );
[0m14:37:53.962883 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:37:55.627336 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:37:55.658951 [debug] [Thread-1  ]: Timing info for snapshot.northwind.snp_customer_customer_type (execute): 14:37:53.886701 => 14:37:55.658447
[0m14:37:55.659357 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: Close
[0m14:37:55.737515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80c53642-7968-417b-88b7-3f6dfc4bce5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD928D25B0>]}
[0m14:37:55.737515 [info ] [Thread-1  ]: 1 of 1 OK snapshotted SNAPSHOT.snp_customer_customer_type ...................... [[32msuccess[0m in 1.87s]
[0m14:37:55.737515 [debug] [Thread-1  ]: Finished running node snapshot.northwind.snp_customer_customer_type
[0m14:37:55.754500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:55.755705 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m14:37:55.757195 [debug] [MainThread]: Connection 'list_DEV_STAGING' was properly closed.
[0m14:37:55.758363 [debug] [MainThread]: Connection 'snapshot.northwind.snp_customer_customer_type' was properly closed.
[0m14:37:55.759628 [info ] [MainThread]: 
[0m14:37:55.761356 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.18 seconds (8.18s).
[0m14:37:55.762858 [debug] [MainThread]: Command end result
[0m14:37:55.780840 [info ] [MainThread]: 
[0m14:37:55.780840 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:55.780840 [info ] [MainThread]: 
[0m14:37:55.780840 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:37:55.780840 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:37:55.780840 after 10.05 seconds
[0m14:37:55.780840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE3ED0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD921A0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD92893910>]}
[0m14:37:55.780840 [debug] [MainThread]: Flushing usage events
[0m15:02:00.069713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028146ECC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002814B227FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002814B227FA0>]}


============================== 15:02:00.085064 | 23b07b9e-43ba-4818-b11b-8c0972757d38 ==============================
[0m15:02:00.085064 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:02:00.085064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_customer_tier', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:02:01.209424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23b07b9e-43ba-4818-b11b-8c0972757d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002814B227F70>]}
[0m15:02:01.216536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23b07b9e-43ba-4818-b11b-8c0972757d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028173D99FD0>]}
[0m15:02:01.216536 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m15:02:01.243699 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:02:01.427676 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m15:02:01.427676 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_customer_tier.yml
[0m15:02:01.427676 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\dim_customer_tier.sql
[0m15:02:01.427676 [debug] [MainThread]: Partial parsing: deleted file: northwind://models\serving\dim_customer_type.sql
[0m15:02:01.474656 [debug] [MainThread]: Setting Default Schema: dev
[0m15:02:01.496820 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:02:01.516585 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:02:01.516585 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:02:01.531713 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:02:01.531713 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:02:01.539715 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:02:01.547949 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m15:02:01.556064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23b07b9e-43ba-4818-b11b-8c0972757d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281741250D0>]}
[0m15:02:01.619992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23b07b9e-43ba-4818-b11b-8c0972757d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028173D4CDF0>]}
[0m15:02:01.619992 [info ] [MainThread]: Found 12 models, 11 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m15:02:01.625496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23b07b9e-43ba-4818-b11b-8c0972757d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028173D4C370>]}
[0m15:02:01.625496 [info ] [MainThread]: 
[0m15:02:01.628043 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:02:01.628043 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:02:01.644188 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:02:01.644188 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:02:01.644188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:02.866661 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:02:02.866661 [debug] [ThreadPool]: On list_DEV: Close
[0m15:02:03.172693 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_CURATED'
[0m15:02:03.187930 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m15:02:03.187930 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m15:02:03.204103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:03.991787 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:02:03.997449 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m15:02:04.101600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_SNAPSHOT)
[0m15:02:04.107776 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m15:02:04.107776 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m15:02:04.107776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:04.886040 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:02:04.886040 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m15:02:04.980579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_STAGING)
[0m15:02:04.980579 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m15:02:04.980579 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m15:02:04.980579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:05.781196 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m15:02:05.781196 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m15:02:05.878620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23b07b9e-43ba-4818-b11b-8c0972757d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002814B263C70>]}
[0m15:02:05.878620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:05.878620 [info ] [MainThread]: 
[0m15:02:05.892446 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m15:02:05.892446 [info ] [Thread-1  ]: 1 of 1 START sql view model CURATED.dim_customer_tier .......................... [RUN]
[0m15:02:05.898133 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer_tier'
[0m15:02:05.899220 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m15:02:05.907085 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m15:02:05.907085 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 15:02:05.899220 => 15:02:05.907085
[0m15:02:05.907085 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m15:02:05.939883 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m15:02:05.939883 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m15:02:05.939883 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer_tier"} */
create or replace   view DEV.CURATED.dim_customer_tier
  
   as (
    with snp_customer_customer_type as (
    select 
        customer_id, 
        customer_type_id, 
        dbt_scd_id, 
        dbt_updated_at, 
        dbt_valid_from, 
        dbt_valid_to
    from DEV.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select
        customer_type_id,
        customer_desc
    from DEV.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_idsnp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id
    stg_customer_type.customer_desc as customer_tier,
    dbt_valid_from as valid_from, 
    dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
  );
[0m15:02:05.939883 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:02:06.963308 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b05fd2-3200-f596-0004-6e520001a23a
[0m15:02:06.963899 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 28 at position 4 unexpected 'stg_customer_type'.
[0m15:02:06.964930 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 15:02:05.907085 => 15:02:06.964409
[0m15:02:06.965458 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m15:02:07.055422 [debug] [Thread-1  ]: Database Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 4 unexpected 'stg_customer_type'.
  compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m15:02:07.056771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23b07b9e-43ba-4818-b11b-8c0972757d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281745FC730>]}
[0m15:02:07.057452 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model CURATED.dim_customer_tier ................. [[31mERROR[0m in 1.16s]
[0m15:02:07.059241 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m15:02:07.061157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:07.061157 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m15:02:07.061157 [debug] [MainThread]: Connection 'list_DEV_STAGING' was properly closed.
[0m15:02:07.061157 [debug] [MainThread]: Connection 'model.northwind.dim_customer_tier' was properly closed.
[0m15:02:07.061157 [info ] [MainThread]: 
[0m15:02:07.066023 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m15:02:07.067110 [debug] [MainThread]: Command end result
[0m15:02:07.082438 [info ] [MainThread]: 
[0m15:02:07.084090 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:02:07.084090 [info ] [MainThread]: 
[0m15:02:07.084090 [error] [MainThread]: [33mDatabase Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)[0m
[0m15:02:07.086959 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m15:02:07.086959 [error] [MainThread]:   syntax error line 28 at position 4 unexpected 'stg_customer_type'.
[0m15:02:07.086959 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m15:02:07.086959 [info ] [MainThread]: 
[0m15:02:07.086959 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:02:07.086959 [debug] [MainThread]: Command `dbt run` failed at 15:02:07.086959 after 7.03 seconds
[0m15:02:07.086959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028146ECC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028173D99FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028173D4C0D0>]}
[0m15:02:07.086959 [debug] [MainThread]: Flushing usage events
[0m15:06:03.381049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215EE0CC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F2427FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F245D040>]}


============================== 15:06:03.397097 | 918b1706-1905-4c4c-afc4-3e99a8f9eed7 ==============================
[0m15:06:03.397097 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:06:03.397097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customer_tier', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:06:04.570032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '918b1706-1905-4c4c-afc4-3e99a8f9eed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F2427FA0>]}
[0m15:06:04.570032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '918b1706-1905-4c4c-afc4-3e99a8f9eed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FFFC3DC0>]}
[0m15:06:04.585658 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m15:06:04.607056 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:06:04.760054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:04.760054 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer_tier.sql
[0m15:06:04.807736 [debug] [MainThread]: Setting Default Schema: dev
[0m15:06:04.831666 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:06:04.839775 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:06:04.839775 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:06:04.855988 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:06:04.855988 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:06:04.855988 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:06:04.863958 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m15:06:04.863958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '918b1706-1905-4c4c-afc4-3e99a8f9eed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159B2FB0D0>]}
[0m15:06:04.945982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '918b1706-1905-4c4c-afc4-3e99a8f9eed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FFF7DE80>]}
[0m15:06:04.945982 [info ] [MainThread]: Found 12 models, 11 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m15:06:04.945982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '918b1706-1905-4c4c-afc4-3e99a8f9eed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FFF7DF40>]}
[0m15:06:04.945982 [info ] [MainThread]: 
[0m15:06:04.945982 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:06:04.954990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:06:04.962285 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:06:04.962285 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:06:04.962285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:06.231470 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:06:06.246791 [debug] [ThreadPool]: On list_DEV: Close
[0m15:06:06.325653 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_STAGING'
[0m15:06:06.350229 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m15:06:06.350229 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m15:06:06.350229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:07.290195 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m15:06:07.294749 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m15:06:07.366557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_SNAPSHOT)
[0m15:06:07.381071 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m15:06:07.381071 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m15:06:07.381071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:08.443536 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:06:08.443536 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m15:06:08.537648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_CURATED)
[0m15:06:08.537648 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m15:06:08.537648 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m15:06:08.537648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:09.277417 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:06:09.277417 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m15:06:09.389077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '918b1706-1905-4c4c-afc4-3e99a8f9eed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F245D1C0>]}
[0m15:06:09.389997 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:06:09.389997 [info ] [MainThread]: 
[0m15:06:09.389997 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m15:06:09.389997 [info ] [Thread-1  ]: 1 of 1 START sql view model CURATED.dim_customer_tier .......................... [RUN]
[0m15:06:09.406086 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer_tier'
[0m15:06:09.406609 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m15:06:09.421788 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m15:06:09.421788 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 15:06:09.406609 => 15:06:09.421788
[0m15:06:09.421788 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m15:06:09.455399 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m15:06:09.455399 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m15:06:09.455399 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer_tier"} */
create or replace   view DEV.CURATED.dim_customer_tier
  
   as (
    with snp_customer_customer_type as (
    select 
        customer_id, 
        customer_type_id, 
        dbt_scd_id, 
        dbt_updated_at, 
        dbt_valid_from, 
        dbt_valid_to
    from DEV.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from DEV.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_idsnp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id
    stg_customer_type.customer_desc as customer_tier,
    dbt_valid_from as valid_from, 
    dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
  );
[0m15:06:09.455399 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:06:10.284661 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b05fd6-3200-f56a-0004-6e520001f0b2
[0m15:06:10.284661 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 4 unexpected 'stg_customer_type'.
[0m15:06:10.284661 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 15:06:09.421788 => 15:06:10.284661
[0m15:06:10.284661 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m15:06:10.390271 [debug] [Thread-1  ]: Database Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 4 unexpected 'stg_customer_type'.
  compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m15:06:10.390271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '918b1706-1905-4c4c-afc4-3e99a8f9eed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159B80BBB0>]}
[0m15:06:10.390271 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model CURATED.dim_customer_tier ................. [[31mERROR[0m in 0.99s]
[0m15:06:10.390271 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m15:06:10.405896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:10.408040 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m15:06:10.408040 [debug] [MainThread]: Connection 'list_DEV_CURATED' was properly closed.
[0m15:06:10.410297 [debug] [MainThread]: Connection 'model.northwind.dim_customer_tier' was properly closed.
[0m15:06:10.410297 [info ] [MainThread]: 
[0m15:06:10.410297 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m15:06:10.410297 [debug] [MainThread]: Command end result
[0m15:06:10.423647 [info ] [MainThread]: 
[0m15:06:10.423647 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:06:10.423647 [info ] [MainThread]: 
[0m15:06:10.423647 [error] [MainThread]: [33mDatabase Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)[0m
[0m15:06:10.423647 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m15:06:10.423647 [error] [MainThread]:   syntax error line 26 at position 4 unexpected 'stg_customer_type'.
[0m15:06:10.437682 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m15:06:10.437682 [info ] [MainThread]: 
[0m15:06:10.437682 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:06:10.437682 [debug] [MainThread]: Command `dbt run` failed at 15:06:10.437682 after 7.07 seconds
[0m15:06:10.437682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215EE0CC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FFF7DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FFF67BB0>]}
[0m15:06:10.437682 [debug] [MainThread]: Flushing usage events
[0m15:08:56.958859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAEFFFC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF4358F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF4358F70>]}


============================== 15:08:56.958859 | 73a3b6bb-d523-4053-87df-98cc7b159349 ==============================
[0m15:08:56.958859 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:08:56.958859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_customer_tier', 'send_anonymous_usage_stats': 'True'}
[0m15:08:58.054320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73a3b6bb-d523-4053-87df-98cc7b159349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF4358F10>]}
[0m15:08:58.069945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73a3b6bb-d523-4053-87df-98cc7b159349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFFEF9F70>]}
[0m15:08:58.069945 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m15:08:58.098414 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:08:58.309427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:58.309427 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer_tier.sql
[0m15:08:58.339596 [debug] [MainThread]: Setting Default Schema: dev
[0m15:08:58.370845 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:08:58.370845 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:08:58.386445 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:08:58.386445 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:08:58.402201 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:08:58.402201 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:08:58.402201 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m15:08:58.417949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73a3b6bb-d523-4053-87df-98cc7b159349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA9D266F10>]}
[0m15:08:58.494571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73a3b6bb-d523-4053-87df-98cc7b159349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFFEA1D90>]}
[0m15:08:58.494571 [info ] [MainThread]: Found 12 models, 11 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m15:08:58.494571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73a3b6bb-d523-4053-87df-98cc7b159349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFFEA12B0>]}
[0m15:08:58.494571 [info ] [MainThread]: 
[0m15:08:58.499118 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:08:58.499118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:08:58.514791 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:08:58.514791 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:08:58.514791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:59.833136 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:08:59.833136 [debug] [ThreadPool]: On list_DEV: Close
[0m15:08:59.925356 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_SNAPSHOT'
[0m15:08:59.940982 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m15:08:59.940982 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m15:08:59.940982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:00.903901 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:09:00.909699 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m15:09:01.006750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_STAGING)
[0m15:09:01.006750 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m15:09:01.006750 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m15:09:01.006750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:02.207167 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m15:09:02.207167 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m15:09:02.296824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_CURATED)
[0m15:09:02.307400 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m15:09:02.307400 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m15:09:02.307400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:03.104900 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:09:03.108503 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m15:09:03.201616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73a3b6bb-d523-4053-87df-98cc7b159349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF215FAF0>]}
[0m15:09:03.201616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:09:03.208640 [info ] [MainThread]: 
[0m15:09:03.219568 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m15:09:03.219568 [info ] [Thread-1  ]: 1 of 1 START sql view model CURATED.dim_customer_tier .......................... [RUN]
[0m15:09:03.224586 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer_tier'
[0m15:09:03.226141 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m15:09:03.241067 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m15:09:03.241067 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 15:09:03.226141 => 15:09:03.241067
[0m15:09:03.241067 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m15:09:03.272403 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m15:09:03.272403 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m15:09:03.272403 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer_tier"} */
create or replace   view DEV.CURATED.dim_customer_tier
  
   as (
    with snp_customer_customer_type as (
    select 
        customer_id, 
        customer_type_id, 
        dbt_scd_id, 
        dbt_updated_at, 
        dbt_valid_from, 
        dbt_valid_to
    from DEV.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from DEV.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_idsnp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    dbt_valid_from as valid_from, 
    dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
  );
[0m15:09:03.279248 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:09:04.277827 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b05fd9-3200-f55a-0004-6e520001e232
[0m15:09:04.277827 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 130
invalid identifier 'SNP_CUSTOMER_CUSTOMER_TYPE.CUSTOMER_TYPE_IDSNP_CUSTOMER_CUSTOMER_TYPE.DBT_VALID_FROM'
[0m15:09:04.277827 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 15:09:03.241067 => 15:09:04.277827
[0m15:09:04.283626 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m15:09:04.373467 [debug] [Thread-1  ]: Database Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)
  000904 (42000): SQL compilation error: error line 23 at position 130
  invalid identifier 'SNP_CUSTOMER_CUSTOMER_TYPE.CUSTOMER_TYPE_IDSNP_CUSTOMER_CUSTOMER_TYPE.DBT_VALID_FROM'
  compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m15:09:04.373467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a3b6bb-d523-4053-87df-98cc7b159349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA9D75B130>]}
[0m15:09:04.373467 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model CURATED.dim_customer_tier ................. [[31mERROR[0m in 1.15s]
[0m15:09:04.373467 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m15:09:04.390941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:04.390941 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m15:09:04.390941 [debug] [MainThread]: Connection 'list_DEV_CURATED' was properly closed.
[0m15:09:04.390941 [debug] [MainThread]: Connection 'model.northwind.dim_customer_tier' was properly closed.
[0m15:09:04.390941 [info ] [MainThread]: 
[0m15:09:04.390941 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.89 seconds (5.89s).
[0m15:09:04.403141 [debug] [MainThread]: Command end result
[0m15:09:04.420163 [info ] [MainThread]: 
[0m15:09:04.421471 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:04.421471 [info ] [MainThread]: 
[0m15:09:04.421471 [error] [MainThread]: [33mDatabase Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)[0m
[0m15:09:04.421471 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 23 at position 130
[0m15:09:04.421471 [error] [MainThread]:   invalid identifier 'SNP_CUSTOMER_CUSTOMER_TYPE.CUSTOMER_TYPE_IDSNP_CUSTOMER_CUSTOMER_TYPE.DBT_VALID_FROM'
[0m15:09:04.421471 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m15:09:04.421471 [info ] [MainThread]: 
[0m15:09:04.421471 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:09:04.421471 [debug] [MainThread]: Command `dbt run` failed at 15:09:04.421471 after 7.49 seconds
[0m15:09:04.421471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAEFFFC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFFEF9F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFF98AF40>]}
[0m15:09:04.421471 [debug] [MainThread]: Flushing usage events
[0m15:10:14.723640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F338C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F76E7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F771D040>]}


============================== 15:10:14.723640 | 511b2143-e037-47cb-9496-6c69dc2154f7 ==============================
[0m15:10:14.723640 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:10:14.723640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customer_tier', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:10:15.981037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '511b2143-e037-47cb-9496-6c69dc2154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F76E7FA0>]}
[0m15:10:15.990036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '511b2143-e037-47cb-9496-6c69dc2154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A0252DC0>]}
[0m15:10:15.992126 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m15:10:16.018661 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:10:16.174578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:16.174578 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer_tier.sql
[0m15:10:16.206422 [debug] [MainThread]: Setting Default Schema: dev
[0m15:10:16.238020 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:10:16.253886 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:10:16.254465 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:10:16.261995 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:10:16.270006 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:10:16.270006 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:10:16.287066 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m15:10:16.288809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '511b2143-e037-47cb-9496-6c69dc2154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A05DE0D0>]}
[0m15:10:16.357857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '511b2143-e037-47cb-9496-6c69dc2154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A020DE80>]}
[0m15:10:16.357857 [info ] [MainThread]: Found 12 models, 11 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m15:10:16.357857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '511b2143-e037-47cb-9496-6c69dc2154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A020DF40>]}
[0m15:10:16.357857 [info ] [MainThread]: 
[0m15:10:16.357857 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:10:16.368866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:10:16.377233 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:10:16.377233 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:10:16.377233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:17.765395 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:10:17.765395 [debug] [ThreadPool]: On list_DEV: Close
[0m15:10:17.860562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_SNAPSHOT'
[0m15:10:17.876183 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m15:10:17.876183 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m15:10:17.876183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:18.870359 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:10:18.870359 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m15:10:18.980108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_CURATED)
[0m15:10:18.980108 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m15:10:18.980108 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m15:10:18.980108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:19.786343 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:10:19.794366 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m15:10:19.882005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_STAGING)
[0m15:10:19.882005 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m15:10:19.882005 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m15:10:19.882005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:20.936298 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m15:10:20.936298 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m15:10:21.049235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '511b2143-e037-47cb-9496-6c69dc2154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A056B850>]}
[0m15:10:21.049235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:10:21.049235 [info ] [MainThread]: 
[0m15:10:21.063783 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m15:10:21.063783 [info ] [Thread-1  ]: 1 of 1 START sql view model CURATED.dim_customer_tier .......................... [RUN]
[0m15:10:21.063783 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer_tier'
[0m15:10:21.063783 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m15:10:21.077290 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m15:10:21.078694 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 15:10:21.063783 => 15:10:21.077290
[0m15:10:21.078694 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m15:10:21.109226 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m15:10:21.109226 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m15:10:21.109226 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer_tier"} */
create or replace   view DEV.CURATED.dim_customer_tier
  
   as (
    with snp_customer_customer_type as (
    select 
        customer_id, 
        customer_type_id, 
        dbt_scd_id, 
        dbt_updated_at, 
        dbt_valid_from, 
        dbt_valid_to
    from DEV.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from DEV.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_idsnp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
  );
[0m15:10:21.109226 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:10:21.936787 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b05fda-3200-f596-0004-6e520001a26e
[0m15:10:21.937513 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 130
invalid identifier 'SNP_CUSTOMER_CUSTOMER_TYPE.CUSTOMER_TYPE_IDSNP_CUSTOMER_CUSTOMER_TYPE.DBT_VALID_FROM'
[0m15:10:21.938153 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 15:10:21.079520 => 15:10:21.938153
[0m15:10:21.938722 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m15:10:22.019040 [debug] [Thread-1  ]: Database Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)
  000904 (42000): SQL compilation error: error line 23 at position 130
  invalid identifier 'SNP_CUSTOMER_CUSTOMER_TYPE.CUSTOMER_TYPE_IDSNP_CUSTOMER_CUSTOMER_TYPE.DBT_VALID_FROM'
  compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m15:10:22.035351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '511b2143-e037-47cb-9496-6c69dc2154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A0ABAC70>]}
[0m15:10:22.035351 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model CURATED.dim_customer_tier ................. [[31mERROR[0m in 0.97s]
[0m15:10:22.035351 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m15:10:22.035351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:22.035351 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m15:10:22.035351 [debug] [MainThread]: Connection 'list_DEV_STAGING' was properly closed.
[0m15:10:22.035351 [debug] [MainThread]: Connection 'model.northwind.dim_customer_tier' was properly closed.
[0m15:10:22.035351 [info ] [MainThread]: 
[0m15:10:22.051200 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.68 seconds (5.68s).
[0m15:10:22.054048 [debug] [MainThread]: Command end result
[0m15:10:22.061451 [info ] [MainThread]: 
[0m15:10:22.061451 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:10:22.061451 [info ] [MainThread]: 
[0m15:10:22.061451 [error] [MainThread]: [33mDatabase Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)[0m
[0m15:10:22.061451 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 23 at position 130
[0m15:10:22.075514 [error] [MainThread]:   invalid identifier 'SNP_CUSTOMER_CUSTOMER_TYPE.CUSTOMER_TYPE_IDSNP_CUSTOMER_CUSTOMER_TYPE.DBT_VALID_FROM'
[0m15:10:22.076800 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m15:10:22.076800 [info ] [MainThread]: 
[0m15:10:22.076800 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:10:22.076800 [debug] [MainThread]: Command `dbt run` failed at 15:10:22.076800 after 7.38 seconds
[0m15:10:22.080876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F338C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F779A0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F6D1FD00>]}
[0m15:10:22.080876 [debug] [MainThread]: Flushing usage events
[0m15:10:56.316490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7C73C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D00BC7FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D00BC7FD0>]}


============================== 15:10:56.316490 | 7baa0f72-c151-4bf1-87b7-d9eb89d01dff ==============================
[0m15:10:56.316490 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:10:56.329839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customer_tier', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:10:57.465132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7baa0f72-c151-4bf1-87b7-d9eb89d01dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D00BC7F70>]}
[0m15:10:57.471795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7baa0f72-c151-4bf1-87b7-d9eb89d01dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D29607FD0>]}
[0m15:10:57.479171 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m15:10:57.519011 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:10:57.709432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:57.711044 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer_tier.sql
[0m15:10:57.739526 [debug] [MainThread]: Setting Default Schema: dev
[0m15:10:57.767104 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:10:57.782618 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:10:57.782618 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:10:57.790632 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:10:57.798640 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:10:57.798640 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:10:57.806810 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m15:10:57.806810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7baa0f72-c151-4bf1-87b7-d9eb89d01dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D299860D0>]}
[0m15:10:57.890127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7baa0f72-c151-4bf1-87b7-d9eb89d01dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D295BDDF0>]}
[0m15:10:57.890917 [info ] [MainThread]: Found 12 models, 11 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m15:10:57.892000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7baa0f72-c151-4bf1-87b7-d9eb89d01dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D295BD370>]}
[0m15:10:57.893329 [info ] [MainThread]: 
[0m15:10:57.895025 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:10:57.897055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:10:57.907317 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:10:57.907317 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:10:57.907317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:59.235614 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:10:59.251249 [debug] [ThreadPool]: On list_DEV: Close
[0m15:10:59.345626 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_STAGING'
[0m15:10:59.361355 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m15:10:59.361355 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m15:10:59.361355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:00.404013 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m15:11:00.404013 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m15:11:00.514225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_CURATED)
[0m15:11:00.514225 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m15:11:00.514225 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m15:11:00.514225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:01.628633 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:11:01.634739 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m15:11:01.729547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_SNAPSHOT)
[0m15:11:01.729547 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m15:11:01.729547 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m15:11:01.729547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:02.818945 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:11:02.818945 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m15:11:02.913289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7baa0f72-c151-4bf1-87b7-d9eb89d01dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D2991B190>]}
[0m15:11:02.913289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:11:02.913289 [info ] [MainThread]: 
[0m15:11:02.929075 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m15:11:02.929075 [info ] [Thread-1  ]: 1 of 1 START sql view model CURATED.dim_customer_tier .......................... [RUN]
[0m15:11:02.929075 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer_tier'
[0m15:11:02.938211 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m15:11:02.944990 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m15:11:02.944990 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 15:11:02.938211 => 15:11:02.944990
[0m15:11:02.954180 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m15:11:02.975145 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m15:11:02.975145 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m15:11:02.986279 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer_tier"} */
create or replace   view DEV.CURATED.dim_customer_tier
  
   as (
    with snp_customer_customer_type as (
    select *
    from DEV.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from DEV.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_idsnp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
  );
[0m15:11:02.986279 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:11:03.964748 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b05fdb-3200-f56a-0004-6e520001f0c2
[0m15:11:03.964748 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 130
invalid identifier 'SNP_CUSTOMER_CUSTOMER_TYPE.CUSTOMER_TYPE_IDSNP_CUSTOMER_CUSTOMER_TYPE.DBT_VALID_FROM'
[0m15:11:03.964748 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 15:11:02.954180 => 15:11:03.964748
[0m15:11:03.980337 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m15:11:04.074810 [debug] [Thread-1  ]: Database Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)
  000904 (42000): SQL compilation error: error line 17 at position 130
  invalid identifier 'SNP_CUSTOMER_CUSTOMER_TYPE.CUSTOMER_TYPE_IDSNP_CUSTOMER_CUSTOMER_TYPE.DBT_VALID_FROM'
  compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m15:11:04.074810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7baa0f72-c151-4bf1-87b7-d9eb89d01dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D29E6BA30>]}
[0m15:11:04.074810 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model CURATED.dim_customer_tier ................. [[31mERROR[0m in 1.15s]
[0m15:11:04.074810 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m15:11:04.074810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:04.074810 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m15:11:04.074810 [debug] [MainThread]: Connection 'list_DEV_SNAPSHOT' was properly closed.
[0m15:11:04.074810 [debug] [MainThread]: Connection 'model.northwind.dim_customer_tier' was properly closed.
[0m15:11:04.090429 [info ] [MainThread]: 
[0m15:11:04.092228 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.20 seconds (6.20s).
[0m15:11:04.094731 [debug] [MainThread]: Command end result
[0m15:11:04.106674 [info ] [MainThread]: 
[0m15:11:04.111507 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:11:04.111507 [info ] [MainThread]: 
[0m15:11:04.111507 [error] [MainThread]: [33mDatabase Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)[0m
[0m15:11:04.111507 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 17 at position 130
[0m15:11:04.115116 [error] [MainThread]:   invalid identifier 'SNP_CUSTOMER_CUSTOMER_TYPE.CUSTOMER_TYPE_IDSNP_CUSTOMER_CUSTOMER_TYPE.DBT_VALID_FROM'
[0m15:11:04.116158 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m15:11:04.117108 [info ] [MainThread]: 
[0m15:11:04.117108 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:11:04.117108 [debug] [MainThread]: Command `dbt run` failed at 15:11:04.117108 after 7.82 seconds
[0m15:11:04.117108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7C73C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D00C7B0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D295BD3D0>]}
[0m15:11:04.117108 [debug] [MainThread]: Flushing usage events
[0m15:11:55.802574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193B40C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193F767FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193F767FD0>]}


============================== 15:11:55.802574 | eb2f3d58-f485-491f-bd62-331fb51624eb ==============================
[0m15:11:55.802574 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:11:55.802574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_customer_tier', 'send_anonymous_usage_stats': 'True'}
[0m15:11:57.021618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb2f3d58-f485-491f-bd62-331fb51624eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193F767F70>]}
[0m15:11:57.037230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb2f3d58-f485-491f-bd62-331fb51624eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219682D9FD0>]}
[0m15:11:57.037230 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m15:11:57.055461 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:11:57.221618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:11:57.221618 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer_tier.sql
[0m15:11:57.262610 [debug] [MainThread]: Setting Default Schema: dev
[0m15:11:57.285889 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:11:57.295727 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:11:57.298296 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:11:57.310866 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:11:57.316741 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:11:57.316741 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:11:57.328300 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m15:11:57.335090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb2f3d58-f485-491f-bd62-331fb51624eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002196863C970>]}
[0m15:11:57.410277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb2f3d58-f485-491f-bd62-331fb51624eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002196828D550>]}
[0m15:11:57.410880 [info ] [MainThread]: Found 12 models, 11 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m15:11:57.411908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb2f3d58-f485-491f-bd62-331fb51624eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002196828D190>]}
[0m15:11:57.413489 [info ] [MainThread]: 
[0m15:11:57.414556 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:11:57.416936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:11:57.425997 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:11:57.425997 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:11:57.425997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:58.761233 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:11:58.764910 [debug] [ThreadPool]: On list_DEV: Close
[0m15:11:58.858173 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_STAGING'
[0m15:11:58.873915 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m15:11:58.873915 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m15:11:58.873915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:59.849271 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m15:11:59.855208 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m15:11:59.953797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_CURATED)
[0m15:11:59.965550 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m15:11:59.966299 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m15:11:59.966882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:00.703014 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:12:00.703014 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m15:12:00.796986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_SNAPSHOT)
[0m15:12:00.812634 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m15:12:00.812634 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m15:12:00.812634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:01.909484 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:12:01.909484 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m15:12:02.003554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb2f3d58-f485-491f-bd62-331fb51624eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219685A1BB0>]}
[0m15:12:02.005279 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:02.007070 [info ] [MainThread]: 
[0m15:12:02.012000 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m15:12:02.012000 [info ] [Thread-1  ]: 1 of 1 START sql view model CURATED.dim_customer_tier .......................... [RUN]
[0m15:12:02.012000 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer_tier'
[0m15:12:02.020112 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m15:12:02.030418 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m15:12:02.030418 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 15:12:02.021016 => 15:12:02.030418
[0m15:12:02.030418 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m15:12:02.063940 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m15:12:02.063940 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m15:12:02.063940 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer_tier"} */
create or replace   view DEV.CURATED.dim_customer_tier
  
   as (
    with snp_customer_customer_type as (
    select *
    from DEV.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from DEV.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
  );
[0m15:12:02.063940 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:12:03.054546 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:12:03.079946 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 15:12:02.030418 => 15:12:03.079946
[0m15:12:03.079946 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m15:12:03.160271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb2f3d58-f485-491f-bd62-331fb51624eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021968B2A8B0>]}
[0m15:12:03.160271 [info ] [Thread-1  ]: 1 of 1 OK created sql view model CURATED.dim_customer_tier ..................... [[32mSUCCESS 1[0m in 1.15s]
[0m15:12:03.176627 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m15:12:03.176627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:03.176627 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m15:12:03.176627 [debug] [MainThread]: Connection 'list_DEV_SNAPSHOT' was properly closed.
[0m15:12:03.176627 [debug] [MainThread]: Connection 'model.northwind.dim_customer_tier' was properly closed.
[0m15:12:03.176627 [info ] [MainThread]: 
[0m15:12:03.176627 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.76 seconds (5.76s).
[0m15:12:03.191553 [debug] [MainThread]: Command end result
[0m15:12:03.208431 [info ] [MainThread]: 
[0m15:12:03.208431 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:03.213003 [info ] [MainThread]: 
[0m15:12:03.213003 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:12:03.215512 [debug] [MainThread]: Command `dbt run` succeeded at 15:12:03.215512 after 7.43 seconds
[0m15:12:03.215512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193B40C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219682D9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021968B2A8B0>]}
[0m15:12:03.215512 [debug] [MainThread]: Flushing usage events
[0m15:15:14.544467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFD35C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB817D7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB8180D040>]}


============================== 15:15:14.558288 | 7b09b190-c244-4e58-bedf-dc8d437484c0 ==============================
[0m15:15:14.558288 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:15:14.558288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_customer_tier', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:15:15.621323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b09b190-c244-4e58-bedf-dc8d437484c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB817D7FA0>]}
[0m15:15:15.631435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b09b190-c244-4e58-bedf-dc8d437484c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBAA1D2880>]}
[0m15:15:15.631435 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m15:15:15.660990 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:15:15.679384 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:15:15.679384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b09b190-c244-4e58-bedf-dc8d437484c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBAA2173D0>]}
[0m15:15:16.869603 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.885238 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.885238 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.900863 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.900863 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.900863 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.916488 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.916488 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.923496 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.923496 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.923496 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.932505 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.948138 [debug] [MainThread]: Setting Default Schema: dev
[0m15:15:16.995039 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:15:17.010665 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:15:17.010665 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:15:17.010665 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:15:17.023782 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:15:17.023782 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:15:17.026881 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:15:17.042616 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:15:17.042616 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:15:17.042616 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:15:17.042616 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:15:17.042616 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:15:17.058140 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:15:17.058140 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:15:17.058140 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:15:17.073764 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m15:15:17.073764 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m15:15:17.089390 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m15:15:17.089390 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m15:15:17.089390 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m15:15:17.089390 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m15:15:17.089390 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m15:15:17.105015 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m15:15:17.105015 [warn ] [MainThread]: [[33mWARNING[0m]: 'snp_customer_customer_type' is a snapshot node, but it is specified in the
models section of snapshots\snp_customer_customer_type.yml. To fix this error,
place the `snp_customer_customer_type` specification under the snapshots key
instead.
[0m15:15:17.152404 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m15:15:17.159708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b09b190-c244-4e58-bedf-dc8d437484c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBAA728FD0>]}
[0m15:15:17.177132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b09b190-c244-4e58-bedf-dc8d437484c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBAA2E2A00>]}
[0m15:15:17.177132 [info ] [MainThread]: Found 12 models, 1 snapshot, 11 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m15:15:17.177132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b09b190-c244-4e58-bedf-dc8d437484c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFF3E4AC0>]}
[0m15:15:17.177132 [info ] [MainThread]: 
[0m15:15:17.177132 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:15:17.192796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:15:17.208093 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:15:17.210181 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:15:17.210181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:18.425852 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:15:18.425852 [debug] [ThreadPool]: On list_DEV: Close
[0m15:15:18.527605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_SNAPSHOT'
[0m15:15:18.536119 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m15:15:18.536119 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m15:15:18.536119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:19.290407 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:15:19.290407 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m15:15:19.400203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_CURATED)
[0m15:15:19.400203 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m15:15:19.400203 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m15:15:19.400203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:21.187464 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.0 seconds
[0m15:15:21.187464 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m15:15:21.274231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_STAGING)
[0m15:15:21.287811 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m15:15:21.288743 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m15:15:21.289764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:22.856466 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m15:15:22.856466 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m15:15:23.206108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b09b190-c244-4e58-bedf-dc8d437484c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA9CB9FD0>]}
[0m15:15:23.206108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:23.206108 [info ] [MainThread]: 
[0m15:15:23.222405 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m15:15:23.222988 [info ] [Thread-1  ]: 1 of 1 START sql view model CURATED.dim_customer_tier .......................... [RUN]
[0m15:15:23.225307 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer_tier'
[0m15:15:23.225307 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m15:15:23.252290 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m15:15:23.258449 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 15:15:23.225307 => 15:15:23.257305
[0m15:15:23.259590 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m15:15:23.325386 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m15:15:23.332909 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m15:15:23.332909 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer_tier"} */
create or replace   view DEV.CURATED.dim_customer_tier
  
   as (
    with snp_customer_customer_type as (
    select *
    from DEV.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from DEV.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
  );
[0m15:15:23.332909 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:15:24.980010 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:15:25.035928 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 15:15:23.259590 => 15:15:25.027416
[0m15:15:25.035928 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m15:15:25.125763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b09b190-c244-4e58-bedf-dc8d437484c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBAA30B490>]}
[0m15:15:25.125763 [info ] [Thread-1  ]: 1 of 1 OK created sql view model CURATED.dim_customer_tier ..................... [[32mSUCCESS 1[0m in 1.90s]
[0m15:15:25.131922 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m15:15:25.139146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:25.142518 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m15:15:25.142518 [debug] [MainThread]: Connection 'list_DEV_STAGING' was properly closed.
[0m15:15:25.145635 [debug] [MainThread]: Connection 'model.northwind.dim_customer_tier' was properly closed.
[0m15:15:25.146736 [info ] [MainThread]: 
[0m15:15:25.149270 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m15:15:25.149270 [debug] [MainThread]: Command end result
[0m15:15:25.183571 [info ] [MainThread]: 
[0m15:15:25.187401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:25.188900 [info ] [MainThread]: 
[0m15:15:25.194147 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:15:25.194147 [debug] [MainThread]: Command `dbt run` succeeded at 15:15:25.194147 after 10.67 seconds
[0m15:15:25.194147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFD35C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBAA466370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBAA556940>]}
[0m15:15:25.194147 [debug] [MainThread]: Flushing usage events
[0m15:17:25.865859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C96D605E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9B0FD070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9B0FD0A0>]}


============================== 15:17:25.865859 | 7810afbc-ffec-44db-ade8-d9624eb77ec1 ==============================
[0m15:17:25.865859 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:17:25.865859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customer_tier', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:17:26.889072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7810afbc-ffec-44db-ade8-d9624eb77ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9B0C7460>]}
[0m15:17:26.889072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7810afbc-ffec-44db-ade8-d9624eb77ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC3BFC6D0>]}
[0m15:17:26.904807 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m15:17:26.922989 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:17:27.173492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:27.173492 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer_tier.yml
[0m15:17:27.204715 [debug] [MainThread]: Setting Default Schema: dev
[0m15:17:27.236510 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:17:27.236510 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:17:27.236510 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:17:27.252048 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:17:27.268648 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:17:27.268648 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:17:27.280720 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m15:17:27.280720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7810afbc-ffec-44db-ade8-d9624eb77ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC3FA5FD0>]}
[0m15:17:27.355853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7810afbc-ffec-44db-ade8-d9624eb77ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC3BED2E0>]}
[0m15:17:27.355853 [info ] [MainThread]: Found 12 models, 1 snapshot, 11 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m15:17:27.355853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7810afbc-ffec-44db-ade8-d9624eb77ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC3BED5E0>]}
[0m15:17:27.359788 [info ] [MainThread]: 
[0m15:17:27.359788 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:17:27.359788 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:17:27.372306 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:17:27.372306 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:17:27.372306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:28.680606 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:17:28.694587 [debug] [ThreadPool]: On list_DEV: Close
[0m15:17:28.775287 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_STAGING'
[0m15:17:28.790854 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m15:17:28.790854 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m15:17:28.806486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:29.816812 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m15:17:29.816812 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m15:17:29.911841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_CURATED)
[0m15:17:29.927235 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m15:17:29.927235 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m15:17:29.927235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:30.829531 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:17:30.829531 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m15:17:30.927116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_SNAPSHOT)
[0m15:17:30.927116 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m15:17:30.927116 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m15:17:30.927116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:31.749355 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:17:31.752866 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m15:17:31.833126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7810afbc-ffec-44db-ade8-d9624eb77ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9B102460>]}
[0m15:17:31.833126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:31.845640 [info ] [MainThread]: 
[0m15:17:31.853195 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m15:17:31.854340 [info ] [Thread-1  ]: 1 of 1 START sql table model CURATED.dim_customer_tier ......................... [RUN]
[0m15:17:31.855948 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer_tier'
[0m15:17:31.858063 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m15:17:31.867153 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m15:17:31.867153 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 15:17:31.858063 => 15:17:31.867153
[0m15:17:31.867153 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m15:17:31.899291 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m15:17:31.899291 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m15:17:31.899291 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer_tier"} */
create or replace transient table DEV.CURATED.dim_customer_tier
         as
        (with snp_customer_customer_type as (
    select *
    from DEV.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from DEV.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
        );
[0m15:17:31.899291 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:17:33.904931 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:17:33.952208 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 15:17:31.867153 => 15:17:33.952208
[0m15:17:33.952208 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m15:17:34.052539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7810afbc-ffec-44db-ade8-d9624eb77ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC43109D0>]}
[0m15:17:34.063170 [info ] [Thread-1  ]: 1 of 1 OK created sql table model CURATED.dim_customer_tier .................... [[32mSUCCESS 1[0m in 2.20s]
[0m15:17:34.063170 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m15:17:34.070735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:34.070735 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m15:17:34.070735 [debug] [MainThread]: Connection 'list_DEV_SNAPSHOT' was properly closed.
[0m15:17:34.070735 [debug] [MainThread]: Connection 'model.northwind.dim_customer_tier' was properly closed.
[0m15:17:34.070735 [info ] [MainThread]: 
[0m15:17:34.070735 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m15:17:34.082105 [debug] [MainThread]: Command end result
[0m15:17:34.096978 [info ] [MainThread]: 
[0m15:17:34.096978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:34.099391 [info ] [MainThread]: 
[0m15:17:34.099391 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:17:34.101823 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:34.101823 after 8.26 seconds
[0m15:17:34.101823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C96D605E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9A7A3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9B17A130>]}
[0m15:17:34.101823 [debug] [MainThread]: Flushing usage events
[0m15:20:36.205079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C156AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C19A07FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C19A07FD0>]}


============================== 15:20:36.211224 | 92db2529-6f5d-4918-894a-82579ca22aa5 ==============================
[0m15:20:36.211224 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:20:36.211224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_customer_tier', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:37.325283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92db2529-6f5d-4918-894a-82579ca22aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C19A07F70>]}
[0m15:20:37.337485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92db2529-6f5d-4918-894a-82579ca22aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C42550400>]}
[0m15:20:37.342557 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m15:20:37.365777 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:20:37.579935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:20:37.579935 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_product.yml
[0m15:20:37.579935 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_supplier.yml
[0m15:20:37.579935 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer.yml
[0m15:20:37.619643 [debug] [MainThread]: Setting Default Schema: dev
[0m15:20:37.635855 [debug] [MainThread]: Setting Default Schema: dev
[0m15:20:37.635855 [debug] [MainThread]: Setting Default Schema: dev
[0m15:20:37.661181 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:20:37.670479 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:20:37.670479 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:20:37.670479 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:20:37.684492 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:20:37.684492 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:20:37.692706 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m15:20:37.693762 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:20:37.693762 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m15:20:37.705219 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m15:20:37.769862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92db2529-6f5d-4918-894a-82579ca22aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4253C7C0>]}
[0m15:20:37.788146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92db2529-6f5d-4918-894a-82579ca22aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4281E6A0>]}
[0m15:20:37.789275 [info ] [MainThread]: Found 12 models, 1 snapshot, 11 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m15:20:37.790448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92db2529-6f5d-4918-894a-82579ca22aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4281E370>]}
[0m15:20:37.792053 [info ] [MainThread]: 
[0m15:20:37.792053 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:20:37.796521 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m15:20:37.811179 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m15:20:37.811948 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m15:20:37.812454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:39.133210 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:20:39.133210 [debug] [ThreadPool]: On list_DEV: Close
[0m15:20:39.222895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_CURATED'
[0m15:20:39.233415 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m15:20:39.236866 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m15:20:39.238800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:40.176129 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:20:40.179773 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m15:20:40.258255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_STAGING)
[0m15:20:40.261734 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m15:20:40.261734 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m15:20:40.261734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:41.031132 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m15:20:41.038268 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m15:20:41.121428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_SNAPSHOT)
[0m15:20:41.121428 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m15:20:41.136998 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m15:20:41.137875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:41.908060 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:20:41.908060 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m15:20:41.999701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92db2529-6f5d-4918-894a-82579ca22aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C42936BB0>]}
[0m15:20:41.999701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:41.999701 [info ] [MainThread]: 
[0m15:20:42.017639 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m15:20:42.017639 [info ] [Thread-1  ]: 1 of 1 START sql table model CURATED.dim_customer_tier ......................... [RUN]
[0m15:20:42.023651 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer_tier'
[0m15:20:42.025087 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m15:20:42.028514 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m15:20:42.028514 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 15:20:42.025790 => 15:20:42.028514
[0m15:20:42.028514 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m15:20:42.063593 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m15:20:42.071745 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m15:20:42.071745 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer_tier"} */
create or replace transient table DEV.CURATED.dim_customer_tier
         as
        (with snp_customer_customer_type as (
    select *
    from DEV.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from DEV.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
        );
[0m15:20:42.071745 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:20:43.943686 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:20:43.963304 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 15:20:42.039528 => 15:20:43.963304
[0m15:20:43.963304 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m15:20:44.064567 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92db2529-6f5d-4918-894a-82579ca22aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C42C85130>]}
[0m15:20:44.064567 [info ] [Thread-1  ]: 1 of 1 OK created sql table model CURATED.dim_customer_tier .................... [[32mSUCCESS 1[0m in 2.04s]
[0m15:20:44.064567 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m15:20:44.073080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:44.073080 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m15:20:44.078924 [debug] [MainThread]: Connection 'list_DEV_SNAPSHOT' was properly closed.
[0m15:20:44.078924 [debug] [MainThread]: Connection 'model.northwind.dim_customer_tier' was properly closed.
[0m15:20:44.078924 [info ] [MainThread]: 
[0m15:20:44.083213 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.29 seconds (6.29s).
[0m15:20:44.083213 [debug] [MainThread]: Command end result
[0m15:20:44.098602 [info ] [MainThread]: 
[0m15:20:44.098602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:44.098602 [info ] [MainThread]: 
[0m15:20:44.106574 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:20:44.106574 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:44.106574 after 7.92 seconds
[0m15:20:44.106574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C156AC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C42550400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C42DC1FD0>]}
[0m15:20:44.106574 [debug] [MainThread]: Flushing usage events
[0m12:45:52.859735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13D43C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C141797FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C141797F70>]}


============================== 12:45:52.859735 | 78f37f53-cbdd-4bc7-869c-90cee56d3eb7 ==============================
[0m12:45:52.859735 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:45:52.859735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:54.167848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78f37f53-cbdd-4bc7-869c-90cee56d3eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C141797F10>]}
[0m12:45:54.167848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78f37f53-cbdd-4bc7-869c-90cee56d3eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C16A2B19A0>]}
[0m12:45:54.167848 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m12:45:54.200626 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:45:54.726043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 7 files changed.
[0m12:45:54.726043 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\fact_order.sql
[0m12:45:54.726960 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer_tier.yml
[0m12:45:54.726960 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer.sql
[0m12:45:54.727992 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_supplier.sql
[0m12:45:54.727992 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_product.sql
[0m12:45:54.728914 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_order.sql
[0m12:45:54.728914 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer_tier.sql
[0m12:45:54.730122 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_order_detail.sql
[0m12:45:54.752014 [debug] [MainThread]: Setting Default Schema: dev
[0m12:45:54.767737 [debug] [MainThread]: Setting Default Schema: dev
[0m12:45:54.767737 [debug] [MainThread]: Setting Default Schema: dev
[0m12:45:54.767737 [debug] [MainThread]: Setting Default Schema: dev
[0m12:45:54.767737 [debug] [MainThread]: Setting Default Schema: dev
[0m12:45:54.785380 [debug] [MainThread]: Setting Default Schema: dev
[0m12:45:54.787417 [debug] [MainThread]: Setting Default Schema: dev
[0m12:45:54.801927 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m12:45:54.801927 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:45:54.801927 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:45:54.817580 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:45:54.817580 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:45:54.817580 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:45:54.817580 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m12:45:54.817580 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:45:54.817580 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:45:54.833205 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m12:45:54.833205 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:45:54.836345 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:45:54.836345 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m12:45:54.881551 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:45:54.883569 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:45:54.885908 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m12:45:54.887931 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m12:45:54.888909 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.northwind.fact_order' (models\serving\fact_order.sql) depends on a node named 'stg_salesorderdetail' which was not found
[0m12:45:54.891776 [debug] [MainThread]: Command `dbt run` failed at 12:45:54.891776 after 2.06 seconds
[0m12:45:54.891776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13D43C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C16A667D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C16A66B1C0>]}
[0m12:45:54.892776 [debug] [MainThread]: Flushing usage events
[0m12:46:22.076034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0B569C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0B99F7FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0B99F7F70>]}


============================== 12:46:22.076034 | a0cc3b9a-642c-4188-af81-f744d862c62e ==============================
[0m12:46:22.076034 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:46:22.076034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:46:22.758699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0B99F7F10>]}
[0m12:46:22.758699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E25119A0>]}
[0m12:46:22.774313 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m12:46:22.774313 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:46:22.895543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 7 files changed.
[0m12:46:22.896556 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\fact_order.sql
[0m12:46:22.897670 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer_tier.yml
[0m12:46:22.897670 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_order.sql
[0m12:46:22.897670 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer_tier.sql
[0m12:46:22.897670 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer.sql
[0m12:46:22.897670 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_product.sql
[0m12:46:22.897670 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_supplier.sql
[0m12:46:22.897670 [debug] [MainThread]: Partial parsing: updated file: northwind://models\staging\stg_order_detail.sql
[0m12:46:22.929097 [debug] [MainThread]: Setting Default Schema: dev
[0m12:46:22.929097 [debug] [MainThread]: Setting Default Schema: dev
[0m12:46:22.929097 [debug] [MainThread]: Setting Default Schema: dev
[0m12:46:22.944732 [debug] [MainThread]: Setting Default Schema: dev
[0m12:46:22.944732 [debug] [MainThread]: Setting Default Schema: dev
[0m12:46:22.944732 [debug] [MainThread]: Setting Default Schema: dev
[0m12:46:22.944732 [debug] [MainThread]: Setting Default Schema: dev
[0m12:46:22.960358 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m12:46:22.975981 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:46:22.975981 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:46:22.975981 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:46:22.991610 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:46:22.991610 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:46:22.991610 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m12:46:22.991610 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m12:46:22.991610 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:46:23.003221 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:46:23.007850 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m12:46:23.007850 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:46:23.007850 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:46:23.039230 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m12:46:23.039230 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:46:23.039230 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m12:46:23.039230 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m12:46:23.054845 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m12:46:23.054845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E2863100>]}
[0m12:46:23.076035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E2712670>]}
[0m12:46:23.080009 [info ] [MainThread]: Found 13 models, 1 snapshot, 11 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m12:46:23.081017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E27124C0>]}
[0m12:46:23.083019 [info ] [MainThread]: 
[0m12:46:23.084106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:46:23.084106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m12:46:23.084106 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m12:46:23.084106 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m12:46:23.084106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:24.741927 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:46:24.741927 [debug] [ThreadPool]: On list_DEV: Close
[0m12:46:24.868634 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m12:46:24.868634 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m12:46:24.875399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:26.239222 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:46:26.239222 [debug] [ThreadPool]: On list_DEV: Close
[0m12:46:26.317540 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m12:46:26.317540 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m12:46:26.317540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:27.111314 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:46:27.111314 [debug] [ThreadPool]: On list_DEV: Close
[0m12:46:27.185508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV, now create_DEV_dev)
[0m12:46:27.200965 [debug] [ThreadPool]: Creating schema "database: "DEV"
schema: "dev"
"
[0m12:46:27.200965 [debug] [ThreadPool]: Using snowflake connection "create_DEV_dev"
[0m12:46:27.200965 [debug] [ThreadPool]: On create_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "create_DEV_dev"} */
create schema if not exists DEV.dev
[0m12:46:27.200965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:28.890904 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:46:28.890904 [debug] [ThreadPool]: On create_DEV_dev: Close
[0m12:46:29.058072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_SNAPSHOT'
[0m12:46:29.073675 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m12:46:29.073675 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m12:46:29.073675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:29.939001 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:29.939001 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m12:46:30.060060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_CURATED)
[0m12:46:30.060060 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m12:46:30.060060 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m12:46:30.060060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:31.119313 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:31.119313 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m12:46:31.203997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_STAGING)
[0m12:46:31.203997 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m12:46:31.203997 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m12:46:31.203997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:32.382517 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m12:46:32.382517 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m12:46:32.476788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_dev)
[0m12:46:32.492406 [debug] [ThreadPool]: Using snowflake connection "list_DEV_dev"
[0m12:46:32.492406 [debug] [ThreadPool]: On list_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_dev"} */
show terse objects in DEV.dev limit 10000
[0m12:46:32.492406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:33.300083 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m12:46:33.300083 [debug] [ThreadPool]: On list_DEV_dev: Close
[0m12:46:33.394414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E2712040>]}
[0m12:46:33.394414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:33.394414 [info ] [MainThread]: 
[0m12:46:33.411701 [debug] [Thread-1  ]: Began running node model.northwind.stg_category
[0m12:46:33.412717 [info ] [Thread-1  ]: 1 of 13 START sql table model STAGING.stg_category ............................. [RUN]
[0m12:46:33.413719 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_category'
[0m12:46:33.414714 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_category
[0m12:46:33.423780 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_category"
[0m12:46:33.423780 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (compile): 12:46:33.414714 => 12:46:33.423780
[0m12:46:33.423780 [debug] [Thread-1  ]: Began executing node model.northwind.stg_category
[0m12:46:33.457007 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_category"
[0m12:46:33.459911 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_category"
[0m12:46:33.459911 [debug] [Thread-1  ]: On model.northwind.stg_category: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_category"} */
create or replace transient table DEV.STAGING.stg_category
         as
        (
select category_id,
category_name,
description
from airbyte_database.airbyte_schema.categories
        );
[0m12:46:33.459911 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:46:35.960570 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:46:35.976026 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (execute): 12:46:33.423780 => 12:46:35.976026
[0m12:46:35.976026 [debug] [Thread-1  ]: On model.northwind.stg_category: Close
[0m12:46:36.070515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E2FCA580>]}
[0m12:46:36.070515 [info ] [Thread-1  ]: 1 of 13 OK created sql table model STAGING.stg_category ........................ [[32mSUCCESS 1[0m in 2.66s]
[0m12:46:36.070515 [debug] [Thread-1  ]: Finished running node model.northwind.stg_category
[0m12:46:36.070515 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m12:46:36.070515 [info ] [Thread-1  ]: 2 of 13 START sql table model STAGING.stg_customer ............................. [RUN]
[0m12:46:36.070515 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_category, now model.northwind.stg_customer)
[0m12:46:36.070515 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m12:46:36.086242 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m12:46:36.087322 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 12:46:36.070515 => 12:46:36.087322
[0m12:46:36.087322 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m12:46:36.090437 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m12:46:36.090437 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m12:46:36.090437 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_customer"} */
create or replace transient table DEV.STAGING.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m12:46:36.090437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:38.118252 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:46:38.122257 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 12:46:36.088329 => 12:46:38.122071
[0m12:46:38.122784 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m12:46:38.190960 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E30738E0>]}
[0m12:46:38.206530 [info ] [Thread-1  ]: 2 of 13 OK created sql table model STAGING.stg_customer ........................ [[32mSUCCESS 1[0m in 2.12s]
[0m12:46:38.206530 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m12:46:38.206530 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_customer_type
[0m12:46:38.206530 [info ] [Thread-1  ]: 3 of 13 START sql table model STAGING.stg_customer_customer_type ............... [RUN]
[0m12:46:38.206530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer, now model.northwind.stg_customer_customer_type)
[0m12:46:38.206530 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_customer_type
[0m12:46:38.206530 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_customer_type"
[0m12:46:38.206530 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (compile): 12:46:38.206530 => 12:46:38.206530
[0m12:46:38.206530 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_customer_type
[0m12:46:38.206530 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_customer_type"
[0m12:46:38.206530 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_customer_type"
[0m12:46:38.206530 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_customer_customer_type"} */
create or replace transient table DEV.STAGING.stg_customer_customer_type
         as
        (
select customer_id,
customer_type_id
from airbyte_database.airbyte_schema.customer_customer_type
        );
[0m12:46:38.206530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:39.948941 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:46:39.948941 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (execute): 12:46:38.206530 => 12:46:39.948941
[0m12:46:39.948941 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: Close
[0m12:46:40.019424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E30C4AF0>]}
[0m12:46:40.019424 [info ] [Thread-1  ]: 3 of 13 OK created sql table model STAGING.stg_customer_customer_type .......... [[32mSUCCESS 1[0m in 1.81s]
[0m12:46:40.034887 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_customer_type
[0m12:46:40.035894 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_type
[0m12:46:40.036896 [info ] [Thread-1  ]: 4 of 13 START sql table model STAGING.stg_customer_type ........................ [RUN]
[0m12:46:40.037895 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_customer_type, now model.northwind.stg_customer_type)
[0m12:46:40.038925 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_type
[0m12:46:40.041490 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_type"
[0m12:46:40.042490 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (compile): 12:46:40.038925 => 12:46:40.042490
[0m12:46:40.043472 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_type
[0m12:46:40.045491 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_type"
[0m12:46:40.046995 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_type"
[0m12:46:40.048003 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_customer_type"} */
create or replace transient table DEV.STAGING.stg_customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m12:46:40.048003 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:41.593449 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:46:41.593449 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (execute): 12:46:40.043472 => 12:46:41.593449
[0m12:46:41.593449 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: Close
[0m12:46:41.672072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E30C8370>]}
[0m12:46:41.672072 [info ] [Thread-1  ]: 4 of 13 OK created sql table model STAGING.stg_customer_type ................... [[32mSUCCESS 1[0m in 1.63s]
[0m12:46:41.672072 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_type
[0m12:46:41.672072 [debug] [Thread-1  ]: Began running node model.northwind.stg_order
[0m12:46:41.672072 [info ] [Thread-1  ]: 5 of 13 START sql table model STAGING.stg_order ................................ [RUN]
[0m12:46:41.672072 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_type, now model.northwind.stg_order)
[0m12:46:41.672072 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order
[0m12:46:41.687651 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order"
[0m12:46:41.687651 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (compile): 12:46:41.672072 => 12:46:41.687651
[0m12:46:41.689494 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order
[0m12:46:41.691612 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order"
[0m12:46:41.692968 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order"
[0m12:46:41.692968 [debug] [Thread-1  ]: On model.northwind.stg_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_order"} */
create or replace transient table DEV.STAGING.stg_order
         as
        (
select order_id,
customer_id,
ship_city,
ship_postal_code,
required_date,
freight,
ship_region,
order_date,
shipped_date,
ship_via,
ship_address,
ship_name,
ship_country,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.orders
where _ab_cdc_deleted_at is null
        );
[0m12:46:41.692968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:43.032307 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:43.032307 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (execute): 12:46:41.689494 => 12:46:43.032307
[0m12:46:43.032307 [debug] [Thread-1  ]: On model.northwind.stg_order: Close
[0m12:46:43.110913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E30E1670>]}
[0m12:46:43.110913 [info ] [Thread-1  ]: 5 of 13 OK created sql table model STAGING.stg_order ........................... [[32mSUCCESS 1[0m in 1.44s]
[0m12:46:43.110913 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order
[0m12:46:43.110913 [debug] [Thread-1  ]: Began running node model.northwind.stg_order_detail
[0m12:46:43.126423 [info ] [Thread-1  ]: 6 of 13 START sql table model STAGING.stg_order_detail ......................... [RUN]
[0m12:46:43.126423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order, now model.northwind.stg_order_detail)
[0m12:46:43.126423 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order_detail
[0m12:46:43.126423 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order_detail"
[0m12:46:43.126423 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (compile): 12:46:43.126423 => 12:46:43.126423
[0m12:46:43.126423 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order_detail
[0m12:46:43.126423 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order_detail"
[0m12:46:43.126423 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order_detail"
[0m12:46:43.126423 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_order_detail"} */
create or replace transient table DEV.STAGING.stg_order_detail
         as
        (
select order_id,
product_id,
unit_price,
quantity,
discount,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.order_details
        );
[0m12:46:43.126423 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:44.294668 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:44.310120 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (execute): 12:46:43.126423 => 12:46:44.294668
[0m12:46:44.310120 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: Close
[0m12:46:44.373309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E309CF70>]}
[0m12:46:44.373309 [info ] [Thread-1  ]: 6 of 13 OK created sql table model STAGING.stg_order_detail .................... [[32mSUCCESS 1[0m in 1.25s]
[0m12:46:44.373309 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order_detail
[0m12:46:44.373309 [debug] [Thread-1  ]: Began running node model.northwind.stg_product
[0m12:46:44.373309 [info ] [Thread-1  ]: 7 of 13 START sql table model STAGING.stg_product .............................. [RUN]
[0m12:46:44.389679 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order_detail, now model.northwind.stg_product)
[0m12:46:44.389679 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_product
[0m12:46:44.390626 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_product"
[0m12:46:44.390626 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (compile): 12:46:44.390626 => 12:46:44.390626
[0m12:46:44.390626 [debug] [Thread-1  ]: Began executing node model.northwind.stg_product
[0m12:46:44.390626 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_product"
[0m12:46:44.390626 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_product"
[0m12:46:44.390626 [debug] [Thread-1  ]: On model.northwind.stg_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_product"} */
create or replace transient table DEV.STAGING.stg_product
         as
        (
select product_id,
product_name,
unit_price,
reorder_level,
discontinued,
category_id,
units_in_stock,
units_on_order,
quantity_per_unit,
supplier_id
from airbyte_database.airbyte_schema.products
        );
[0m12:46:44.390626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:45.791098 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:45.791098 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (execute): 12:46:44.390626 => 12:46:45.791098
[0m12:46:45.791098 [debug] [Thread-1  ]: On model.northwind.stg_product: Close
[0m12:46:45.869587 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E309CF70>]}
[0m12:46:45.885323 [info ] [Thread-1  ]: 7 of 13 OK created sql table model STAGING.stg_product ......................... [[32mSUCCESS 1[0m in 1.48s]
[0m12:46:45.885323 [debug] [Thread-1  ]: Finished running node model.northwind.stg_product
[0m12:46:45.885323 [debug] [Thread-1  ]: Began running node model.northwind.stg_supplier
[0m12:46:45.885323 [info ] [Thread-1  ]: 8 of 13 START sql table model STAGING.stg_supplier ............................. [RUN]
[0m12:46:45.885323 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_product, now model.northwind.stg_supplier)
[0m12:46:45.885323 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_supplier
[0m12:46:45.885323 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_supplier"
[0m12:46:45.885323 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (compile): 12:46:45.885323 => 12:46:45.885323
[0m12:46:45.885323 [debug] [Thread-1  ]: Began executing node model.northwind.stg_supplier
[0m12:46:45.885323 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_supplier"
[0m12:46:45.885323 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_supplier"
[0m12:46:45.885323 [debug] [Thread-1  ]: On model.northwind.stg_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.stg_supplier"} */
create or replace transient table DEV.STAGING.stg_supplier
         as
        (
select supplier_id,
country,
contact_name,
address,
city,
phone,
company_name,
fax,
region,
postal_code,
contact_title
from airbyte_database.airbyte_schema.suppliers
        );
[0m12:46:45.900951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:47.231934 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:47.231934 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (execute): 12:46:45.885323 => 12:46:47.231934
[0m12:46:47.231934 [debug] [Thread-1  ]: On model.northwind.stg_supplier: Close
[0m12:46:47.325968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0B8CDADF0>]}
[0m12:46:47.325968 [info ] [Thread-1  ]: 8 of 13 OK created sql table model STAGING.stg_supplier ........................ [[32mSUCCESS 1[0m in 1.44s]
[0m12:46:47.325968 [debug] [Thread-1  ]: Finished running node model.northwind.stg_supplier
[0m12:46:47.341514 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m12:46:47.341514 [info ] [Thread-1  ]: 9 of 13 START sql table model CURATED.dim_customer ............................. [RUN]
[0m12:46:47.341514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_supplier, now model.northwind.dim_customer)
[0m12:46:47.341514 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m12:46:47.341514 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer"
[0m12:46:47.341514 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 12:46:47.341514 => 12:46:47.341514
[0m12:46:47.341514 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer
[0m12:46:47.355135 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer"
[0m12:46:47.355135 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer"
[0m12:46:47.357748 [debug] [Thread-1  ]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table DEV.CURATED.dim_customer
         as
        (with stg_customer as (
    select customer_id,
    company_name,
    contact_name,
    contact_title,
    address,
    city,
    region,
    postal_code,
    country,
    phone,
    fax
    from DEV.STAGING.stg_customer
)

select
    
    
md5(cast(coalesce(cast(stg_customer.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_customer.customer_id,
    stg_customer.company_name,
    stg_customer.contact_name,
    stg_customer.contact_title,
    stg_customer.address,
    stg_customer.city,
    stg_customer.region,
    stg_customer.postal_code,
    stg_customer.country,
    stg_customer.phone
from stg_customer
        );
[0m12:46:47.357748 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:48.860023 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:46:48.860023 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (execute): 12:46:47.341514 => 12:46:48.860023
[0m12:46:48.874056 [debug] [Thread-1  ]: On model.northwind.dim_customer: Close
[0m12:46:48.952026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E3130250>]}
[0m12:46:48.952026 [info ] [Thread-1  ]: 9 of 13 OK created sql table model CURATED.dim_customer ........................ [[32mSUCCESS 1[0m in 1.61s]
[0m12:46:48.952026 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m12:46:48.952026 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m12:46:48.960141 [info ] [Thread-1  ]: 10 of 13 START sql table model CURATED.dim_customer_tier ....................... [RUN]
[0m12:46:48.960141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.dim_customer_tier)
[0m12:46:48.960141 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m12:46:48.960141 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m12:46:48.968149 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 12:46:48.960141 => 12:46:48.968149
[0m12:46:48.968149 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m12:46:48.971537 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m12:46:48.973572 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m12:46:48.973572 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer_tier"} */
create or replace transient table DEV.CURATED.dim_customer_tier
         as
        (with snp_customer_customer_type as (
    select customer_id,
    cast(customer_type_id as integer) as customer_type_id,
    dbt_valid_from,
    dbt_valid_to
    from DEV.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from DEV.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
        );
[0m12:46:48.973572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:50.915040 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:46:50.915040 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 12:46:48.969433 => 12:46:50.915040
[0m12:46:50.915040 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m12:46:50.993580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E311AF70>]}
[0m12:46:50.993580 [info ] [Thread-1  ]: 10 of 13 OK created sql table model CURATED.dim_customer_tier .................. [[32mSUCCESS 1[0m in 2.03s]
[0m12:46:50.993580 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m12:46:50.993580 [debug] [Thread-1  ]: Began running node model.northwind.dim_product
[0m12:46:50.993580 [info ] [Thread-1  ]: 11 of 13 START sql table model CURATED.dim_product ............................. [RUN]
[0m12:46:50.993580 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer_tier, now model.northwind.dim_product)
[0m12:46:50.993580 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_product
[0m12:46:51.012927 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_product"
[0m12:46:51.016221 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (compile): 12:46:50.993580 => 12:46:51.015208
[0m12:46:51.016221 [debug] [Thread-1  ]: Began executing node model.northwind.dim_product
[0m12:46:51.017474 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_product"
[0m12:46:51.017474 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_product"
[0m12:46:51.017474 [debug] [Thread-1  ]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table DEV.CURATED.dim_product
         as
        (with stg_product as (
    select cast(product_id as integer) as product_id,
    product_name,
    cast(unit_price as numeric(38,2)) as unit_price,
    cast(reorder_level as integer) as reorder_level,
    cast(discontinued as integer) as discontinued,
    cast(category_id as integer) as category_id,
    cast(units_in_stock as integer) as units_in_stock,
    cast(units_on_order as integer) as units_on_order,
    quantity_per_unit,
    cast(supplier_id as integer) as supplier_id
    from DEV.STAGING.stg_product
),

stg_category as(
    select cast(category_id as integer) as category_id,
    category_name,
    description
    from DEV.STAGING.stg_category
)

select
    
    
md5(cast(coalesce(cast(stg_product.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    stg_product.product_id,
    stg_product.product_name,
    stg_category.category_name,
    stg_product.reorder_level,
    stg_product.discontinued,
    stg_product.units_in_stock,
    stg_product.units_on_order,
    
    
md5(cast(coalesce(cast(stg_product.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key
from stg_product
left join stg_category on stg_product.category_id = stg_category.category_id
        );
[0m12:46:51.017474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:52.857466 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:46:52.857466 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (execute): 12:46:51.017474 => 12:46:52.857466
[0m12:46:52.869576 [debug] [Thread-1  ]: On model.northwind.dim_product: Close
[0m12:46:52.945846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E3144AF0>]}
[0m12:46:52.945846 [info ] [Thread-1  ]: 11 of 13 OK created sql table model CURATED.dim_product ........................ [[32mSUCCESS 1[0m in 1.95s]
[0m12:46:52.961371 [debug] [Thread-1  ]: Finished running node model.northwind.dim_product
[0m12:46:52.961371 [debug] [Thread-1  ]: Began running node model.northwind.dim_supplier
[0m12:46:52.961371 [info ] [Thread-1  ]: 12 of 13 START sql table model CURATED.dim_supplier ............................ [RUN]
[0m12:46:52.961371 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now model.northwind.dim_supplier)
[0m12:46:52.961371 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_supplier
[0m12:46:52.961371 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_supplier"
[0m12:46:52.969885 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (compile): 12:46:52.961371 => 12:46:52.969885
[0m12:46:52.969885 [debug] [Thread-1  ]: Began executing node model.northwind.dim_supplier
[0m12:46:52.969885 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_supplier"
[0m12:46:52.969885 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_supplier"
[0m12:46:52.969885 [debug] [Thread-1  ]: On model.northwind.dim_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_supplier"} */
create or replace transient table DEV.CURATED.dim_supplier
         as
        (with stg_supplier as (
    select cast(supplier_id as integer) as supplier_id,
    country,
    contact_name,
    address,
    city,
    phone,
    company_name,
    fax,
    region,
    postal_code,
    contact_title
    from DEV.STAGING.stg_supplier
)

select
    
    
md5(cast(coalesce(cast(stg_supplier.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key,
    stg_supplier.supplier_id,
    stg_supplier.company_name,
    stg_supplier.contact_name,
    stg_supplier.contact_title,
    stg_supplier.address,
    stg_supplier.city,
    stg_supplier.region,
    stg_supplier.postal_code,
    stg_supplier.country,
    stg_supplier.phone
    from stg_supplier
        );
[0m12:46:52.969885 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:54.246021 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:54.246021 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (execute): 12:46:52.969885 => 12:46:54.246021
[0m12:46:54.246021 [debug] [Thread-1  ]: On model.northwind.dim_supplier: Close
[0m12:46:54.324744 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E315A280>]}
[0m12:46:54.324744 [info ] [Thread-1  ]: 12 of 13 OK created sql table model CURATED.dim_supplier ....................... [[32mSUCCESS 1[0m in 1.36s]
[0m12:46:54.324744 [debug] [Thread-1  ]: Finished running node model.northwind.dim_supplier
[0m12:46:54.324744 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m12:46:54.324744 [info ] [Thread-1  ]: 13 of 13 START sql incremental model dev.fact_order ............................ [RUN]
[0m12:46:54.324744 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_supplier, now model.northwind.fact_order)
[0m12:46:54.324744 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m12:46:54.344549 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m12:46:54.345529 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 12:46:54.324744 => 12:46:54.345529
[0m12:46:54.345982 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m12:46:54.372410 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m12:46:54.373436 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m12:46:54.373436 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
create or replace transient table DEV.dev.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        timestamp(_ab_cdc_updated_at) as updated_at
    from DEV.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2) as discount,
        timestamp(_ab_cdc_updated_at) as updated_at
    from DEV.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from DEV.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount_value > 0 then 'Discounted' else 'Regular' as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(<day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, '2999-01-01'::timestamp) 


        );
[0m12:46:54.373436 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:55.074051 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b064ea-3200-f5b9-0004-6e520002201e
[0m12:46:55.074051 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 28 at position 41 unexpected 'as'.
syntax error line 30 at position 39 unexpected 'as'.
syntax error line 64 at position 83 unexpected 'as'.
syntax error line 68 at position 13 unexpected '<'.
syntax error line 68 at position 12 unexpected '('.
syntax error line 72 at position 31 unexpected 'stg_order'.
[0m12:46:55.074051 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 12:46:54.345982 => 12:46:55.074051
[0m12:46:55.074051 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m12:46:55.164745 [debug] [Thread-1  ]: Database Error in model fact_order (models\serving\fact_order.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 41 unexpected 'as'.
  syntax error line 30 at position 39 unexpected 'as'.
  syntax error line 64 at position 83 unexpected 'as'.
  syntax error line 68 at position 13 unexpected '<'.
  syntax error line 68 at position 12 unexpected '('.
  syntax error line 72 at position 31 unexpected 'stg_order'.
  compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m12:46:55.164745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0cc3b9a-642c-4188-af81-f744d862c62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E309EDC0>]}
[0m12:46:55.164745 [error] [Thread-1  ]: 13 of 13 ERROR creating sql incremental model dev.fact_order ................... [[31mERROR[0m in 0.84s]
[0m12:46:55.164745 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m12:46:55.174251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:55.174251 [debug] [MainThread]: Connection 'create_DEV_dev' was properly closed.
[0m12:46:55.174251 [debug] [MainThread]: Connection 'list_DEV_dev' was properly closed.
[0m12:46:55.174251 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m12:46:55.174251 [info ] [MainThread]: 
[0m12:46:55.174251 [info ] [MainThread]: Finished running 12 table models, 1 incremental model in 0 hours 0 minutes and 32.09 seconds (32.09s).
[0m12:46:55.178940 [debug] [MainThread]: Command end result
[0m12:46:55.189941 [info ] [MainThread]: 
[0m12:46:55.190941 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:46:55.191943 [info ] [MainThread]: 
[0m12:46:55.192939 [error] [MainThread]: [33mDatabase Error in model fact_order (models\serving\fact_order.sql)[0m
[0m12:46:55.193303 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:46:55.193303 [error] [MainThread]:   syntax error line 28 at position 41 unexpected 'as'.
[0m12:46:55.194311 [error] [MainThread]:   syntax error line 30 at position 39 unexpected 'as'.
[0m12:46:55.195310 [error] [MainThread]:   syntax error line 64 at position 83 unexpected 'as'.
[0m12:46:55.195310 [error] [MainThread]:   syntax error line 68 at position 13 unexpected '<'.
[0m12:46:55.196485 [error] [MainThread]:   syntax error line 68 at position 12 unexpected '('.
[0m12:46:55.197485 [error] [MainThread]:   syntax error line 72 at position 31 unexpected 'stg_order'.
[0m12:46:55.198494 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m12:46:55.198494 [info ] [MainThread]: 
[0m12:46:55.199487 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m12:46:55.200539 [debug] [MainThread]: Command `dbt run` failed at 12:46:55.200539 after 33.13 seconds
[0m12:46:55.200539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0B569C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E2FA2220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0E2FA2100>]}
[0m12:46:55.200539 [debug] [MainThread]: Flushing usage events
[0m12:52:34.427752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4437905E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C447AC7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C447AFD070>]}


============================== 12:52:34.427752 | 75cf2dba-2dae-4a79-8fa7-f75dbe3846e3 ==============================
[0m12:52:34.427752 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:52:34.427752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_order', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:35.088428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75cf2dba-2dae-4a79-8fa7-f75dbe3846e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C447AC7C70>]}
[0m12:52:35.104061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75cf2dba-2dae-4a79-8fa7-f75dbe3846e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C47066D100>]}
[0m12:52:35.104061 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m12:52:35.123945 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:52:35.231072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:52:35.231072 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\fact_order.sql
[0m12:52:35.253831 [debug] [MainThread]: Setting Default Schema: dev
[0m12:52:35.269451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m12:52:35.269451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75cf2dba-2dae-4a79-8fa7-f75dbe3846e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4709FDF10>]}
[0m12:52:35.289052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75cf2dba-2dae-4a79-8fa7-f75dbe3846e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4709168E0>]}
[0m12:52:35.290343 [info ] [MainThread]: Found 13 models, 1 snapshot, 11 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m12:52:35.290343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75cf2dba-2dae-4a79-8fa7-f75dbe3846e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C470916700>]}
[0m12:52:35.290343 [info ] [MainThread]: 
[0m12:52:35.290343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:52:35.290343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m12:52:35.304881 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m12:52:35.304881 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m12:52:35.304881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:36.403347 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:52:36.403643 [debug] [ThreadPool]: On list_DEV: Close
[0m12:52:36.491672 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_CURATED'
[0m12:52:36.491672 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m12:52:36.491672 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m12:52:36.491672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:37.067688 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:52:37.082584 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m12:52:37.161987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_dev)
[0m12:52:37.161987 [debug] [ThreadPool]: Using snowflake connection "list_DEV_dev"
[0m12:52:37.161987 [debug] [ThreadPool]: On list_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_dev"} */
show terse objects in DEV.dev limit 10000
[0m12:52:37.161987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:38.148329 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m12:52:38.150806 [debug] [ThreadPool]: On list_DEV_dev: Close
[0m12:52:38.238992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_dev, now list_DEV_SNAPSHOT)
[0m12:52:38.241405 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m12:52:38.241908 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m12:52:38.242460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:38.804599 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:52:38.820142 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m12:52:38.946328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_STAGING)
[0m12:52:38.946328 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m12:52:38.946328 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m12:52:38.946328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:39.585893 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m12:52:39.585893 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m12:52:39.680185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75cf2dba-2dae-4a79-8fa7-f75dbe3846e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C470D36790>]}
[0m12:52:39.680185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:39.680185 [info ] [MainThread]: 
[0m12:52:39.695647 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m12:52:39.695647 [info ] [Thread-1  ]: 1 of 1 START sql incremental model dev.fact_order .............................. [RUN]
[0m12:52:39.695647 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m12:52:39.699091 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m12:52:39.708107 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m12:52:39.709100 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 12:52:39.699091 => 12:52:39.709100
[0m12:52:39.710098 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m12:52:39.734405 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m12:52:39.749623 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m12:52:39.750778 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
create or replace transient table DEV.dev.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        timestamp(_ab_cdc_updated_at) as updated_at
    from DEV.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2) as discount,
        timestamp(_ab_cdc_updated_at) as updated_at
    from DEV.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from DEV.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount_value > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(<day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m12:52:39.750778 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:52:40.390561 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b064f0-3200-f55a-0004-6e52000230ce
[0m12:52:40.390561 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 28 at position 41 unexpected 'as'.
syntax error line 30 at position 39 unexpected 'as'.
syntax error line 68 at position 13 unexpected '<'.
syntax error line 68 at position 12 unexpected '('.
syntax error line 72 at position 31 unexpected 'stg_order'.
[0m12:52:40.390561 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 12:52:39.710098 => 12:52:40.390561
[0m12:52:40.390561 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m12:52:40.516259 [debug] [Thread-1  ]: Database Error in model fact_order (models\serving\fact_order.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 41 unexpected 'as'.
  syntax error line 30 at position 39 unexpected 'as'.
  syntax error line 68 at position 13 unexpected '<'.
  syntax error line 68 at position 12 unexpected '('.
  syntax error line 72 at position 31 unexpected 'stg_order'.
  compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m12:52:40.516259 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75cf2dba-2dae-4a79-8fa7-f75dbe3846e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C470DA2850>]}
[0m12:52:40.516259 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model dev.fact_order ..................... [[31mERROR[0m in 0.82s]
[0m12:52:40.516259 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m12:52:40.516259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:40.516259 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m12:52:40.516259 [debug] [MainThread]: Connection 'list_DEV_STAGING' was properly closed.
[0m12:52:40.516259 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m12:52:40.516259 [info ] [MainThread]: 
[0m12:52:40.516259 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m12:52:40.525442 [debug] [MainThread]: Command end result
[0m12:52:40.536415 [info ] [MainThread]: 
[0m12:52:40.537416 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:52:40.538416 [info ] [MainThread]: 
[0m12:52:40.538416 [error] [MainThread]: [33mDatabase Error in model fact_order (models\serving\fact_order.sql)[0m
[0m12:52:40.539415 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:52:40.539928 [error] [MainThread]:   syntax error line 28 at position 41 unexpected 'as'.
[0m12:52:40.539928 [error] [MainThread]:   syntax error line 30 at position 39 unexpected 'as'.
[0m12:52:40.541024 [error] [MainThread]:   syntax error line 68 at position 13 unexpected '<'.
[0m12:52:40.542043 [error] [MainThread]:   syntax error line 68 at position 12 unexpected '('.
[0m12:52:40.542043 [error] [MainThread]:   syntax error line 72 at position 31 unexpected 'stg_order'.
[0m12:52:40.543045 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m12:52:40.543045 [info ] [MainThread]: 
[0m12:52:40.544166 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:52:40.544166 [debug] [MainThread]: Command `dbt run` failed at 12:52:40.544166 after 6.13 seconds
[0m12:52:40.545171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4437905E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C47066D100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C470D93190>]}
[0m12:52:40.545171 [debug] [MainThread]: Flushing usage events
[0m12:57:34.141623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C63FC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204CA757FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204CA757FA0>]}


============================== 12:57:34.145640 | 9e9d78f3-3be8-4f10-9172-b88e411727ee ==============================
[0m12:57:34.145640 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:57:34.146098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_order', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:57:34.810177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e9d78f3-3be8-4f10-9172-b88e411727ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204CA757F40>]}
[0m12:57:34.810177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e9d78f3-3be8-4f10-9172-b88e411727ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F3284850>]}
[0m12:57:34.810177 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m12:57:34.828375 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:57:34.936554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:34.936554 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\fact_order.sql
[0m12:57:34.967399 [debug] [MainThread]: Setting Default Schema: dev
[0m12:57:34.983014 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m12:57:34.983014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e9d78f3-3be8-4f10-9172-b88e411727ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F365DE80>]}
[0m12:57:35.004871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e9d78f3-3be8-4f10-9172-b88e411727ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F35778B0>]}
[0m12:57:35.004871 [info ] [MainThread]: Found 13 models, 1 snapshot, 11 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m12:57:35.004871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e9d78f3-3be8-4f10-9172-b88e411727ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F3577640>]}
[0m12:57:35.004871 [info ] [MainThread]: 
[0m12:57:35.004871 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:57:35.004871 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m12:57:35.019996 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m12:57:35.019996 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m12:57:35.021002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:36.020756 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:57:36.022736 [debug] [ThreadPool]: On list_DEV: Close
[0m12:57:36.097950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_dev'
[0m12:57:36.104950 [debug] [ThreadPool]: Using snowflake connection "list_DEV_dev"
[0m12:57:36.104950 [debug] [ThreadPool]: On list_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_dev"} */
show terse objects in DEV.dev limit 10000
[0m12:57:36.105948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:36.938079 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m12:57:36.938079 [debug] [ThreadPool]: On list_DEV_dev: Close
[0m12:57:37.033793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_dev, now list_DEV_STAGING)
[0m12:57:37.036803 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m12:57:37.036803 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m12:57:37.037805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:37.766763 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m12:57:37.766763 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m12:57:37.852186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_SNAPSHOT)
[0m12:57:37.852186 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m12:57:37.852186 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m12:57:37.852186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:38.427571 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:38.429547 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m12:57:38.508999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_CURATED)
[0m12:57:38.511665 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m12:57:38.512341 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m12:57:38.512341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:39.155996 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:57:39.157373 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m12:57:39.267396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e9d78f3-3be8-4f10-9172-b88e411727ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F35775B0>]}
[0m12:57:39.267396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:39.267396 [info ] [MainThread]: 
[0m12:57:39.282829 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m12:57:39.282829 [info ] [Thread-1  ]: 1 of 1 START sql incremental model dev.fact_order .............................. [RUN]
[0m12:57:39.282829 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m12:57:39.285365 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m12:57:39.292778 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m12:57:39.292778 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 12:57:39.285365 => 12:57:39.292778
[0m12:57:39.292778 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m12:57:39.326125 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m12:57:39.340121 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m12:57:39.341218 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
create or replace transient table DEV.dev.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        timestamp(_ab_cdc_updated_at) as updated_at
    from DEV.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        timestamp(_ab_cdc_updated_at) as updated_at
    from DEV.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from DEV.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount_value > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(<day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m12:57:39.341218 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:57:40.024805 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b064f5-3200-f5b9-0004-6e520002209e
[0m12:57:40.024805 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 68 at position 13 unexpected '<'.
syntax error line 68 at position 12 unexpected '('.
syntax error line 72 at position 31 unexpected 'stg_order'.
[0m12:57:40.024805 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 12:57:39.292778 => 12:57:40.024805
[0m12:57:40.024805 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m12:57:40.118624 [debug] [Thread-1  ]: Database Error in model fact_order (models\serving\fact_order.sql)
  001003 (42000): SQL compilation error:
  syntax error line 68 at position 13 unexpected '<'.
  syntax error line 68 at position 12 unexpected '('.
  syntax error line 72 at position 31 unexpected 'stg_order'.
  compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m12:57:40.118624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9d78f3-3be8-4f10-9172-b88e411727ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F3A07370>]}
[0m12:57:40.118624 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model dev.fact_order ..................... [[31mERROR[0m in 0.84s]
[0m12:57:40.134169 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m12:57:40.134169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:40.134169 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m12:57:40.134169 [debug] [MainThread]: Connection 'list_DEV_CURATED' was properly closed.
[0m12:57:40.134169 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m12:57:40.134169 [info ] [MainThread]: 
[0m12:57:40.134169 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m12:57:40.140806 [debug] [MainThread]: Command end result
[0m12:57:40.146153 [info ] [MainThread]: 
[0m12:57:40.146153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:57:40.146153 [info ] [MainThread]: 
[0m12:57:40.146153 [error] [MainThread]: [33mDatabase Error in model fact_order (models\serving\fact_order.sql)[0m
[0m12:57:40.146153 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:57:40.146153 [error] [MainThread]:   syntax error line 68 at position 13 unexpected '<'.
[0m12:57:40.146153 [error] [MainThread]:   syntax error line 68 at position 12 unexpected '('.
[0m12:57:40.146153 [error] [MainThread]:   syntax error line 72 at position 31 unexpected 'stg_order'.
[0m12:57:40.146153 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m12:57:40.146153 [info ] [MainThread]: 
[0m12:57:40.146153 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:57:40.146153 [debug] [MainThread]: Command `dbt run` failed at 12:57:40.146153 after 6.03 seconds
[0m12:57:40.146153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204C63FC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F3284850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F39A5190>]}
[0m12:57:40.146153 [debug] [MainThread]: Flushing usage events
[0m12:58:12.986582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFC4D0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E80947FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E8097D040>]}


============================== 12:58:12.986582 | 818e6ed1-42b7-4037-80d3-145816ff0266 ==============================
[0m12:58:12.986582 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:58:12.986582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_order', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:58:13.635855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '818e6ed1-42b7-4037-80d3-145816ff0266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E80947FA0>]}
[0m12:58:13.651525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '818e6ed1-42b7-4037-80d3-145816ff0266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA9352F40>]}
[0m12:58:13.651525 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m12:58:13.668506 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:58:13.773660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:58:13.774668 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\fact_order.sql
[0m12:58:13.801500 [debug] [MainThread]: Setting Default Schema: dev
[0m12:58:13.801500 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m12:58:13.820526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '818e6ed1-42b7-4037-80d3-145816ff0266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA973DEE0>]}
[0m12:58:13.829096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '818e6ed1-42b7-4037-80d3-145816ff0266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA96568B0>]}
[0m12:58:13.829096 [info ] [MainThread]: Found 13 models, 1 snapshot, 11 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m12:58:13.834681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '818e6ed1-42b7-4037-80d3-145816ff0266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA96566D0>]}
[0m12:58:13.835689 [info ] [MainThread]: 
[0m12:58:13.836380 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:58:13.836380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m12:58:13.842923 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m12:58:13.842923 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m12:58:13.842923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:14.837673 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:58:14.837673 [debug] [ThreadPool]: On list_DEV: Close
[0m12:58:14.931982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_STAGING'
[0m12:58:14.931982 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m12:58:14.931982 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m12:58:14.931982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:15.755246 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m12:58:15.755246 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m12:58:15.856555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_SNAPSHOT)
[0m12:58:15.862817 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m12:58:15.863696 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m12:58:15.864283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:16.525586 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:16.537097 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m12:58:16.607462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_dev)
[0m12:58:16.625902 [debug] [ThreadPool]: Using snowflake connection "list_DEV_dev"
[0m12:58:16.625902 [debug] [ThreadPool]: On list_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_dev"} */
show terse objects in DEV.dev limit 10000
[0m12:58:16.625902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:17.225983 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m12:58:17.227501 [debug] [ThreadPool]: On list_DEV_dev: Close
[0m12:58:17.304957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_dev, now list_DEV_CURATED)
[0m12:58:17.304957 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m12:58:17.304957 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m12:58:17.304957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:17.921261 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:58:17.921261 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m12:58:18.020459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '818e6ed1-42b7-4037-80d3-145816ff0266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA9749F10>]}
[0m12:58:18.020459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:18.020459 [info ] [MainThread]: 
[0m12:58:18.031122 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m12:58:18.031122 [info ] [Thread-1  ]: 1 of 1 START sql incremental model dev.fact_order .............................. [RUN]
[0m12:58:18.031122 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m12:58:18.031122 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m12:58:18.040526 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m12:58:18.040526 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 12:58:18.034776 => 12:58:18.040526
[0m12:58:18.040526 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m12:58:18.075420 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m12:58:18.075420 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m12:58:18.075420 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
create or replace transient table DEV.dev.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        timestamp(_ab_cdc_updated_at) as updated_at
    from DEV.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        timestamp(_ab_cdc_updated_at) as updated_at
    from DEV.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from DEV.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount_value > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m12:58:18.075420 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:58:18.852267 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b064f6-3200-f55a-0004-6e52000230ea
[0m12:58:18.852267 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 18
invalid identifier '_AB_CDC_UPDATED_AT'
[0m12:58:18.852267 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 12:58:18.040526 => 12:58:18.852267
[0m12:58:18.852267 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m12:58:18.946270 [debug] [Thread-1  ]: Database Error in model fact_order (models\serving\fact_order.sql)
  000904 (42000): SQL compilation error: error line 20 at position 18
  invalid identifier '_AB_CDC_UPDATED_AT'
  compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m12:58:18.946270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '818e6ed1-42b7-4037-80d3-145816ff0266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA9C3A8B0>]}
[0m12:58:18.946270 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model dev.fact_order ..................... [[31mERROR[0m in 0.92s]
[0m12:58:18.946270 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m12:58:18.962014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:18.962014 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m12:58:18.962014 [debug] [MainThread]: Connection 'list_DEV_CURATED' was properly closed.
[0m12:58:18.962014 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m12:58:18.962014 [info ] [MainThread]: 
[0m12:58:18.962014 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m12:58:18.962014 [debug] [MainThread]: Command end result
[0m12:58:18.969522 [info ] [MainThread]: 
[0m12:58:18.969522 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:58:18.969522 [info ] [MainThread]: 
[0m12:58:18.969522 [error] [MainThread]: [33mDatabase Error in model fact_order (models\serving\fact_order.sql)[0m
[0m12:58:18.969522 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 20 at position 18
[0m12:58:18.969522 [error] [MainThread]:   invalid identifier '_AB_CDC_UPDATED_AT'
[0m12:58:18.969522 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m12:58:18.969522 [info ] [MainThread]: 
[0m12:58:18.981023 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:58:18.981023 [debug] [MainThread]: Command `dbt run` failed at 12:58:18.981023 after 6.00 seconds
[0m12:58:18.982101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFC4D0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA9352F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EA9A849A0>]}
[0m12:58:18.982101 [debug] [MainThread]: Flushing usage events
[0m12:58:53.510756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B52E22C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B532587FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B532587FA0>]}


============================== 12:58:53.514810 | 91b0a746-9259-428c-844a-95ca1ee6c5ad ==============================
[0m12:58:53.514810 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:58:53.514810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_order', 'send_anonymous_usage_stats': 'True'}
[0m12:58:54.159408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91b0a746-9259-428c-844a-95ca1ee6c5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B532587F40>]}
[0m12:58:54.159408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91b0a746-9259-428c-844a-95ca1ee6c5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B55B0B1850>]}
[0m12:58:54.159408 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m12:58:54.174929 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:58:54.297201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:58:54.297201 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\fact_order.sql
[0m12:58:54.328898 [debug] [MainThread]: Setting Default Schema: dev
[0m12:58:54.328898 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m12:58:54.344543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91b0a746-9259-428c-844a-95ca1ee6c5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B55B48DE80>]}
[0m12:58:54.354376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91b0a746-9259-428c-844a-95ca1ee6c5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B55B3A68B0>]}
[0m12:58:54.354376 [info ] [MainThread]: Found 13 models, 1 snapshot, 11 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m12:58:54.354376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b0a746-9259-428c-844a-95ca1ee6c5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B55B3A6640>]}
[0m12:58:54.354376 [info ] [MainThread]: 
[0m12:58:54.362800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:58:54.363807 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m12:58:54.366708 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m12:58:54.366708 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m12:58:54.366708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:55.390015 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:58:55.390015 [debug] [ThreadPool]: On list_DEV: Close
[0m12:58:55.469105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_CURATED'
[0m12:58:55.484560 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m12:58:55.484560 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m12:58:55.484560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:56.106050 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:58:56.106050 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m12:58:56.169011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_SNAPSHOT)
[0m12:58:56.169011 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m12:58:56.184523 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m12:58:56.184523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:56.789382 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:56.794900 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m12:58:56.872472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_dev)
[0m12:58:56.873478 [debug] [ThreadPool]: Using snowflake connection "list_DEV_dev"
[0m12:58:56.873478 [debug] [ThreadPool]: On list_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_dev"} */
show terse objects in DEV.dev limit 10000
[0m12:58:56.873478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:57.457814 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m12:58:57.457814 [debug] [ThreadPool]: On list_DEV_dev: Close
[0m12:58:57.583490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_dev, now list_DEV_STAGING)
[0m12:58:57.583490 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m12:58:57.583490 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m12:58:57.583490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:58.268701 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m12:58:58.270576 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m12:58:58.351044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91b0a746-9259-428c-844a-95ca1ee6c5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B55B1F9E50>]}
[0m12:58:58.352173 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:58.352774 [info ] [MainThread]: 
[0m12:58:58.355529 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m12:58:58.356104 [info ] [Thread-1  ]: 1 of 1 START sql incremental model dev.fact_order .............................. [RUN]
[0m12:58:58.356738 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m12:58:58.357361 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m12:58:58.366861 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m12:58:58.368069 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 12:58:58.357361 => 12:58:58.368069
[0m12:58:58.368666 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m12:58:58.407988 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m12:58:58.409101 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m12:58:58.409101 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
create or replace transient table DEV.dev.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(_ab_cdc_updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(_ab_cdc_updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from DEV.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount_value > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m12:58:58.409101 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:58:59.304908 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b064f6-3200-f55a-0004-6e52000230fa
[0m12:58:59.304908 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 13
invalid identifier '_AB_CDC_UPDATED_AT'
[0m12:58:59.320423 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 12:58:58.369177 => 12:58:59.320423
[0m12:58:59.320423 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m12:58:59.410087 [debug] [Thread-1  ]: Database Error in model fact_order (models\serving\fact_order.sql)
  000904 (42000): SQL compilation error: error line 20 at position 13
  invalid identifier '_AB_CDC_UPDATED_AT'
  compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m12:58:59.411110 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91b0a746-9259-428c-844a-95ca1ee6c5ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B55B831040>]}
[0m12:58:59.412116 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model dev.fact_order ..................... [[31mERROR[0m in 1.05s]
[0m12:58:59.412867 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m12:58:59.415874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:59.415874 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m12:58:59.416874 [debug] [MainThread]: Connection 'list_DEV_STAGING' was properly closed.
[0m12:58:59.416874 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m12:58:59.416874 [info ] [MainThread]: 
[0m12:58:59.418266 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m12:58:59.418266 [debug] [MainThread]: Command end result
[0m12:58:59.427274 [info ] [MainThread]: 
[0m12:58:59.427274 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:58:59.427274 [info ] [MainThread]: 
[0m12:58:59.427274 [error] [MainThread]: [33mDatabase Error in model fact_order (models\serving\fact_order.sql)[0m
[0m12:58:59.427274 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 20 at position 13
[0m12:58:59.427274 [error] [MainThread]:   invalid identifier '_AB_CDC_UPDATED_AT'
[0m12:58:59.433781 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m12:58:59.434701 [info ] [MainThread]: 
[0m12:58:59.434701 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:58:59.435708 [debug] [MainThread]: Command `dbt run` failed at 12:58:59.435708 after 5.94 seconds
[0m12:58:59.436708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B52E22C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B55B7C4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B55B4930D0>]}
[0m12:58:59.436708 [debug] [MainThread]: Flushing usage events
[0m13:01:30.522029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A01E08C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0223E7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0223E7FA0>]}


============================== 13:01:30.522029 | 4fc48622-2e4e-4392-9656-f4a1409492c3 ==============================
[0m13:01:30.522029 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:01:30.522029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_order', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:31.246525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fc48622-2e4e-4392-9656-f4a1409492c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0223E7F40>]}
[0m13:01:31.246525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fc48622-2e4e-4392-9656-f4a1409492c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04AF14850>]}
[0m13:01:31.246525 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:01:31.271949 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:01:31.390561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:01:31.391545 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\fact_order.sql
[0m13:01:31.422562 [debug] [MainThread]: Setting Default Schema: dev
[0m13:01:31.431543 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m13:01:31.435408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fc48622-2e4e-4392-9656-f4a1409492c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04B2EDE80>]}
[0m13:01:31.435408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fc48622-2e4e-4392-9656-f4a1409492c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04B2068B0>]}
[0m13:01:31.435408 [info ] [MainThread]: Found 13 models, 1 snapshot, 11 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:01:31.435408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fc48622-2e4e-4392-9656-f4a1409492c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04B206640>]}
[0m13:01:31.435408 [info ] [MainThread]: 
[0m13:01:31.451096 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:01:31.452210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m13:01:31.454617 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m13:01:31.454617 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m13:01:31.454617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:32.598045 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:01:32.598045 [debug] [ThreadPool]: On list_DEV: Close
[0m13:01:33.165376 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_CURATED'
[0m13:01:33.165376 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m13:01:33.165376 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m13:01:33.165376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:34.223586 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:01:34.223586 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m13:01:34.490182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_SNAPSHOT)
[0m13:01:34.490182 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m13:01:34.490182 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m13:01:34.490182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:35.358652 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:01:35.358652 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m13:01:35.656234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_STAGING)
[0m13:01:35.671691 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m13:01:35.671691 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m13:01:35.671691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:36.564427 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:01:36.580179 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m13:01:36.673547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_dev)
[0m13:01:36.673547 [debug] [ThreadPool]: Using snowflake connection "list_DEV_dev"
[0m13:01:36.673547 [debug] [ThreadPool]: On list_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_dev"} */
show terse objects in DEV.dev limit 10000
[0m13:01:36.673547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:37.584856 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:01:37.584856 [debug] [ThreadPool]: On list_DEV_dev: Close
[0m13:01:37.679248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fc48622-2e4e-4392-9656-f4a1409492c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04AFB3D30>]}
[0m13:01:37.679248 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:37.679248 [info ] [MainThread]: 
[0m13:01:37.679248 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m13:01:37.679248 [info ] [Thread-1  ]: 1 of 1 START sql incremental model dev.fact_order .............................. [RUN]
[0m13:01:37.679248 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m13:01:37.679248 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m13:01:37.696346 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m13:01:37.697387 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 13:01:37.679248 => 13:01:37.697387
[0m13:01:37.698395 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m13:01:37.735343 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m13:01:37.736798 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:01:37.736798 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
create or replace transient table DEV.dev.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from DEV.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount_value > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m13:01:37.736798 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:01:38.399893 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b064f9-3200-f55c-0004-6e520002400e
[0m13:01:38.399893 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 64 at position 14
invalid identifier 'STG_ORDER_DETAIL.DISCOUNT_VALUE'
[0m13:01:38.399893 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 13:01:37.698395 => 13:01:38.399893
[0m13:01:38.399893 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m13:01:38.489617 [debug] [Thread-1  ]: Database Error in model fact_order (models\serving\fact_order.sql)
  000904 (42000): SQL compilation error: error line 64 at position 14
  invalid identifier 'STG_ORDER_DETAIL.DISCOUNT_VALUE'
  compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m13:01:38.490159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc48622-2e4e-4392-9656-f4a1409492c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04B7C3F40>]}
[0m13:01:38.491247 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model dev.fact_order ..................... [[31mERROR[0m in 0.81s]
[0m13:01:38.491764 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m13:01:38.494069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:38.494592 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m13:01:38.495156 [debug] [MainThread]: Connection 'list_DEV_dev' was properly closed.
[0m13:01:38.495209 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m13:01:38.495713 [info ] [MainThread]: 
[0m13:01:38.496255 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.06 seconds (7.06s).
[0m13:01:38.496776 [debug] [MainThread]: Command end result
[0m13:01:38.512465 [info ] [MainThread]: 
[0m13:01:38.513055 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:01:38.514111 [info ] [MainThread]: 
[0m13:01:38.514641 [error] [MainThread]: [33mDatabase Error in model fact_order (models\serving\fact_order.sql)[0m
[0m13:01:38.515272 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 64 at position 14
[0m13:01:38.515777 [error] [MainThread]:   invalid identifier 'STG_ORDER_DETAIL.DISCOUNT_VALUE'
[0m13:01:38.515777 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\fact_order.sql
[0m13:01:38.515777 [info ] [MainThread]: 
[0m13:01:38.515777 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:01:38.515777 [debug] [MainThread]: Command `dbt run` failed at 13:01:38.515777 after 8.00 seconds
[0m13:01:38.515777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A01E08C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04B2F9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04B634D90>]}
[0m13:01:38.515777 [debug] [MainThread]: Flushing usage events
[0m13:02:05.651863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001772895C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001772CC87FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001772CC87F70>]}


============================== 13:02:05.651863 | 74761bc3-83a2-431a-b146-347297cfe9c9 ==============================
[0m13:02:05.651863 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:02:05.651863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_order', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:02:06.317886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74761bc3-83a2-431a-b146-347297cfe9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001772CC87F10>]}
[0m13:02:06.317886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74761bc3-83a2-431a-b146-347297cfe9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017755815FD0>]}
[0m13:02:06.317886 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:02:06.333514 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:02:06.452297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:02:06.452297 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\fact_order.sql
[0m13:02:06.483540 [debug] [MainThread]: Setting Default Schema: dev
[0m13:02:06.483540 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m13:02:06.483540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74761bc3-83a2-431a-b146-347297cfe9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017755BBDE50>]}
[0m13:02:06.499162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74761bc3-83a2-431a-b146-347297cfe9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017755AD6880>]}
[0m13:02:06.499162 [info ] [MainThread]: Found 13 models, 1 snapshot, 11 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:02:06.499162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74761bc3-83a2-431a-b146-347297cfe9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017755AD6610>]}
[0m13:02:06.499162 [info ] [MainThread]: 
[0m13:02:06.513171 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:02:06.513171 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m13:02:06.520618 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m13:02:06.520618 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m13:02:06.520618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:07.581211 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:02:07.581211 [debug] [ThreadPool]: On list_DEV: Close
[0m13:02:07.680971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_SNAPSHOT'
[0m13:02:07.680971 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m13:02:07.680971 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m13:02:07.680971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:08.280760 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:02:08.280760 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m13:02:08.343462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_STAGING)
[0m13:02:08.358903 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m13:02:08.358903 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m13:02:08.358903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:09.149715 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:02:09.149715 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m13:02:09.233695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_CURATED)
[0m13:02:09.234951 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m13:02:09.234951 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m13:02:09.234951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:09.836846 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:02:09.836846 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m13:02:09.930791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_dev)
[0m13:02:09.930791 [debug] [ThreadPool]: Using snowflake connection "list_DEV_dev"
[0m13:02:09.946317 [debug] [ThreadPool]: On list_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_dev"} */
show terse objects in DEV.dev limit 10000
[0m13:02:09.946317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:10.986662 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:02:10.986662 [debug] [ThreadPool]: On list_DEV_dev: Close
[0m13:02:11.065064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74761bc3-83a2-431a-b146-347297cfe9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017755BD1E50>]}
[0m13:02:11.065064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:02:11.065064 [info ] [MainThread]: 
[0m13:02:11.078074 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m13:02:11.078074 [info ] [Thread-1  ]: 1 of 1 START sql incremental model dev.fact_order .............................. [RUN]
[0m13:02:11.078074 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m13:02:11.078074 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m13:02:11.083308 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m13:02:11.083308 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 13:02:11.078074 => 13:02:11.083308
[0m13:02:11.083308 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m13:02:11.128852 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m13:02:11.131077 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:02:11.131077 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
create or replace transient table DEV.dev.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from DEV.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m13:02:11.131077 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:02:12.944246 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:02:12.956237 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:02:12.957238 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
drop view if exists DEV.dev.fact_order__dbt_tmp cascade
[0m13:02:13.012733 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:02:13.028245 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 13:02:11.083308 => 13:02:13.028245
[0m13:02:13.028245 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m13:02:13.169451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74761bc3-83a2-431a-b146-347297cfe9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177560BFD90>]}
[0m13:02:13.169451 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model dev.fact_order ......................... [[32mSUCCESS 1[0m in 2.09s]
[0m13:02:13.169451 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m13:02:13.169451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:13.169451 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m13:02:13.169451 [debug] [MainThread]: Connection 'list_DEV_dev' was properly closed.
[0m13:02:13.169451 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m13:02:13.169451 [info ] [MainThread]: 
[0m13:02:13.183083 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.66 seconds (6.66s).
[0m13:02:13.185243 [debug] [MainThread]: Command end result
[0m13:02:13.192958 [info ] [MainThread]: 
[0m13:02:13.192958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:13.192958 [info ] [MainThread]: 
[0m13:02:13.192958 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:02:13.192958 [debug] [MainThread]: Command `dbt run` succeeded at 13:02:13.192958 after 7.56 seconds
[0m13:02:13.192958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001772895C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017755815FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017755F01820>]}
[0m13:02:13.192958 [debug] [MainThread]: Flushing usage events
[0m13:10:02.194019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280BE30C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280C2668FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280C2668F40>]}


============================== 13:10:02.194019 | 4977a3d9-125e-444a-b88a-d2f5278b49f5 ==============================
[0m13:10:02.194019 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:10:02.194019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_order', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:10:02.869477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4977a3d9-125e-444a-b88a-d2f5278b49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280C2668EE0>]}
[0m13:10:02.869477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4977a3d9-125e-444a-b88a-d2f5278b49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EB1C8820>]}
[0m13:10:02.869477 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:10:02.887498 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:10:02.986934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:10:02.986934 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\fact_order.yml
[0m13:10:03.018188 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:10:03.033914 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:10:03.033914 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:10:03.033914 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m13:10:03.033914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4977a3d9-125e-444a-b88a-d2f5278b49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EB5CB0D0>]}
[0m13:10:03.057766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4977a3d9-125e-444a-b88a-d2f5278b49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EB483CA0>]}
[0m13:10:03.057766 [info ] [MainThread]: Found 13 models, 1 snapshot, 13 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:10:03.057766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4977a3d9-125e-444a-b88a-d2f5278b49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EB483A00>]}
[0m13:10:03.057766 [info ] [MainThread]: 
[0m13:10:03.057766 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:10:03.057766 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m13:10:03.071711 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m13:10:03.071711 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m13:10:03.071711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:04.062230 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:10:04.062230 [debug] [ThreadPool]: On list_DEV: Close
[0m13:10:04.160117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_SNAPSHOT'
[0m13:10:04.160117 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m13:10:04.160117 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m13:10:04.160117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:04.995931 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:10:04.995931 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m13:10:05.089996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_STAGING)
[0m13:10:05.089996 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m13:10:05.089996 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m13:10:05.089996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:05.696402 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:10:05.701508 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m13:10:05.782908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_CURATED)
[0m13:10:05.786903 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m13:10:05.786903 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m13:10:05.786903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:06.409563 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:10:06.409563 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m13:10:06.503902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4977a3d9-125e-444a-b88a-d2f5278b49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EB483130>]}
[0m13:10:06.503902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:10:06.503902 [info ] [MainThread]: 
[0m13:10:06.503902 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m13:10:06.503902 [info ] [Thread-1  ]: 1 of 1 START sql incremental model CURATED.fact_order .......................... [RUN]
[0m13:10:06.503902 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m13:10:06.503902 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m13:10:06.532219 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m13:10:06.533434 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 13:10:06.503902 => 13:10:06.533434
[0m13:10:06.533434 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m13:10:06.567537 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m13:10:06.574644 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:10:06.574644 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
create or replace transient table DEV.CURATED.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from DEV.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m13:10:06.574644 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:10:08.694950 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:10:08.704955 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:10:08.704955 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
drop view if exists DEV.CURATED.fact_order__dbt_tmp cascade
[0m13:10:08.792579 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:10:08.807132 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 13:10:06.533434 => 13:10:08.806593
[0m13:10:08.807203 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m13:10:08.897036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4977a3d9-125e-444a-b88a-d2f5278b49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EB8DE550>]}
[0m13:10:08.898103 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model CURATED.fact_order ..................... [[32mSUCCESS 1[0m in 2.39s]
[0m13:10:08.898702 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m13:10:08.900999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:08.901505 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m13:10:08.902035 [debug] [MainThread]: Connection 'list_DEV_CURATED' was properly closed.
[0m13:10:08.902629 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m13:10:08.902629 [info ] [MainThread]: 
[0m13:10:08.903138 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m13:10:08.904233 [debug] [MainThread]: Command end result
[0m13:10:08.915811 [info ] [MainThread]: 
[0m13:10:08.916911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:10:08.918011 [info ] [MainThread]: 
[0m13:10:08.918578 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:10:08.919760 [debug] [MainThread]: Command `dbt run` succeeded at 13:10:08.919760 after 6.74 seconds
[0m13:10:08.920271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280BE30C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EB1C8820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280EBA5DFD0>]}
[0m13:10:08.920355 [debug] [MainThread]: Flushing usage events
[0m13:13:55.176771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C1A1C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C5D47FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C5D47FA0>]}


============================== 13:13:55.176771 | b87fb818-ff5f-4158-b070-46d015e43c01 ==============================
[0m13:13:55.176771 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:13:55.176771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_order', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:13:56.087307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b87fb818-ff5f-4158-b070-46d015e43c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C5D47F70>]}
[0m13:13:56.094819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b87fb818-ff5f-4158-b070-46d015e43c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EE8B0E20>]}
[0m13:13:56.096898 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:13:56.114970 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:13:56.256878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:13:56.256878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:13:56.257877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m13:13:56.263875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b87fb818-ff5f-4158-b070-46d015e43c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EEBDBD90>]}
[0m13:13:56.279791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b87fb818-ff5f-4158-b070-46d015e43c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EEA7E130>]}
[0m13:13:56.280791 [info ] [MainThread]: Found 13 models, 1 snapshot, 13 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:13:56.281791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b87fb818-ff5f-4158-b070-46d015e43c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EEA7E280>]}
[0m13:13:56.282793 [info ] [MainThread]: 
[0m13:13:56.284792 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:13:56.286303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m13:13:56.297326 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m13:13:56.298331 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m13:13:56.300330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:57.351261 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:13:57.353262 [debug] [ThreadPool]: On list_DEV: Close
[0m13:13:57.443757 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_CURATED'
[0m13:13:57.453277 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m13:13:57.454782 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m13:13:57.454782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:58.334037 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:13:58.335546 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m13:13:58.417165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_SNAPSHOT)
[0m13:13:58.420137 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m13:13:58.421136 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m13:13:58.421136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:59.261354 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:13:59.261954 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m13:13:59.338056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_STAGING)
[0m13:13:59.342019 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m13:13:59.343024 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m13:13:59.343024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:59.920253 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:13:59.923197 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m13:14:00.002300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b87fb818-ff5f-4158-b070-46d015e43c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EEF81C40>]}
[0m13:14:00.003297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:14:00.004295 [info ] [MainThread]: 
[0m13:14:00.009958 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m13:14:00.010904 [info ] [Thread-1  ]: 1 of 1 START sql incremental model CURATED.fact_order .......................... [RUN]
[0m13:14:00.011857 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m13:14:00.012896 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m13:14:00.034136 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m13:14:00.035134 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 13:14:00.013890 => 13:14:00.035134
[0m13:14:00.035701 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m13:14:00.069859 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:14:00.070494 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
create or replace  temporary view DEV.CURATED.fact_order__dbt_tmp
  
   as (
    

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from DEV.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


    where stg_order_detail.updated_at > (select max(updated_at) from DEV.CURATED.fact_order)

  );
[0m13:14:00.071107 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:14:00.839100 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b06505-3200-f5b9-0004-6e5200022186
[0m13:14:00.840203 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'UPDATED_AT'
[0m13:14:00.840203 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 13:14:00.035701 => 13:14:00.840203
[0m13:14:00.841557 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m13:14:00.921752 [debug] [Thread-1  ]: Database Error in model fact_order (models\serving\fact_order.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'UPDATED_AT'
[0m13:14:00.922756 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b87fb818-ff5f-4158-b070-46d015e43c01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EF141700>]}
[0m13:14:00.923768 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model CURATED.fact_order ................. [[31mERROR[0m in 0.91s]
[0m13:14:00.925580 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m13:14:00.927440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:00.928474 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m13:14:00.928474 [debug] [MainThread]: Connection 'list_DEV_STAGING' was properly closed.
[0m13:14:00.929432 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m13:14:00.929432 [info ] [MainThread]: 
[0m13:14:00.930464 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m13:14:00.931397 [debug] [MainThread]: Command end result
[0m13:14:00.942075 [info ] [MainThread]: 
[0m13:14:00.943175 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:14:00.944231 [info ] [MainThread]: 
[0m13:14:00.945146 [error] [MainThread]: [33mDatabase Error in model fact_order (models\serving\fact_order.sql)[0m
[0m13:14:00.946424 [error] [MainThread]:   002028 (42601): SQL compilation error:
[0m13:14:00.947423 [error] [MainThread]:   ambiguous column name 'UPDATED_AT'
[0m13:14:00.948425 [info ] [MainThread]: 
[0m13:14:00.948425 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:14:00.950425 [debug] [MainThread]: Command `dbt run` failed at 13:14:00.950425 after 5.79 seconds
[0m13:14:00.950425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C1A1C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EF0B6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6EEA7E100>]}
[0m13:14:00.951425 [debug] [MainThread]: Flushing usage events
[0m13:15:49.272088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F922B505E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F926EB7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F926EED370>]}


============================== 13:15:49.275221 | 7089c496-c82e-4d9f-9a15-bda04987e84f ==============================
[0m13:15:49.275221 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:15:49.276279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_order', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:15:49.955737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7089c496-c82e-4d9f-9a15-bda04987e84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F926EB7CA0>]}
[0m13:15:49.971364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7089c496-c82e-4d9f-9a15-bda04987e84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94FA2E100>]}
[0m13:15:49.971364 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:15:49.989511 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:15:50.075324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:50.075324 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\fact_order.sql
[0m13:15:50.117108 [debug] [MainThread]: Setting Default Schema: dev
[0m13:15:50.135769 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:15:50.138970 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:15:50.138970 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:15:50.138970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m13:15:50.154697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7089c496-c82e-4d9f-9a15-bda04987e84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94FDD60D0>]}
[0m13:15:50.209767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7089c496-c82e-4d9f-9a15-bda04987e84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94F9BA100>]}
[0m13:15:50.210681 [info ] [MainThread]: Found 13 models, 1 snapshot, 13 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:15:50.210681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7089c496-c82e-4d9f-9a15-bda04987e84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9264CDD90>]}
[0m13:15:50.210681 [info ] [MainThread]: 
[0m13:15:50.210681 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:15:50.210681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m13:15:50.210681 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m13:15:50.210681 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m13:15:50.225579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:51.208057 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:15:51.209770 [debug] [ThreadPool]: On list_DEV: Close
[0m13:15:51.295754 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_CURATED'
[0m13:15:51.298768 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m13:15:51.298768 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m13:15:51.298768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:51.896935 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:15:51.896935 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m13:15:52.006895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_SNAPSHOT)
[0m13:15:52.006895 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m13:15:52.006895 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m13:15:52.006895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:52.845454 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:15:52.845454 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m13:15:52.928611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_STAGING)
[0m13:15:52.933688 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m13:15:52.933688 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m13:15:52.933688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:53.497566 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:15:53.513191 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m13:15:53.591835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7089c496-c82e-4d9f-9a15-bda04987e84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94FDD6EE0>]}
[0m13:15:53.591835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:53.591835 [info ] [MainThread]: 
[0m13:15:53.591835 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m13:15:53.591835 [info ] [Thread-1  ]: 1 of 1 START sql incremental model CURATED.fact_order .......................... [RUN]
[0m13:15:53.591835 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m13:15:53.591835 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m13:15:53.611586 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m13:15:53.611586 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 13:15:53.591835 => 13:15:53.611586
[0m13:15:53.611586 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m13:15:53.645801 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m13:15:53.645801 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:15:53.645801 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
create or replace transient table DEV.CURATED.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from DEV.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier,
    stg_order_detail.updated_at
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m13:15:53.645801 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:15:55.618082 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:15:55.640532 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:15:55.640532 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
drop view if exists DEV.CURATED.fact_order__dbt_tmp cascade
[0m13:15:55.696691 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:15:55.712291 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 13:15:53.611586 => 13:15:55.712291
[0m13:15:55.712291 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m13:15:55.790786 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7089c496-c82e-4d9f-9a15-bda04987e84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95028ECD0>]}
[0m13:15:55.790786 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model CURATED.fact_order ..................... [[32mSUCCESS 1[0m in 2.20s]
[0m13:15:55.790786 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m13:15:55.790786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:55.790786 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m13:15:55.790786 [debug] [MainThread]: Connection 'list_DEV_STAGING' was properly closed.
[0m13:15:55.790786 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m13:15:55.790786 [info ] [MainThread]: 
[0m13:15:55.790786 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m13:15:55.804728 [debug] [MainThread]: Command end result
[0m13:15:55.815734 [info ] [MainThread]: 
[0m13:15:55.816734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:55.817141 [info ] [MainThread]: 
[0m13:15:55.817141 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:15:55.819149 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:55.819149 after 6.56 seconds
[0m13:15:55.819149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F922B505E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F926F6A100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F926EED3D0>]}
[0m13:15:55.819149 [debug] [MainThread]: Flushing usage events
[0m13:28:07.753815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4D2FD0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4D7337FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4D736D040>]}


============================== 13:28:07.757248 | a078c9e5-6a04-414d-b8bb-abfae0ea303a ==============================
[0m13:28:07.757248 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:28:07.758247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select preset_obt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:28:08.440799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a078c9e5-6a04-414d-b8bb-abfae0ea303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4D7337FA0>]}
[0m13:28:08.446798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a078c9e5-6a04-414d-b8bb-abfae0ea303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FFEAF0A0>]}
[0m13:28:08.448799 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:28:08.454472 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:28:08.569934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:28:08.569934 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\preset_obt.sql
[0m13:28:08.600771 [debug] [MainThread]: Setting Default Schema: dev
[0m13:28:08.600771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m13:28:08.616394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a078c9e5-6a04-414d-b8bb-abfae0ea303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A480224FD0>]}
[0m13:28:08.616394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a078c9e5-6a04-414d-b8bb-abfae0ea303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A480070730>]}
[0m13:28:08.616394 [info ] [MainThread]: Found 14 models, 1 snapshot, 13 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:28:08.631934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a078c9e5-6a04-414d-b8bb-abfae0ea303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A480070490>]}
[0m13:28:08.633783 [info ] [MainThread]: 
[0m13:28:08.634073 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:28:08.636447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m13:28:08.637604 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m13:28:08.637604 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m13:28:08.637604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:09.590787 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:28:09.590787 [debug] [ThreadPool]: On list_DEV: Close
[0m13:28:09.665997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV, now create_DEV_dev)
[0m13:28:09.666691 [debug] [ThreadPool]: Creating schema "database: "DEV"
schema: "dev"
"
[0m13:28:09.669769 [debug] [ThreadPool]: Using snowflake connection "create_DEV_dev"
[0m13:28:09.669769 [debug] [ThreadPool]: On create_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "create_DEV_dev"} */
create schema if not exists DEV.dev
[0m13:28:09.669769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:10.581584 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:28:10.581584 [debug] [ThreadPool]: On create_DEV_dev: Close
[0m13:28:10.680117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_SNAPSHOT'
[0m13:28:10.687111 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m13:28:10.687111 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m13:28:10.687111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:11.300078 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:28:11.302078 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m13:28:11.390453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_dev)
[0m13:28:11.390453 [debug] [ThreadPool]: Using snowflake connection "list_DEV_dev"
[0m13:28:11.390453 [debug] [ThreadPool]: On list_DEV_dev: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_dev"} */
show terse objects in DEV.dev limit 10000
[0m13:28:11.390453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:12.175404 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:28:12.175404 [debug] [ThreadPool]: On list_DEV_dev: Close
[0m13:28:12.308066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_dev, now list_DEV_STAGING)
[0m13:28:12.308066 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m13:28:12.308066 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m13:28:12.308066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:13.420672 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:28:13.420672 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m13:28:13.498788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_CURATED)
[0m13:28:13.514390 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m13:28:13.514390 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m13:28:13.514390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:14.160651 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:28:14.160651 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m13:28:14.229741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a078c9e5-6a04-414d-b8bb-abfae0ea303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4800704C0>]}
[0m13:28:14.245317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:28:14.245317 [info ] [MainThread]: 
[0m13:28:14.245317 [debug] [Thread-1  ]: Began running node model.northwind.preset_obt
[0m13:28:14.245317 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.preset_obt ..................................... [RUN]
[0m13:28:14.245317 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.preset_obt'
[0m13:28:14.254278 [debug] [Thread-1  ]: Began compiling node model.northwind.preset_obt
[0m13:28:14.266098 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:28:14.266098 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
describe table DEV.CURATED.fact_order
[0m13:28:14.266098 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:28:14.820099 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 1.0 seconds
[0m13:28:14.820099 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:28:14.820099 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
describe table DEV.CURATED.dim_product
[0m13:28:14.889193 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.0 seconds
[0m13:28:14.889193 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:28:14.889193 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
describe table DEV.CURATED.dim_supplier
[0m13:28:14.967465 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:28:14.967465 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.preset_obt"
[0m13:28:14.967465 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (compile): 13:28:14.254278 => 13:28:14.967465
[0m13:28:14.967465 [debug] [Thread-1  ]: Began executing node model.northwind.preset_obt
[0m13:28:14.983214 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.preset_obt"
[0m13:28:14.983214 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:28:14.983214 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
create or replace   view DEV.dev.preset_obt
  
   as (
    with fact_order as (
    select * from DEV.CURATED.fact_order
),

dim_product as (
    select * from DEV.CURATED.dim_product
),

dim_supplier as (
    select * from DEV.CURATED.dim_supplier
)

select
    fact_order."ORDER_ID",
  fact_order."PRODUCT_ID",
  fact_order."UNIT_PRICE",
  fact_order."QUANTITY",
  fact_order."NORMAL_RETAIL_VALUE",
  fact_order."DISCOUNT",
  fact_order."DISCOUNT_VALUE",
  fact_order."ACTUAL_RETAIL_VALUE",
  fact_order."PRICE_TYPE",
  fact_order."ORDER_DATE",
  fact_order."SHIPPED_DATE",
  fact_order."REQUIRED_DATE",
  fact_order."DAYS_TO_SHIP",
  fact_order."CUSTOMER_TIER",
  fact_order."UPDATED_AT",
    dim_product."PRODUCT_ID",
  dim_product."PRODUCT_NAME",
  dim_product."CATEGORY_NAME",
  dim_product."REORDER_LEVEL",
  dim_product."DISCONTINUED",
  dim_product."UNITS_IN_STOCK",
  dim_product."UNITS_ON_ORDER",
    dim_supplier."SUPPLIER_ID",
  dim_supplier."COMPANY_NAME",
  dim_supplier."CONTACT_NAME",
  dim_supplier."CONTACT_TITLE",
  dim_supplier."ADDRESS",
  dim_supplier."CITY",
  dim_supplier."REGION",
  dim_supplier."POSTAL_CODE",
  dim_supplier."COUNTRY",
  dim_supplier."PHONE"
from fact_order
left join dim_product on fact_order.product_key = dim_product.product_key
left join dim_supplier on dim_product.supplier_key = dim_supplier.supplier_key
  );
[0m13:28:15.108425 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b06514-3200-f55a-0004-6e52000231f2
[0m13:28:15.108425 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'PRODUCT_ID'
[0m13:28:15.108425 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (execute): 13:28:14.967465 => 13:28:15.108425
[0m13:28:15.108425 [debug] [Thread-1  ]: On model.northwind.preset_obt: Close
[0m13:28:15.187082 [debug] [Thread-1  ]: Database Error in model preset_obt (models\serving\preset_obt.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'PRODUCT_ID'
  compiled Code at target\run\northwind\models\serving\preset_obt.sql
[0m13:28:15.187082 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a078c9e5-6a04-414d-b8bb-abfae0ea303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4807DBB50>]}
[0m13:28:15.187082 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev.preset_obt ............................ [[31mERROR[0m in 0.94s]
[0m13:28:15.187082 [debug] [Thread-1  ]: Finished running node model.northwind.preset_obt
[0m13:28:15.187082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:15.187082 [debug] [MainThread]: Connection 'create_DEV_dev' was properly closed.
[0m13:28:15.187082 [debug] [MainThread]: Connection 'list_DEV_CURATED' was properly closed.
[0m13:28:15.187082 [debug] [MainThread]: Connection 'model.northwind.preset_obt' was properly closed.
[0m13:28:15.187082 [info ] [MainThread]: 
[0m13:28:15.187082 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.55 seconds (6.55s).
[0m13:28:15.200779 [debug] [MainThread]: Command end result
[0m13:28:15.202100 [info ] [MainThread]: 
[0m13:28:15.202100 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:28:15.202100 [info ] [MainThread]: 
[0m13:28:15.202100 [error] [MainThread]: [33mDatabase Error in model preset_obt (models\serving\preset_obt.sql)[0m
[0m13:28:15.214854 [error] [MainThread]:   002025 (42S21): SQL compilation error:
[0m13:28:15.215862 [error] [MainThread]:   duplicate column name 'PRODUCT_ID'
[0m13:28:15.216288 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\preset_obt.sql
[0m13:28:15.216288 [info ] [MainThread]: 
[0m13:28:15.216288 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:28:15.216288 [debug] [MainThread]: Command `dbt run` failed at 13:28:15.216288 after 7.48 seconds
[0m13:28:15.216288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4D2FD0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4FFEAF130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A480629D60>]}
[0m13:28:15.216288 [debug] [MainThread]: Flushing usage events
[0m13:29:11.283347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150DD51C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E1877FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E1877FD0>]}


============================== 13:29:11.286348 | bc3fb24b-023c-4c3d-97b4-8e32a2a15e20 ==============================
[0m13:29:11.286348 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:29:11.287348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select preset_obt', 'send_anonymous_usage_stats': 'True'}
[0m13:29:12.014542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc3fb24b-023c-4c3d-97b4-8e32a2a15e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E1877F70>]}
[0m13:29:12.018507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc3fb24b-023c-4c3d-97b4-8e32a2a15e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001508A3B0A60>]}
[0m13:29:12.018507 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:29:12.035553 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:29:12.144854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:29:12.144854 [debug] [MainThread]: Partial parsing: added file: northwind://models\serving\preset_obt.yml
[0m13:29:12.144854 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\preset_obt.sql
[0m13:29:12.175751 [debug] [MainThread]: Setting Default Schema: dev
[0m13:29:12.197458 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:29:12.204536 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m13:29:12.209529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc3fb24b-023c-4c3d-97b4-8e32a2a15e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001508A7910D0>]}
[0m13:29:12.246639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc3fb24b-023c-4c3d-97b4-8e32a2a15e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001508A39C250>]}
[0m13:29:12.246639 [info ] [MainThread]: Found 14 models, 1 snapshot, 13 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:29:12.246639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc3fb24b-023c-4c3d-97b4-8e32a2a15e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001508A39C640>]}
[0m13:29:12.261061 [info ] [MainThread]: 
[0m13:29:12.262651 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:29:12.262651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m13:29:12.262651 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m13:29:12.262651 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m13:29:12.262651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:13.216785 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:29:13.216785 [debug] [ThreadPool]: On list_DEV: Close
[0m13:29:13.312875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_SNAPSHOT'
[0m13:29:13.312875 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m13:29:13.312875 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m13:29:13.312875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:14.150711 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:29:14.152660 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m13:29:14.239324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOT, now list_DEV_CURATED)
[0m13:29:14.239324 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m13:29:14.239324 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m13:29:14.239324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:15.051309 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:29:15.051309 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m13:29:15.141794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_STAGING)
[0m13:29:15.141794 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m13:29:15.141794 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m13:29:15.141794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:15.758624 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:29:15.758624 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m13:29:15.860547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc3fb24b-023c-4c3d-97b4-8e32a2a15e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E0F52B80>]}
[0m13:29:15.861899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:15.863256 [info ] [MainThread]: 
[0m13:29:15.866978 [debug] [Thread-1  ]: Began running node model.northwind.preset_obt
[0m13:29:15.867506 [info ] [Thread-1  ]: 1 of 1 START sql table model CURATED.preset_obt ................................ [RUN]
[0m13:29:15.867506 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.preset_obt'
[0m13:29:15.869281 [debug] [Thread-1  ]: Began compiling node model.northwind.preset_obt
[0m13:29:15.877349 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:29:15.877349 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
describe table DEV.CURATED.fact_order
[0m13:29:15.877349 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:29:16.488358 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 1.0 seconds
[0m13:29:16.495875 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:29:16.495875 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
describe table DEV.CURATED.dim_product
[0m13:29:16.556983 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.0 seconds
[0m13:29:16.572398 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:29:16.572398 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
describe table DEV.CURATED.dim_supplier
[0m13:29:16.644109 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:29:16.644109 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.preset_obt"
[0m13:29:16.644109 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (compile): 13:29:15.869281 => 13:29:16.644109
[0m13:29:16.644109 [debug] [Thread-1  ]: Began executing node model.northwind.preset_obt
[0m13:29:16.677606 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.preset_obt"
[0m13:29:16.677606 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:29:16.677606 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
create or replace transient table DEV.CURATED.preset_obt
         as
        (with fact_order as (
    select * from DEV.CURATED.fact_order
),

dim_product as (
    select * from DEV.CURATED.dim_product
),

dim_supplier as (
    select * from DEV.CURATED.dim_supplier
)

select
    fact_order."ORDER_ID",
  fact_order."UNIT_PRICE",
  fact_order."QUANTITY",
  fact_order."NORMAL_RETAIL_VALUE",
  fact_order."DISCOUNT",
  fact_order."DISCOUNT_VALUE",
  fact_order."ACTUAL_RETAIL_VALUE",
  fact_order."PRICE_TYPE",
  fact_order."ORDER_DATE",
  fact_order."SHIPPED_DATE",
  fact_order."REQUIRED_DATE",
  fact_order."DAYS_TO_SHIP",
  fact_order."CUSTOMER_TIER",
  fact_order."UPDATED_AT",
    dim_product."PRODUCT_NAME",
  dim_product."CATEGORY_NAME",
  dim_product."REORDER_LEVEL",
  dim_product."DISCONTINUED",
  dim_product."UNITS_IN_STOCK",
  dim_product."UNITS_ON_ORDER",
    dim_supplier."SUPPLIER_ID",
  dim_supplier."COMPANY_NAME",
  dim_supplier."CONTACT_NAME",
  dim_supplier."CONTACT_TITLE",
  dim_supplier."ADDRESS",
  dim_supplier."CITY",
  dim_supplier."REGION",
  dim_supplier."POSTAL_CODE",
  dim_supplier."COUNTRY",
  dim_supplier."PHONE"
from fact_order
left join dim_product on fact_order.product_key = dim_product.product_key
left join dim_supplier on dim_product.supplier_key = dim_supplier.supplier_key
        );
[0m13:29:17.742933 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:29:17.758054 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (execute): 13:29:16.644109 => 13:29:17.758054
[0m13:29:17.758054 [debug] [Thread-1  ]: On model.northwind.preset_obt: Close
[0m13:29:17.821471 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc3fb24b-023c-4c3d-97b4-8e32a2a15e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001508AC9CA30>]}
[0m13:29:17.821471 [info ] [Thread-1  ]: 1 of 1 OK created sql table model CURATED.preset_obt ........................... [[32mSUCCESS 1[0m in 1.95s]
[0m13:29:17.821471 [debug] [Thread-1  ]: Finished running node model.northwind.preset_obt
[0m13:29:17.821471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:17.821471 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m13:29:17.821471 [debug] [MainThread]: Connection 'list_DEV_STAGING' was properly closed.
[0m13:29:17.821471 [debug] [MainThread]: Connection 'model.northwind.preset_obt' was properly closed.
[0m13:29:17.821471 [info ] [MainThread]: 
[0m13:29:17.821471 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.56 seconds (5.56s).
[0m13:29:17.835982 [debug] [MainThread]: Command end result
[0m13:29:17.843932 [info ] [MainThread]: 
[0m13:29:17.843932 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:17.843932 [info ] [MainThread]: 
[0m13:29:17.843932 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:29:17.843932 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:17.843932 after 6.58 seconds
[0m13:29:17.843932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150DD51C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001508A6D70D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E192A0A0>]}
[0m13:29:17.843932 [debug] [MainThread]: Flushing usage events
[0m13:40:04.729168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001834F14C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183534A7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183534A7FA0>]}


============================== 13:40:04.733481 | 4eda7370-4386-4f40-b0cb-e95fdcf82819 ==============================
[0m13:40:04.733481 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:40:04.734481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models serving.*', 'send_anonymous_usage_stats': 'True'}
[0m13:40:05.935312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183534A7F70>]}
[0m13:40:05.950937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837BFE0E50>]}
[0m13:40:05.950937 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:40:05.969145 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:40:06.094337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:40:06.094337 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_supplier.sql
[0m13:40:06.094337 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\preset_obt.sql
[0m13:40:06.094337 [debug] [MainThread]: Partial parsing: updated file: northwind://models\serving\dim_customer.sql
[0m13:40:06.133502 [debug] [MainThread]: Setting Default Schema: dev
[0m13:40:06.145944 [debug] [MainThread]: Setting Default Schema: dev
[0m13:40:06.145944 [debug] [MainThread]: Setting Default Schema: dev
[0m13:40:06.172111 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:40:06.179734 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:40:06.180629 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:40:06.183726 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:40:06.186741 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:40:06.187733 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:40:06.189734 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:40:06.223112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m13:40:06.223112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837C304CD0>]}
[0m13:40:06.243015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837C02F5E0>]}
[0m13:40:06.243015 [info ] [MainThread]: Found 14 models, 1 snapshot, 13 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:40:06.243015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837C03FD00>]}
[0m13:40:06.243015 [info ] [MainThread]: 
[0m13:40:06.243015 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:40:06.243015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m13:40:06.259542 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m13:40:06.259542 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m13:40:06.259542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:07.470810 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:40:07.470810 [debug] [ThreadPool]: On list_DEV: Close
[0m13:40:07.549548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_STAGING'
[0m13:40:07.565024 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m13:40:07.565024 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m13:40:07.565024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:08.367539 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:40:08.367539 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m13:40:08.461424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_CURATED)
[0m13:40:08.477052 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m13:40:08.477052 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m13:40:08.477052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:09.328301 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:40:09.331198 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m13:40:09.436880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_SNAPSHOT)
[0m13:40:09.452420 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m13:40:09.452420 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m13:40:09.452420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:10.039888 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:10.039888 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m13:40:10.134477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837C420670>]}
[0m13:40:10.134477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:10.134477 [info ] [MainThread]: 
[0m13:40:10.134477 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m13:40:10.134477 [info ] [Thread-1  ]: 1 of 6 START sql table model CURATED.dim_customer .............................. [RUN]
[0m13:40:10.134477 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer'
[0m13:40:10.134477 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m13:40:10.156634 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer"
[0m13:40:10.157637 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 13:40:10.134477 => 13:40:10.157637
[0m13:40:10.157637 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer
[0m13:40:10.179488 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer"
[0m13:40:10.181392 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer"
[0m13:40:10.181472 [debug] [Thread-1  ]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table DEV.CURATED.dim_customer
         as
        (with stg_customer as (
    select customer_id,
    company_name,
    contact_name,
    contact_title,
    address,
    city,
    region,
    postal_code,
    country,
    phone,
    fax
    from DEV.STAGING.stg_customer
)

select
    
    
md5(cast(coalesce(cast(stg_customer.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_customer.customer_id,
    stg_customer.company_name as customer_company_name,
    stg_customer.contact_name as customer_contact_name,
    stg_customer.contact_title as customer_contact_title,
    stg_customer.address as customer_address,
    stg_customer.city as customer_city,
    stg_customer.region as customer_region,
    stg_customer.postal_code as customer_postal_code,
    stg_customer.country as customer_country,
    stg_customer.phone as customer_phone
from stg_customer
        );
[0m13:40:10.181982 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:40:11.741459 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:40:11.756990 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (execute): 13:40:10.158636 => 13:40:11.756990
[0m13:40:11.756990 [debug] [Thread-1  ]: On model.northwind.dim_customer: Close
[0m13:40:11.856108 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837C87FCD0>]}
[0m13:40:11.858231 [info ] [Thread-1  ]: 1 of 6 OK created sql table model CURATED.dim_customer ......................... [[32mSUCCESS 1[0m in 1.72s]
[0m13:40:11.859026 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m13:40:11.859660 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m13:40:11.860933 [info ] [Thread-1  ]: 2 of 6 START sql table model CURATED.dim_customer_tier ......................... [RUN]
[0m13:40:11.862814 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.dim_customer_tier)
[0m13:40:11.863443 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m13:40:11.867572 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m13:40:11.869063 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 13:40:11.863443 => 13:40:11.868606
[0m13:40:11.869063 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m13:40:11.869063 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m13:40:11.869063 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m13:40:11.869063 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer_tier"} */
create or replace transient table DEV.CURATED.dim_customer_tier
         as
        (with snp_customer_customer_type as (
    select customer_id,
    cast(customer_type_id as integer) as customer_type_id,
    dbt_valid_from,
    dbt_valid_to
    from DEV.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from DEV.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
        );
[0m13:40:11.869063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:13.624026 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:40:13.624026 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 13:40:11.869063 => 13:40:13.624026
[0m13:40:13.624026 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m13:40:13.765404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837C884CA0>]}
[0m13:40:13.765404 [info ] [Thread-1  ]: 2 of 6 OK created sql table model CURATED.dim_customer_tier .................... [[32mSUCCESS 1[0m in 1.90s]
[0m13:40:13.765404 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m13:40:13.765404 [debug] [Thread-1  ]: Began running node model.northwind.dim_product
[0m13:40:13.765404 [info ] [Thread-1  ]: 3 of 6 START sql table model CURATED.dim_product ............................... [RUN]
[0m13:40:13.780892 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer_tier, now model.northwind.dim_product)
[0m13:40:13.780892 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_product
[0m13:40:13.780892 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_product"
[0m13:40:13.780892 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (compile): 13:40:13.780892 => 13:40:13.780892
[0m13:40:13.780892 [debug] [Thread-1  ]: Began executing node model.northwind.dim_product
[0m13:40:13.780892 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_product"
[0m13:40:13.780892 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_product"
[0m13:40:13.793399 [debug] [Thread-1  ]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table DEV.CURATED.dim_product
         as
        (with stg_product as (
    select cast(product_id as integer) as product_id,
    product_name,
    cast(unit_price as numeric(38,2)) as unit_price,
    cast(reorder_level as integer) as reorder_level,
    cast(discontinued as integer) as discontinued,
    cast(category_id as integer) as category_id,
    cast(units_in_stock as integer) as units_in_stock,
    cast(units_on_order as integer) as units_on_order,
    quantity_per_unit,
    cast(supplier_id as integer) as supplier_id
    from DEV.STAGING.stg_product
),

stg_category as(
    select cast(category_id as integer) as category_id,
    category_name,
    description
    from DEV.STAGING.stg_category
)

select
    
    
md5(cast(coalesce(cast(stg_product.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    stg_product.product_id,
    stg_product.product_name,
    stg_category.category_name,
    stg_product.reorder_level,
    stg_product.discontinued,
    stg_product.units_in_stock,
    stg_product.units_on_order,
    
    
md5(cast(coalesce(cast(stg_product.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key
from stg_product
left join stg_category on stg_product.category_id = stg_category.category_id
        );
[0m13:40:13.793399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:15.172595 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:15.172595 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (execute): 13:40:13.780892 => 13:40:15.172595
[0m13:40:15.172595 [debug] [Thread-1  ]: On model.northwind.dim_product: Close
[0m13:40:15.250791 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837C8F3F70>]}
[0m13:40:15.250791 [info ] [Thread-1  ]: 3 of 6 OK created sql table model CURATED.dim_product .......................... [[32mSUCCESS 1[0m in 1.47s]
[0m13:40:15.266269 [debug] [Thread-1  ]: Finished running node model.northwind.dim_product
[0m13:40:15.266269 [debug] [Thread-1  ]: Began running node model.northwind.dim_supplier
[0m13:40:15.266269 [info ] [Thread-1  ]: 4 of 6 START sql table model CURATED.dim_supplier .............................. [RUN]
[0m13:40:15.266269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now model.northwind.dim_supplier)
[0m13:40:15.266269 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_supplier
[0m13:40:15.266269 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_supplier"
[0m13:40:15.266269 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (compile): 13:40:15.266269 => 13:40:15.266269
[0m13:40:15.266269 [debug] [Thread-1  ]: Began executing node model.northwind.dim_supplier
[0m13:40:15.266269 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_supplier"
[0m13:40:15.266269 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_supplier"
[0m13:40:15.266269 [debug] [Thread-1  ]: On model.northwind.dim_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_supplier"} */
create or replace transient table DEV.CURATED.dim_supplier
         as
        (with stg_supplier as (
    select cast(supplier_id as integer) as supplier_id,
    country,
    contact_name,
    address,
    city,
    phone,
    company_name,
    fax,
    region,
    postal_code,
    contact_title
    from DEV.STAGING.stg_supplier
)

select
    
    
md5(cast(coalesce(cast(stg_supplier.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key,
    stg_supplier.supplier_id,
    stg_supplier.company_name as supplier_company_name,
    stg_supplier.contact_name as supplier_contact_name,
    stg_supplier.contact_title as supplier_contact_title,
    stg_supplier.address as supplier_address,
    stg_supplier.city as supplier_city,
    stg_supplier.region as supplier_region,
    stg_supplier.postal_code as supplier_postal_code,
    stg_supplier.country as supplier_country,
    stg_supplier.phone as supplier_phone
    from stg_supplier
        );
[0m13:40:15.281847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:16.375585 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:16.391390 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (execute): 13:40:15.266269 => 13:40:16.390409
[0m13:40:16.391390 [debug] [Thread-1  ]: On model.northwind.dim_supplier: Close
[0m13:40:16.506074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837C884A90>]}
[0m13:40:16.506074 [info ] [Thread-1  ]: 4 of 6 OK created sql table model CURATED.dim_supplier ......................... [[32mSUCCESS 1[0m in 1.24s]
[0m13:40:16.506074 [debug] [Thread-1  ]: Finished running node model.northwind.dim_supplier
[0m13:40:16.506074 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m13:40:16.506074 [info ] [Thread-1  ]: 5 of 6 START sql incremental model CURATED.fact_order .......................... [RUN]
[0m13:40:16.506074 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_supplier, now model.northwind.fact_order)
[0m13:40:16.506074 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m13:40:16.523353 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m13:40:16.523353 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 13:40:16.506074 => 13:40:16.523353
[0m13:40:16.523353 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m13:40:16.539900 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m13:40:16.539900 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:40:16.539900 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
create or replace transient table DEV.CURATED.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from DEV.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from DEV.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier,
    stg_order_detail.updated_at
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m13:40:16.539900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:18.108937 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:40:18.124572 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:40:18.124572 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order"} */
drop view if exists DEV.CURATED.fact_order__dbt_tmp cascade
[0m13:40:18.171461 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:40:18.171461 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 13:40:16.523353 => 13:40:18.171461
[0m13:40:18.171461 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m13:40:18.250209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837C8840A0>]}
[0m13:40:18.250209 [info ] [Thread-1  ]: 5 of 6 OK created sql incremental model CURATED.fact_order ..................... [[32mSUCCESS 1[0m in 1.74s]
[0m13:40:18.250209 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m13:40:18.265652 [debug] [Thread-1  ]: Began running node model.northwind.preset_obt
[0m13:40:18.265652 [info ] [Thread-1  ]: 6 of 6 START sql table model CURATED.preset_obt ................................ [RUN]
[0m13:40:18.265652 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.fact_order, now model.northwind.preset_obt)
[0m13:40:18.265652 [debug] [Thread-1  ]: Began compiling node model.northwind.preset_obt
[0m13:40:18.265652 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:40:18.265652 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
describe table DEV.CURATED.fact_order
[0m13:40:18.281273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:18.974986 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 1.0 seconds
[0m13:40:18.990426 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:40:18.990426 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
describe table DEV.CURATED.dim_product
[0m13:40:19.069151 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.0 seconds
[0m13:40:19.069151 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:40:19.069151 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
describe table DEV.CURATED.dim_supplier
[0m13:40:19.149782 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:40:19.149782 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:40:19.149782 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
describe table DEV.CURATED.dim_customer
[0m13:40:19.226994 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:40:19.226994 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.preset_obt"
[0m13:40:19.226994 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (compile): 13:40:18.265652 => 13:40:19.226994
[0m13:40:19.226994 [debug] [Thread-1  ]: Began executing node model.northwind.preset_obt
[0m13:40:19.226994 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.preset_obt"
[0m13:40:19.226994 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:40:19.226994 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.preset_obt"} */
create or replace transient table DEV.CURATED.preset_obt
         as
        (with fact_order as (
    select * from DEV.CURATED.fact_order
),

dim_product as (
    select * from DEV.CURATED.dim_product
),

dim_supplier as (
    select * from DEV.CURATED.dim_supplier
),

dim_customer as (
    select * from DEV.CURATED.dim_customer
)

select
    fact_order."ORDER_ID",
  fact_order."UNIT_PRICE",
  fact_order."QUANTITY",
  fact_order."NORMAL_RETAIL_VALUE",
  fact_order."DISCOUNT",
  fact_order."DISCOUNT_VALUE",
  fact_order."ACTUAL_RETAIL_VALUE",
  fact_order."PRICE_TYPE",
  fact_order."ORDER_DATE",
  fact_order."SHIPPED_DATE",
  fact_order."REQUIRED_DATE",
  fact_order."DAYS_TO_SHIP",
  fact_order."CUSTOMER_TIER",
  fact_order."UPDATED_AT",
    dim_product."PRODUCT_NAME",
  dim_product."CATEGORY_NAME",
  dim_product."REORDER_LEVEL",
  dim_product."DISCONTINUED",
  dim_product."UNITS_IN_STOCK",
  dim_product."UNITS_ON_ORDER",
    dim_supplier."SUPPLIER_ID",
  dim_supplier."SUPPLIER_COMPANY_NAME",
  dim_supplier."SUPPLIER_CONTACT_NAME",
  dim_supplier."SUPPLIER_CONTACT_TITLE",
  dim_supplier."SUPPLIER_ADDRESS",
  dim_supplier."SUPPLIER_CITY",
  dim_supplier."SUPPLIER_REGION",
  dim_supplier."SUPPLIER_POSTAL_CODE",
  dim_supplier."SUPPLIER_COUNTRY",
  dim_supplier."SUPPLIER_PHONE",
    dim_customer."CUSTOMER_COMPANY_NAME",
  dim_customer."CUSTOMER_CONTACT_NAME",
  dim_customer."CUSTOMER_CONTACT_TITLE",
  dim_customer."CUSTOMER_ADDRESS",
  dim_customer."CUSTOMER_CITY",
  dim_customer."CUSTOMER_REGION",
  dim_customer."CUSTOMER_POSTAL_CODE",
  dim_customer."CUSTOMER_COUNTRY",
  dim_customer."CUSTOMER_PHONE"
from fact_order
left join dim_product on fact_order.product_key = dim_product.product_key
left join dim_supplier on dim_product.supplier_key = dim_supplier.supplier_key
left join dim_customer on fact_order.customer_key = dim_customer.customer_key
        );
[0m13:40:20.300514 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:40:20.303794 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (execute): 13:40:19.226994 => 13:40:20.303794
[0m13:40:20.304306 [debug] [Thread-1  ]: On model.northwind.preset_obt: Close
[0m13:40:20.451500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eda7370-4386-4f40-b0cb-e95fdcf82819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837C8B2E50>]}
[0m13:40:20.452160 [info ] [Thread-1  ]: 6 of 6 OK created sql table model CURATED.preset_obt ........................... [[32mSUCCESS 1[0m in 2.19s]
[0m13:40:20.453231 [debug] [Thread-1  ]: Finished running node model.northwind.preset_obt
[0m13:40:20.456895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:20.457416 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m13:40:20.457935 [debug] [MainThread]: Connection 'list_DEV_SNAPSHOT' was properly closed.
[0m13:40:20.457935 [debug] [MainThread]: Connection 'model.northwind.preset_obt' was properly closed.
[0m13:40:20.458455 [info ] [MainThread]: 
[0m13:40:20.459051 [info ] [MainThread]: Finished running 5 table models, 1 incremental model in 0 hours 0 minutes and 14.22 seconds (14.22s).
[0m13:40:20.460100 [debug] [MainThread]: Command end result
[0m13:40:20.472159 [info ] [MainThread]: 
[0m13:40:20.472759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:20.473370 [info ] [MainThread]: 
[0m13:40:20.473975 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:40:20.475226 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:20.475134 after 15.76 seconds
[0m13:40:20.475226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001834F14C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837C01EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837BFE0B20>]}
[0m13:40:20.475812 [debug] [MainThread]: Flushing usage events
[0m13:45:01.980783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025520E3C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025525197FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025525197FD0>]}


============================== 13:45:01.981557 | 4efa5aac-ea33-49cf-b42d-ae2b4cb3f44a ==============================
[0m13:45:01.981557 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:45:01.981557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select discount_range', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:02.640487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4efa5aac-ea33-49cf-b42d-ae2b4cb3f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025525197F70>]}
[0m13:45:02.655993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4efa5aac-ea33-49cf-b42d-ae2b4cb3f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554DCF56D0>]}
[0m13:45:02.655993 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:45:02.673090 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:45:02.765526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:45:02.765526 [debug] [MainThread]: Partial parsing: added file: northwind://tests\discount_range.sql
[0m13:45:02.781177 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:02.797416 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m13:45:02.797416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4efa5aac-ea33-49cf-b42d-ae2b4cb3f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554E0A20D0>]}
[0m13:45:02.815509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4efa5aac-ea33-49cf-b42d-ae2b4cb3f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554DEA30D0>]}
[0m13:45:02.815509 [info ] [MainThread]: Found 14 models, 1 snapshot, 14 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:45:02.815509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4efa5aac-ea33-49cf-b42d-ae2b4cb3f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554DEA3DC0>]}
[0m13:45:02.815509 [info ] [MainThread]: 
[0m13:45:02.815509 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:45:02.815509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_CURATED'
[0m13:45:02.833261 [debug] [ThreadPool]: Using snowflake connection "list_DEV_CURATED"
[0m13:45:02.833261 [debug] [ThreadPool]: On list_DEV_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_CURATED"} */
show terse objects in DEV.CURATED limit 10000
[0m13:45:02.833261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:03.932339 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:45:03.932339 [debug] [ThreadPool]: On list_DEV_CURATED: Close
[0m13:45:04.006100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_CURATED, now list_DEV_STAGING)
[0m13:45:04.021573 [debug] [ThreadPool]: Using snowflake connection "list_DEV_STAGING"
[0m13:45:04.021573 [debug] [ThreadPool]: On list_DEV_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_STAGING"} */
show terse objects in DEV.STAGING limit 10000
[0m13:45:04.021573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:04.935279 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:45:04.935279 [debug] [ThreadPool]: On list_DEV_STAGING: Close
[0m13:45:05.180584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_STAGING, now list_DEV_SNAPSHOT)
[0m13:45:05.180584 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOT"
[0m13:45:05.180584 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOT"} */
show terse objects in DEV.SNAPSHOT limit 10000
[0m13:45:05.180584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:06.388170 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:06.388170 [debug] [ThreadPool]: On list_DEV_SNAPSHOT: Close
[0m13:45:06.451296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4efa5aac-ea33-49cf-b42d-ae2b4cb3f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554DEA3B20>]}
[0m13:45:06.451296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:06.451296 [info ] [MainThread]: 
[0m13:45:06.466929 [debug] [Thread-1  ]: Began running node test.northwind.discount_range
[0m13:45:06.466929 [info ] [Thread-1  ]: 1 of 1 START test discount_range ............................................... [RUN]
[0m13:45:06.466929 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.northwind.discount_range'
[0m13:45:06.466929 [debug] [Thread-1  ]: Began compiling node test.northwind.discount_range
[0m13:45:06.466929 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.discount_range"
[0m13:45:06.466929 [debug] [Thread-1  ]: Timing info for test.northwind.discount_range (compile): 13:45:06.466929 => 13:45:06.466929
[0m13:45:06.466929 [debug] [Thread-1  ]: Began executing node test.northwind.discount_range
[0m13:45:06.485411 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.discount_range"
[0m13:45:06.485411 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.discount_range"
[0m13:45:06.485411 [debug] [Thread-1  ]: On test.northwind.discount_range: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.discount_range"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select
    *
from DEV.STAGING.stg_order_detail 
where
    discount < 0 or discount > 1
      
    ) dbt_internal_test
[0m13:45:06.485411 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:45:07.408514 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:07.408514 [debug] [Thread-1  ]: Timing info for test.northwind.discount_range (execute): 13:45:06.466929 => 13:45:07.408514
[0m13:45:07.408514 [debug] [Thread-1  ]: On test.northwind.discount_range: Close
[0m13:45:07.502939 [info ] [Thread-1  ]: 1 of 1 PASS discount_range ..................................................... [[32mPASS[0m in 1.04s]
[0m13:45:07.518501 [debug] [Thread-1  ]: Finished running node test.northwind.discount_range
[0m13:45:07.518501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:07.518501 [debug] [MainThread]: Connection 'list_DEV_SNAPSHOT' was properly closed.
[0m13:45:07.518501 [debug] [MainThread]: Connection 'test.northwind.discount_range' was properly closed.
[0m13:45:07.518501 [info ] [MainThread]: 
[0m13:45:07.518501 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m13:45:07.526235 [debug] [MainThread]: Command end result
[0m13:45:07.533137 [info ] [MainThread]: 
[0m13:45:07.533137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:45:07.533137 [info ] [MainThread]: 
[0m13:45:07.533137 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:45:07.533137 [debug] [MainThread]: Command `dbt test` succeeded at 13:45:07.533137 after 5.57 seconds
[0m13:45:07.533137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025520E3C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554E030790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554DCF56D0>]}
[0m13:45:07.541149 [debug] [MainThread]: Flushing usage events
[0m13:45:35.066292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDC1EC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEE0547FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEE0547F70>]}


============================== 13:45:35.066292 | 2ad348ef-21b9-47c3-aff0-ab7822345732 ==============================
[0m13:45:35.066292 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:45:35.066292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:35.739769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEE0547F10>]}
[0m13:45:35.739769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE890819A0>]}
[0m13:45:35.739769 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:45:35.755397 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:45:35.782451 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:45:35.783444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE890815E0>]}
[0m13:45:36.632588 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.648215 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.648215 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.648215 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.663835 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.679456 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.679456 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.679456 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.695096 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.695096 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.695096 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.695096 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.695096 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.695096 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.711228 [debug] [MainThread]: Setting Default Schema: prod
[0m13:45:36.735262 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.756168 [warn ] [MainThread]: [[33mWARNING[0m]: 'snp_customer_customer_type' is a snapshot node, but it is specified in the
models section of snapshots\snp_customer_customer_type.yml. To fix this error,
place the `snp_customer_customer_type` specification under the snapshots key
instead.
[0m13:45:36.756168 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:45:36.777425 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.779451 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.783145 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:45:36.785150 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.786141 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.792949 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.792949 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.792949 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.792949 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:45:36.792949 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.807509 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.809361 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:45:36.811397 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.811397 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.811397 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:45:36.811397 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.811397 [debug] [MainThread]: Setting Custom Schema: dbt_test__audit
[0m13:45:36.825164 [debug] [MainThread]: Setting Custom Schema: CURATED
[0m13:45:36.825959 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m13:45:36.825959 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m13:45:36.841826 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m13:45:36.843822 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m13:45:36.845817 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m13:45:36.847816 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m13:45:36.849816 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m13:45:36.851813 [debug] [MainThread]: Setting Custom Schema: STAGING
[0m13:45:36.911701 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m13:45:36.925674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE89285A90>]}
[0m13:45:36.938693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE89285220>]}
[0m13:45:36.938693 [info ] [MainThread]: Found 14 models, 1 snapshot, 14 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:45:36.939597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE89285820>]}
[0m13:45:36.941665 [info ] [MainThread]: 
[0m13:45:36.942097 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:45:36.943097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m13:45:36.943097 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m13:45:36.943097 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m13:45:36.943097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:38.003865 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:45:38.013976 [debug] [ThreadPool]: On list_PROD: Close
[0m13:45:38.097873 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m13:45:38.097873 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m13:45:38.097873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:38.947230 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:45:38.947230 [debug] [ThreadPool]: On list_PROD: Close
[0m13:45:39.093592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_SNAPSHOT'
[0m13:45:39.109252 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m13:45:39.109252 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m13:45:39.109252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:39.727983 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:45:39.727983 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m13:45:39.806195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_SNAPSHOT, now list_PROD_STAGING)
[0m13:45:39.806195 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m13:45:39.806195 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m13:45:39.806195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:40.486872 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:45:40.488053 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m13:45:40.566570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_CURATED)
[0m13:45:40.569875 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m13:45:40.570384 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m13:45:40.570384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:41.189151 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:45:41.189151 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m13:45:41.267033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE89285610>]}
[0m13:45:41.267033 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:45:41.267033 [info ] [MainThread]: 
[0m13:45:41.282648 [debug] [Thread-1  ]: Began running node model.northwind.stg_category
[0m13:45:41.282648 [info ] [Thread-1  ]: 1 of 14 START sql table model STAGING.stg_category ............................. [RUN]
[0m13:45:41.285998 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_category'
[0m13:45:41.287219 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_category
[0m13:45:41.289835 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_category"
[0m13:45:41.289835 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (compile): 13:45:41.287219 => 13:45:41.289835
[0m13:45:41.289835 [debug] [Thread-1  ]: Began executing node model.northwind.stg_category
[0m13:45:41.307670 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_category"
[0m13:45:41.307670 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_category"
[0m13:45:41.307670 [debug] [Thread-1  ]: On model.northwind.stg_category: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_category"} */
create or replace transient table PROD.STAGING.stg_category
         as
        (
select category_id,
category_name,
description
from airbyte_database.airbyte_schema.categories
        );
[0m13:45:41.307670 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:45:42.637747 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:42.653726 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (execute): 13:45:41.289835 => 13:45:42.653726
[0m13:45:42.653726 [debug] [Thread-1  ]: On model.northwind.stg_category: Close
[0m13:45:42.760345 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE89607AF0>]}
[0m13:45:42.762301 [info ] [Thread-1  ]: 1 of 14 OK created sql table model STAGING.stg_category ........................ [[32mSUCCESS 1[0m in 1.47s]
[0m13:45:42.763346 [debug] [Thread-1  ]: Finished running node model.northwind.stg_category
[0m13:45:42.764317 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m13:45:42.765249 [info ] [Thread-1  ]: 2 of 14 START sql table model STAGING.stg_customer ............................. [RUN]
[0m13:45:42.767255 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_category, now model.northwind.stg_customer)
[0m13:45:42.767616 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m13:45:42.770717 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m13:45:42.771720 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 13:45:42.767616 => 13:45:42.771720
[0m13:45:42.771720 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m13:45:42.774720 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m13:45:42.775670 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m13:45:42.775670 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer"} */
create or replace transient table PROD.STAGING.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m13:45:42.775670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:44.778643 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:45:44.794237 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 13:45:42.772665 => 13:45:44.794237
[0m13:45:44.794237 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m13:45:44.888657 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8996ABE0>]}
[0m13:45:44.889668 [info ] [Thread-1  ]: 2 of 14 OK created sql table model STAGING.stg_customer ........................ [[32mSUCCESS 1[0m in 2.12s]
[0m13:45:44.891689 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m13:45:44.892672 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_customer_type
[0m13:45:44.894575 [info ] [Thread-1  ]: 3 of 14 START sql table model STAGING.stg_customer_customer_type ............... [RUN]
[0m13:45:44.895572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer, now model.northwind.stg_customer_customer_type)
[0m13:45:44.896588 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_customer_type
[0m13:45:44.899722 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_customer_type"
[0m13:45:44.899722 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (compile): 13:45:44.896588 => 13:45:44.899722
[0m13:45:44.899722 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_customer_type
[0m13:45:44.899722 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_customer_type"
[0m13:45:44.899722 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_customer_type"
[0m13:45:44.899722 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_customer_type
         as
        (
select customer_id,
customer_type_id
from airbyte_database.airbyte_schema.customer_customer_type
        );
[0m13:45:44.899722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:46.317017 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:46.317017 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (execute): 13:45:44.899722 => 13:45:46.317017
[0m13:45:46.317017 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: Close
[0m13:45:46.395476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8996FAF0>]}
[0m13:45:46.411086 [info ] [Thread-1  ]: 3 of 14 OK created sql table model STAGING.stg_customer_customer_type .......... [[32mSUCCESS 1[0m in 1.50s]
[0m13:45:46.411086 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_customer_type
[0m13:45:46.411086 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_type
[0m13:45:46.411086 [info ] [Thread-1  ]: 4 of 14 START sql table model STAGING.stg_customer_type ........................ [RUN]
[0m13:45:46.411086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_customer_type, now model.northwind.stg_customer_type)
[0m13:45:46.411086 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_type
[0m13:45:46.411086 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_type"
[0m13:45:46.411086 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (compile): 13:45:46.411086 => 13:45:46.411086
[0m13:45:46.411086 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_type
[0m13:45:46.411086 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_type"
[0m13:45:46.426694 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_type"
[0m13:45:46.426694 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m13:45:46.426694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:47.860583 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:47.860583 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (execute): 13:45:46.411086 => 13:45:47.860583
[0m13:45:47.860583 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: Close
[0m13:45:47.938758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8996FAF0>]}
[0m13:45:47.938758 [info ] [Thread-1  ]: 4 of 14 OK created sql table model STAGING.stg_customer_type ................... [[32mSUCCESS 1[0m in 1.51s]
[0m13:45:47.941915 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_type
[0m13:45:47.941915 [debug] [Thread-1  ]: Began running node model.northwind.stg_order
[0m13:45:47.941915 [info ] [Thread-1  ]: 5 of 14 START sql table model STAGING.stg_order ................................ [RUN]
[0m13:45:47.941915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_type, now model.northwind.stg_order)
[0m13:45:47.946786 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order
[0m13:45:47.950404 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order"
[0m13:45:47.950404 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (compile): 13:45:47.946786 => 13:45:47.950404
[0m13:45:47.950404 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order
[0m13:45:47.950404 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order"
[0m13:45:47.950404 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order"
[0m13:45:47.950404 [debug] [Thread-1  ]: On model.northwind.stg_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order"} */
create or replace transient table PROD.STAGING.stg_order
         as
        (
select order_id,
customer_id,
ship_city,
ship_postal_code,
required_date,
freight,
ship_region,
order_date,
shipped_date,
ship_via,
ship_address,
ship_name,
ship_country,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.orders
where _ab_cdc_deleted_at is null
        );
[0m13:45:47.950404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:49.180361 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:49.180361 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (execute): 13:45:47.950404 => 13:45:49.180361
[0m13:45:49.180361 [debug] [Thread-1  ]: On model.northwind.stg_order: Close
[0m13:45:49.274666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE89607AF0>]}
[0m13:45:49.274666 [info ] [Thread-1  ]: 5 of 14 OK created sql table model STAGING.stg_order ........................... [[32mSUCCESS 1[0m in 1.33s]
[0m13:45:49.274666 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order
[0m13:45:49.274666 [debug] [Thread-1  ]: Began running node model.northwind.stg_order_detail
[0m13:45:49.290185 [info ] [Thread-1  ]: 6 of 14 START sql table model STAGING.stg_order_detail ......................... [RUN]
[0m13:45:49.290185 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order, now model.northwind.stg_order_detail)
[0m13:45:49.290185 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order_detail
[0m13:45:49.290185 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order_detail"
[0m13:45:49.290185 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (compile): 13:45:49.290185 => 13:45:49.290185
[0m13:45:49.290185 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order_detail
[0m13:45:49.290185 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order_detail"
[0m13:45:49.290185 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order_detail"
[0m13:45:49.290185 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order_detail"} */
create or replace transient table PROD.STAGING.stg_order_detail
         as
        (
select order_id,
product_id,
unit_price,
quantity,
discount,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.order_details
        );
[0m13:45:49.290185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:50.940174 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:45:50.940174 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (execute): 13:45:49.290185 => 13:45:50.940174
[0m13:45:50.940174 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: Close
[0m13:45:51.034316 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE89935BB0>]}
[0m13:45:51.034316 [info ] [Thread-1  ]: 6 of 14 OK created sql table model STAGING.stg_order_detail .................... [[32mSUCCESS 1[0m in 1.74s]
[0m13:45:51.034316 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order_detail
[0m13:45:51.034316 [debug] [Thread-1  ]: Began running node model.northwind.stg_product
[0m13:45:51.034316 [info ] [Thread-1  ]: 7 of 14 START sql table model STAGING.stg_product .............................. [RUN]
[0m13:45:51.034316 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order_detail, now model.northwind.stg_product)
[0m13:45:51.034316 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_product
[0m13:45:51.051322 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_product"
[0m13:45:51.052454 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (compile): 13:45:51.034316 => 13:45:51.052454
[0m13:45:51.052454 [debug] [Thread-1  ]: Began executing node model.northwind.stg_product
[0m13:45:51.052454 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_product"
[0m13:45:51.052454 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_product"
[0m13:45:51.052454 [debug] [Thread-1  ]: On model.northwind.stg_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_product"} */
create or replace transient table PROD.STAGING.stg_product
         as
        (
select product_id,
product_name,
unit_price,
reorder_level,
discontinued,
category_id,
units_in_stock,
units_on_order,
quantity_per_unit,
supplier_id
from airbyte_database.airbyte_schema.products
        );
[0m13:45:51.052454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:52.468931 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:52.468931 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (execute): 13:45:51.052454 => 13:45:52.468931
[0m13:45:52.468931 [debug] [Thread-1  ]: On model.northwind.stg_product: Close
[0m13:45:52.578696 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE89967F70>]}
[0m13:45:52.578696 [info ] [Thread-1  ]: 7 of 14 OK created sql table model STAGING.stg_product ......................... [[32mSUCCESS 1[0m in 1.54s]
[0m13:45:52.593950 [debug] [Thread-1  ]: Finished running node model.northwind.stg_product
[0m13:45:52.593950 [debug] [Thread-1  ]: Began running node model.northwind.stg_supplier
[0m13:45:52.593950 [info ] [Thread-1  ]: 8 of 14 START sql table model STAGING.stg_supplier ............................. [RUN]
[0m13:45:52.593950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_product, now model.northwind.stg_supplier)
[0m13:45:52.593950 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_supplier
[0m13:45:52.593950 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_supplier"
[0m13:45:52.593950 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (compile): 13:45:52.593950 => 13:45:52.593950
[0m13:45:52.593950 [debug] [Thread-1  ]: Began executing node model.northwind.stg_supplier
[0m13:45:52.593950 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_supplier"
[0m13:45:52.593950 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_supplier"
[0m13:45:52.593950 [debug] [Thread-1  ]: On model.northwind.stg_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_supplier"} */
create or replace transient table PROD.STAGING.stg_supplier
         as
        (
select supplier_id,
country,
contact_name,
address,
city,
phone,
company_name,
fax,
region,
postal_code,
contact_title
from airbyte_database.airbyte_schema.suppliers
        );
[0m13:45:52.593950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:53.758557 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:53.758557 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (execute): 13:45:52.593950 => 13:45:53.758557
[0m13:45:53.773197 [debug] [Thread-1  ]: On model.northwind.stg_supplier: Close
[0m13:45:53.917570 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE89935640>]}
[0m13:45:53.918799 [info ] [Thread-1  ]: 8 of 14 OK created sql table model STAGING.stg_supplier ........................ [[32mSUCCESS 1[0m in 1.32s]
[0m13:45:53.920190 [debug] [Thread-1  ]: Finished running node model.northwind.stg_supplier
[0m13:45:53.920703 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m13:45:53.921872 [info ] [Thread-1  ]: 9 of 14 START sql table model CURATED.dim_customer ............................. [RUN]
[0m13:45:53.923621 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_supplier, now model.northwind.dim_customer)
[0m13:45:53.924192 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m13:45:53.927149 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer"
[0m13:45:53.927149 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 13:45:53.924192 => 13:45:53.927149
[0m13:45:53.927149 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer
[0m13:45:53.927149 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer"
[0m13:45:53.927149 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer"
[0m13:45:53.927149 [debug] [Thread-1  ]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer"} */
create or replace transient table PROD.CURATED.dim_customer
         as
        (with stg_customer as (
    select customer_id,
    company_name,
    contact_name,
    contact_title,
    address,
    city,
    region,
    postal_code,
    country,
    phone,
    fax
    from PROD.STAGING.stg_customer
)

select
    
    
md5(cast(coalesce(cast(stg_customer.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_customer.customer_id,
    stg_customer.company_name as customer_company_name,
    stg_customer.contact_name as customer_contact_name,
    stg_customer.contact_title as customer_contact_title,
    stg_customer.address as customer_address,
    stg_customer.city as customer_city,
    stg_customer.region as customer_region,
    stg_customer.postal_code as customer_postal_code,
    stg_customer.country as customer_country,
    stg_customer.phone as customer_phone
from stg_customer
        );
[0m13:45:53.927149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:55.533155 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:45:55.533155 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (execute): 13:45:53.927149 => 13:45:55.533155
[0m13:45:55.533155 [debug] [Thread-1  ]: On model.northwind.dim_customer: Close
[0m13:45:55.690952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE89914CD0>]}
[0m13:45:55.690952 [info ] [Thread-1  ]: 9 of 14 OK created sql table model CURATED.dim_customer ........................ [[32mSUCCESS 1[0m in 1.77s]
[0m13:45:55.690952 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m13:45:55.690952 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m13:45:55.690952 [info ] [Thread-1  ]: 10 of 14 START sql table model CURATED.dim_customer_tier ....................... [RUN]
[0m13:45:55.690952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.dim_customer_tier)
[0m13:45:55.690952 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m13:45:55.706623 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m13:45:55.708166 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 13:45:55.690952 => 13:45:55.708166
[0m13:45:55.708166 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m13:45:55.709495 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m13:45:55.709495 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m13:45:55.709495 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer_tier"} */
create or replace transient table PROD.CURATED.dim_customer_tier
         as
        (with snp_customer_customer_type as (
    select customer_id,
    cast(customer_type_id as integer) as customer_type_id,
    dbt_valid_from,
    dbt_valid_to
    from PROD.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from PROD.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
        );
[0m13:45:55.709495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:56.323068 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b06525-3200-f55c-0004-6e520002415a
[0m13:45:56.323068 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROD.SNAPSHOT.SNP_CUSTOMER_CUSTOMER_TYPE' does not exist or not authorized.
[0m13:45:56.323068 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 13:45:55.709225 => 13:45:56.323068
[0m13:45:56.323068 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m13:45:56.464727 [debug] [Thread-1  ]: Database Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROD.SNAPSHOT.SNP_CUSTOMER_CUSTOMER_TYPE' does not exist or not authorized.
  compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m13:45:56.464727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE899FEA90>]}
[0m13:45:56.464727 [error] [Thread-1  ]: 10 of 14 ERROR creating sql table model CURATED.dim_customer_tier .............. [[31mERROR[0m in 0.77s]
[0m13:45:56.464727 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m13:45:56.464727 [debug] [Thread-1  ]: Began running node model.northwind.dim_product
[0m13:45:56.464727 [info ] [Thread-1  ]: 11 of 14 START sql table model CURATED.dim_product ............................. [RUN]
[0m13:45:56.464727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer_tier, now model.northwind.dim_product)
[0m13:45:56.464727 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_product
[0m13:45:56.464727 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_product"
[0m13:45:56.464727 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (compile): 13:45:56.464727 => 13:45:56.464727
[0m13:45:56.464727 [debug] [Thread-1  ]: Began executing node model.northwind.dim_product
[0m13:45:56.480368 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_product"
[0m13:45:56.483504 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_product"
[0m13:45:56.483504 [debug] [Thread-1  ]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_product"} */
create or replace transient table PROD.CURATED.dim_product
         as
        (with stg_product as (
    select cast(product_id as integer) as product_id,
    product_name,
    cast(unit_price as numeric(38,2)) as unit_price,
    cast(reorder_level as integer) as reorder_level,
    cast(discontinued as integer) as discontinued,
    cast(category_id as integer) as category_id,
    cast(units_in_stock as integer) as units_in_stock,
    cast(units_on_order as integer) as units_on_order,
    quantity_per_unit,
    cast(supplier_id as integer) as supplier_id
    from PROD.STAGING.stg_product
),

stg_category as(
    select cast(category_id as integer) as category_id,
    category_name,
    description
    from PROD.STAGING.stg_category
)

select
    
    
md5(cast(coalesce(cast(stg_product.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    stg_product.product_id,
    stg_product.product_name,
    stg_category.category_name,
    stg_product.reorder_level,
    stg_product.discontinued,
    stg_product.units_in_stock,
    stg_product.units_on_order,
    
    
md5(cast(coalesce(cast(stg_product.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key
from stg_product
left join stg_category on stg_product.category_id = stg_category.category_id
        );
[0m13:45:56.483504 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:57.997957 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:45:57.997957 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (execute): 13:45:56.464727 => 13:45:57.997957
[0m13:45:57.997957 [debug] [Thread-1  ]: On model.northwind.dim_product: Close
[0m13:45:58.107981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE8995DB50>]}
[0m13:45:58.107981 [info ] [Thread-1  ]: 11 of 14 OK created sql table model CURATED.dim_product ........................ [[32mSUCCESS 1[0m in 1.64s]
[0m13:45:58.107981 [debug] [Thread-1  ]: Finished running node model.northwind.dim_product
[0m13:45:58.107981 [debug] [Thread-1  ]: Began running node model.northwind.dim_supplier
[0m13:45:58.107981 [info ] [Thread-1  ]: 12 of 14 START sql table model CURATED.dim_supplier ............................ [RUN]
[0m13:45:58.107981 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now model.northwind.dim_supplier)
[0m13:45:58.107981 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_supplier
[0m13:45:58.107981 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_supplier"
[0m13:45:58.107981 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (compile): 13:45:58.107981 => 13:45:58.107981
[0m13:45:58.107981 [debug] [Thread-1  ]: Began executing node model.northwind.dim_supplier
[0m13:45:58.107981 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_supplier"
[0m13:45:58.123586 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_supplier"
[0m13:45:58.124138 [debug] [Thread-1  ]: On model.northwind.dim_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_supplier"} */
create or replace transient table PROD.CURATED.dim_supplier
         as
        (with stg_supplier as (
    select cast(supplier_id as integer) as supplier_id,
    country,
    contact_name,
    address,
    city,
    phone,
    company_name,
    fax,
    region,
    postal_code,
    contact_title
    from PROD.STAGING.stg_supplier
)

select
    
    
md5(cast(coalesce(cast(stg_supplier.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key,
    stg_supplier.supplier_id,
    stg_supplier.company_name as supplier_company_name,
    stg_supplier.contact_name as supplier_contact_name,
    stg_supplier.contact_title as supplier_contact_title,
    stg_supplier.address as supplier_address,
    stg_supplier.city as supplier_city,
    stg_supplier.region as supplier_region,
    stg_supplier.postal_code as supplier_postal_code,
    stg_supplier.country as supplier_country,
    stg_supplier.phone as supplier_phone
    from stg_supplier
        );
[0m13:45:58.124710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:59.532307 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:45:59.532307 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (execute): 13:45:58.107981 => 13:45:59.532307
[0m13:45:59.532307 [debug] [Thread-1  ]: On model.northwind.dim_supplier: Close
[0m13:45:59.658040 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad348ef-21b9-47c3-aff0-ab7822345732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE897E1160>]}
[0m13:45:59.658040 [info ] [Thread-1  ]: 12 of 14 OK created sql table model CURATED.dim_supplier ....................... [[32mSUCCESS 1[0m in 1.55s]
[0m13:45:59.658040 [debug] [Thread-1  ]: Finished running node model.northwind.dim_supplier
[0m13:45:59.658040 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m13:45:59.658040 [info ] [Thread-1  ]: 13 of 14 SKIP relation CURATED.fact_order ...................................... [[33mSKIP[0m]
[0m13:45:59.658040 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m13:45:59.658040 [debug] [Thread-1  ]: Began running node model.northwind.preset_obt
[0m13:45:59.658040 [info ] [Thread-1  ]: 14 of 14 SKIP relation CURATED.preset_obt ...................................... [[33mSKIP[0m]
[0m13:45:59.658040 [debug] [Thread-1  ]: Finished running node model.northwind.preset_obt
[0m13:45:59.670366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:59.670366 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m13:45:59.670366 [debug] [MainThread]: Connection 'list_PROD_CURATED' was properly closed.
[0m13:45:59.670366 [debug] [MainThread]: Connection 'model.northwind.dim_supplier' was properly closed.
[0m13:45:59.670366 [info ] [MainThread]: 
[0m13:45:59.672874 [info ] [MainThread]: Finished running 13 table models, 1 incremental model in 0 hours 0 minutes and 22.73 seconds (22.73s).
[0m13:45:59.672874 [debug] [MainThread]: Command end result
[0m13:45:59.683283 [info ] [MainThread]: 
[0m13:45:59.683283 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:45:59.683283 [info ] [MainThread]: 
[0m13:45:59.683283 [error] [MainThread]: [33mDatabase Error in model dim_customer_tier (models\serving\dim_customer_tier.sql)[0m
[0m13:45:59.683283 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m13:45:59.683283 [error] [MainThread]:   Object 'PROD.SNAPSHOT.SNP_CUSTOMER_CUSTOMER_TYPE' does not exist or not authorized.
[0m13:45:59.683283 [error] [MainThread]:   compiled Code at target\run\northwind\models\serving\dim_customer_tier.sql
[0m13:45:59.683283 [info ] [MainThread]: 
[0m13:45:59.683283 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=2 TOTAL=14
[0m13:45:59.683283 [debug] [MainThread]: Command `dbt run` failed at 13:45:59.683283 after 24.63 seconds
[0m13:45:59.683283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDC1EC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE894BA9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE89126AF0>]}
[0m13:45:59.683283 [debug] [MainThread]: Flushing usage events
[0m13:46:21.254341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C2F980100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C33CF7F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C33CF7FA0>]}


============================== 13:46:21.254341 | 780626b5-b9aa-48e4-810a-04a13f59c80a ==============================
[0m13:46:21.254341 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:46:21.254341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:46:21.952893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '780626b5-b9aa-48e4-810a-04a13f59c80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C33CF7F40>]}
[0m13:46:21.952893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '780626b5-b9aa-48e4-810a-04a13f59c80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5C812EE0>]}
[0m13:46:21.952893 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:46:21.976249 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:46:22.074675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:22.074675 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:22.074675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m13:46:22.074675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '780626b5-b9aa-48e4-810a-04a13f59c80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5CB580D0>]}
[0m13:46:22.093250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '780626b5-b9aa-48e4-810a-04a13f59c80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5C8A4E80>]}
[0m13:46:22.093250 [info ] [MainThread]: Found 14 models, 1 snapshot, 14 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:46:22.093250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '780626b5-b9aa-48e4-810a-04a13f59c80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5C8A4C70>]}
[0m13:46:22.093250 [info ] [MainThread]: 
[0m13:46:22.093250 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:46:22.093250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m13:46:22.114339 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m13:46:22.114339 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m13:46:22.114339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:23.163086 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:46:23.163086 [debug] [ThreadPool]: On list_PROD: Close
[0m13:46:23.251346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_STAGING'
[0m13:46:23.251346 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m13:46:23.251346 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m13:46:23.251346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:24.083987 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:46:24.083987 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m13:46:24.162544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_CURATED)
[0m13:46:24.178175 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m13:46:24.178175 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m13:46:24.178175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:24.820655 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:46:24.822035 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m13:46:24.915833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_CURATED, now list_PROD_SNAPSHOT)
[0m13:46:24.921893 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m13:46:24.921893 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m13:46:24.921893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:25.711228 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:46:25.711228 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m13:46:25.805293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '780626b5-b9aa-48e4-810a-04a13f59c80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5C2F9FA0>]}
[0m13:46:25.820923 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:46:25.820923 [info ] [MainThread]: 
[0m13:46:25.823946 [debug] [Thread-1  ]: Began running node snapshot.northwind.snp_customer_customer_type
[0m13:46:25.823946 [info ] [Thread-1  ]: 1 of 1 START snapshot SNAPSHOT.snp_customer_customer_type ...................... [RUN]
[0m13:46:25.823946 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.northwind.snp_customer_customer_type'
[0m13:46:25.823946 [debug] [Thread-1  ]: Began compiling node snapshot.northwind.snp_customer_customer_type
[0m13:46:25.837479 [debug] [Thread-1  ]: Timing info for snapshot.northwind.snp_customer_customer_type (compile): 13:46:25.831406 => 13:46:25.837479
[0m13:46:25.837479 [debug] [Thread-1  ]: Began executing node snapshot.northwind.snp_customer_customer_type
[0m13:46:25.884606 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.northwind.snp_customer_customer_type"
[0m13:46:25.884606 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m13:46:25.884606 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
create or replace transient table PROD.SNAPSHOT.snp_customer_customer_type
         as
        (

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        

select * from prod.staging.stg_customer_customer_type
    ) sbq



        );
[0m13:46:25.884606 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:46:27.287089 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:46:27.301167 [debug] [Thread-1  ]: Timing info for snapshot.northwind.snp_customer_customer_type (execute): 13:46:25.838474 => 13:46:27.301167
[0m13:46:27.301167 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: Close
[0m13:46:27.400091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780626b5-b9aa-48e4-810a-04a13f59c80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5D057EB0>]}
[0m13:46:27.400091 [info ] [Thread-1  ]: 1 of 1 OK snapshotted SNAPSHOT.snp_customer_customer_type ...................... [[32msuccess[0m in 1.58s]
[0m13:46:27.400091 [debug] [Thread-1  ]: Finished running node snapshot.northwind.snp_customer_customer_type
[0m13:46:27.400091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:27.400091 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m13:46:27.400091 [debug] [MainThread]: Connection 'list_PROD_SNAPSHOT' was properly closed.
[0m13:46:27.400091 [debug] [MainThread]: Connection 'snapshot.northwind.snp_customer_customer_type' was properly closed.
[0m13:46:27.400091 [info ] [MainThread]: 
[0m13:46:27.400091 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m13:46:27.414093 [debug] [MainThread]: Command end result
[0m13:46:27.416790 [info ] [MainThread]: 
[0m13:46:27.426799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:27.426799 [info ] [MainThread]: 
[0m13:46:27.426799 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:46:27.426799 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:46:27.426799 after 6.19 seconds
[0m13:46:27.426799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C2F980100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5CE4CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5D057EB0>]}
[0m13:46:27.426799 [debug] [MainThread]: Flushing usage events
[0m13:46:33.032490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F4722C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F4B587F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F4B587F70>]}


============================== 13:46:33.032490 | 83f03078-b4db-4811-b5d7-05342131335d ==============================
[0m13:46:33.032490 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:46:33.032490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:46:33.802332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F4B587F10>]}
[0m13:46:33.827304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F740A1DC0>]}
[0m13:46:33.828313 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:46:33.842938 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:46:33.938984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:33.938984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:33.946547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m13:46:33.946547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F743EA0D0>]}
[0m13:46:33.965324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F742ACE50>]}
[0m13:46:33.965324 [info ] [MainThread]: Found 14 models, 1 snapshot, 14 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:46:33.965324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F742ACC40>]}
[0m13:46:33.965324 [info ] [MainThread]: 
[0m13:46:33.965324 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:46:33.965324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m13:46:33.982469 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m13:46:33.982469 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m13:46:33.982469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:34.962387 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:46:34.962387 [debug] [ThreadPool]: On list_PROD: Close
[0m13:46:35.040797 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m13:46:35.040797 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m13:46:35.040797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:35.637234 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:46:35.642388 [debug] [ThreadPool]: On list_PROD: Close
[0m13:46:35.715695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_STAGING'
[0m13:46:35.715695 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m13:46:35.715695 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m13:46:35.715695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:36.328930 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:46:36.328930 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m13:46:36.407704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_CURATED)
[0m13:46:36.407704 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m13:46:36.407704 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m13:46:36.407704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:37.004879 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:46:37.004879 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m13:46:37.083687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_CURATED, now list_PROD_SNAPSHOT)
[0m13:46:37.083687 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m13:46:37.083687 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m13:46:37.083687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:37.853009 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:46:37.853009 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m13:46:37.915587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F742ACEB0>]}
[0m13:46:37.915587 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:46:37.915587 [info ] [MainThread]: 
[0m13:46:37.931266 [debug] [Thread-1  ]: Began running node model.northwind.stg_category
[0m13:46:37.931266 [info ] [Thread-1  ]: 1 of 14 START sql table model STAGING.stg_category ............................. [RUN]
[0m13:46:37.931266 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_category'
[0m13:46:37.931266 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_category
[0m13:46:37.931266 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_category"
[0m13:46:37.931266 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (compile): 13:46:37.931266 => 13:46:37.931266
[0m13:46:37.931266 [debug] [Thread-1  ]: Began executing node model.northwind.stg_category
[0m13:46:37.963285 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_category"
[0m13:46:37.963285 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_category"
[0m13:46:37.963285 [debug] [Thread-1  ]: On model.northwind.stg_category: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_category"} */
create or replace transient table PROD.STAGING.stg_category
         as
        (
select category_id,
category_name,
description
from airbyte_database.airbyte_schema.categories
        );
[0m13:46:37.963285 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:46:39.407882 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:46:39.455029 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (execute): 13:46:37.931266 => 13:46:39.455029
[0m13:46:39.455029 [debug] [Thread-1  ]: On model.northwind.stg_category: Close
[0m13:46:39.550459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F74900B20>]}
[0m13:46:39.550459 [info ] [Thread-1  ]: 1 of 14 OK created sql table model STAGING.stg_category ........................ [[32mSUCCESS 1[0m in 1.62s]
[0m13:46:39.565019 [debug] [Thread-1  ]: Finished running node model.northwind.stg_category
[0m13:46:39.565019 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m13:46:39.565019 [info ] [Thread-1  ]: 2 of 14 START sql table model STAGING.stg_customer ............................. [RUN]
[0m13:46:39.565019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_category, now model.northwind.stg_customer)
[0m13:46:39.565019 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m13:46:39.580663 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m13:46:39.580663 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 13:46:39.565019 => 13:46:39.580663
[0m13:46:39.580663 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m13:46:39.596338 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m13:46:39.596338 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m13:46:39.596338 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer"} */
create or replace transient table PROD.STAGING.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m13:46:39.596338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:41.508041 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:46:41.523646 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 13:46:39.580663 => 13:46:41.523646
[0m13:46:41.523646 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m13:46:41.617653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F747CD790>]}
[0m13:46:41.617653 [info ] [Thread-1  ]: 2 of 14 OK created sql table model STAGING.stg_customer ........................ [[32mSUCCESS 1[0m in 2.05s]
[0m13:46:41.617653 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m13:46:41.633437 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_customer_type
[0m13:46:41.634007 [info ] [Thread-1  ]: 3 of 14 START sql table model STAGING.stg_customer_customer_type ............... [RUN]
[0m13:46:41.634007 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer, now model.northwind.stg_customer_customer_type)
[0m13:46:41.634007 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_customer_type
[0m13:46:41.645932 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_customer_type"
[0m13:46:41.649227 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (compile): 13:46:41.634007 => 13:46:41.648672
[0m13:46:41.651000 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_customer_type
[0m13:46:41.655443 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_customer_type"
[0m13:46:41.664654 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_customer_type"
[0m13:46:41.664654 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_customer_type
         as
        (
select customer_id,
customer_type_id
from airbyte_database.airbyte_schema.customer_customer_type
        );
[0m13:46:41.664654 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:43.459212 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:46:43.474949 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (execute): 13:46:41.652452 => 13:46:43.459212
[0m13:46:43.474949 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: Close
[0m13:46:43.559666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F748BA310>]}
[0m13:46:43.559666 [info ] [Thread-1  ]: 3 of 14 OK created sql table model STAGING.stg_customer_customer_type .......... [[32mSUCCESS 1[0m in 1.93s]
[0m13:46:43.568730 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_customer_type
[0m13:46:43.568730 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_type
[0m13:46:43.568730 [info ] [Thread-1  ]: 4 of 14 START sql table model STAGING.stg_customer_type ........................ [RUN]
[0m13:46:43.580257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_customer_type, now model.northwind.stg_customer_type)
[0m13:46:43.580257 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_type
[0m13:46:43.585927 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_type"
[0m13:46:43.585927 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (compile): 13:46:43.580257 => 13:46:43.585927
[0m13:46:43.600501 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_type
[0m13:46:43.600501 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_type"
[0m13:46:43.616203 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_type"
[0m13:46:43.616203 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m13:46:43.616203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:45.485812 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:46:45.501380 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (execute): 13:46:43.600501 => 13:46:45.485812
[0m13:46:45.501380 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: Close
[0m13:46:45.580210 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F74949E50>]}
[0m13:46:45.595993 [info ] [Thread-1  ]: 4 of 14 OK created sql table model STAGING.stg_customer_type ................... [[32mSUCCESS 1[0m in 2.01s]
[0m13:46:45.595993 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_type
[0m13:46:45.595993 [debug] [Thread-1  ]: Began running node model.northwind.stg_order
[0m13:46:45.595993 [info ] [Thread-1  ]: 5 of 14 START sql table model STAGING.stg_order ................................ [RUN]
[0m13:46:45.595993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_type, now model.northwind.stg_order)
[0m13:46:45.595993 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order
[0m13:46:45.611488 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order"
[0m13:46:45.611488 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (compile): 13:46:45.611488 => 13:46:45.611488
[0m13:46:45.627219 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order
[0m13:46:45.627219 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order"
[0m13:46:45.627219 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order"
[0m13:46:45.627219 [debug] [Thread-1  ]: On model.northwind.stg_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order"} */
create or replace transient table PROD.STAGING.stg_order
         as
        (
select order_id,
customer_id,
ship_city,
ship_postal_code,
required_date,
freight,
ship_region,
order_date,
shipped_date,
ship_via,
ship_address,
ship_name,
ship_country,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.orders
where _ab_cdc_deleted_at is null
        );
[0m13:46:45.627219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:47.451230 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:46:47.466797 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (execute): 13:46:45.627219 => 13:46:47.466797
[0m13:46:47.468402 [debug] [Thread-1  ]: On model.northwind.stg_order: Close
[0m13:46:47.545593 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F74947070>]}
[0m13:46:47.545593 [info ] [Thread-1  ]: 5 of 14 OK created sql table model STAGING.stg_order ........................... [[32mSUCCESS 1[0m in 1.95s]
[0m13:46:47.545593 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order
[0m13:46:47.545593 [debug] [Thread-1  ]: Began running node model.northwind.stg_order_detail
[0m13:46:47.561292 [info ] [Thread-1  ]: 6 of 14 START sql table model STAGING.stg_order_detail ......................... [RUN]
[0m13:46:47.561292 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order, now model.northwind.stg_order_detail)
[0m13:46:47.568363 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order_detail
[0m13:46:47.568363 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order_detail"
[0m13:46:47.577426 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (compile): 13:46:47.568363 => 13:46:47.577426
[0m13:46:47.577426 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order_detail
[0m13:46:47.588070 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order_detail"
[0m13:46:47.593168 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order_detail"
[0m13:46:47.593168 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order_detail"} */
create or replace transient table PROD.STAGING.stg_order_detail
         as
        (
select order_id,
product_id,
unit_price,
quantity,
discount,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.order_details
        );
[0m13:46:47.593168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:49.881078 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:46:49.888969 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (execute): 13:46:47.577426 => 13:46:49.887969
[0m13:46:49.890976 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: Close
[0m13:46:49.973640 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F747E1760>]}
[0m13:46:49.973640 [info ] [Thread-1  ]: 6 of 14 OK created sql table model STAGING.stg_order_detail .................... [[32mSUCCESS 1[0m in 2.41s]
[0m13:46:49.973640 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order_detail
[0m13:46:49.973640 [debug] [Thread-1  ]: Began running node model.northwind.stg_product
[0m13:46:49.973640 [info ] [Thread-1  ]: 7 of 14 START sql table model STAGING.stg_product .............................. [RUN]
[0m13:46:49.986235 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order_detail, now model.northwind.stg_product)
[0m13:46:49.986235 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_product
[0m13:46:49.986235 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_product"
[0m13:46:50.002006 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (compile): 13:46:49.986235 => 13:46:50.002006
[0m13:46:50.002006 [debug] [Thread-1  ]: Began executing node model.northwind.stg_product
[0m13:46:50.017606 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_product"
[0m13:46:50.017606 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_product"
[0m13:46:50.017606 [debug] [Thread-1  ]: On model.northwind.stg_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_product"} */
create or replace transient table PROD.STAGING.stg_product
         as
        (
select product_id,
product_name,
unit_price,
reorder_level,
discontinued,
category_id,
units_in_stock,
units_on_order,
quantity_per_unit,
supplier_id
from airbyte_database.airbyte_schema.products
        );
[0m13:46:50.017606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:51.756860 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:46:51.772464 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (execute): 13:46:50.002006 => 13:46:51.772464
[0m13:46:51.772464 [debug] [Thread-1  ]: On model.northwind.stg_product: Close
[0m13:46:51.862829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7470F7C0>]}
[0m13:46:51.866856 [info ] [Thread-1  ]: 7 of 14 OK created sql table model STAGING.stg_product ......................... [[32mSUCCESS 1[0m in 1.88s]
[0m13:46:51.866856 [debug] [Thread-1  ]: Finished running node model.northwind.stg_product
[0m13:46:51.866856 [debug] [Thread-1  ]: Began running node model.northwind.stg_supplier
[0m13:46:51.866856 [info ] [Thread-1  ]: 8 of 14 START sql table model STAGING.stg_supplier ............................. [RUN]
[0m13:46:51.879392 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_product, now model.northwind.stg_supplier)
[0m13:46:51.879392 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_supplier
[0m13:46:51.882936 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_supplier"
[0m13:46:51.882936 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (compile): 13:46:51.879392 => 13:46:51.882936
[0m13:46:51.898591 [debug] [Thread-1  ]: Began executing node model.northwind.stg_supplier
[0m13:46:51.898591 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_supplier"
[0m13:46:51.914219 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_supplier"
[0m13:46:51.914219 [debug] [Thread-1  ]: On model.northwind.stg_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_supplier"} */
create or replace transient table PROD.STAGING.stg_supplier
         as
        (
select supplier_id,
country,
contact_name,
address,
city,
phone,
company_name,
fax,
region,
postal_code,
contact_title
from airbyte_database.airbyte_schema.suppliers
        );
[0m13:46:51.914219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:54.115770 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:46:54.115770 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (execute): 13:46:51.898591 => 13:46:54.115770
[0m13:46:54.115770 [debug] [Thread-1  ]: On model.northwind.stg_supplier: Close
[0m13:46:54.194003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F748CEA60>]}
[0m13:46:54.209750 [info ] [Thread-1  ]: 8 of 14 OK created sql table model STAGING.stg_supplier ........................ [[32mSUCCESS 1[0m in 2.33s]
[0m13:46:54.209750 [debug] [Thread-1  ]: Finished running node model.northwind.stg_supplier
[0m13:46:54.209750 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m13:46:54.209750 [info ] [Thread-1  ]: 9 of 14 START sql table model CURATED.dim_customer ............................. [RUN]
[0m13:46:54.209750 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_supplier, now model.northwind.dim_customer)
[0m13:46:54.225399 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m13:46:54.256624 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer"
[0m13:46:54.256624 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 13:46:54.225399 => 13:46:54.256624
[0m13:46:54.256624 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer
[0m13:46:54.272155 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer"
[0m13:46:54.272155 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer"
[0m13:46:54.272155 [debug] [Thread-1  ]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer"} */
create or replace transient table PROD.CURATED.dim_customer
         as
        (with stg_customer as (
    select customer_id,
    company_name,
    contact_name,
    contact_title,
    address,
    city,
    region,
    postal_code,
    country,
    phone,
    fax
    from PROD.STAGING.stg_customer
)

select
    
    
md5(cast(coalesce(cast(stg_customer.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_customer.customer_id,
    stg_customer.company_name as customer_company_name,
    stg_customer.contact_name as customer_contact_name,
    stg_customer.contact_title as customer_contact_title,
    stg_customer.address as customer_address,
    stg_customer.city as customer_city,
    stg_customer.region as customer_region,
    stg_customer.postal_code as customer_postal_code,
    stg_customer.country as customer_country,
    stg_customer.phone as customer_phone
from stg_customer
        );
[0m13:46:54.272155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:56.322533 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:46:56.338203 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (execute): 13:46:54.256624 => 13:46:56.338203
[0m13:46:56.338203 [debug] [Thread-1  ]: On model.northwind.dim_customer: Close
[0m13:46:56.432833 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7470F790>]}
[0m13:46:56.432833 [info ] [Thread-1  ]: 9 of 14 OK created sql table model CURATED.dim_customer ........................ [[32mSUCCESS 1[0m in 2.22s]
[0m13:46:56.432833 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m13:46:56.432833 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m13:46:56.432833 [info ] [Thread-1  ]: 10 of 14 START sql table model CURATED.dim_customer_tier ....................... [RUN]
[0m13:46:56.448474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.dim_customer_tier)
[0m13:46:56.448474 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m13:46:56.464587 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m13:46:56.464587 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 13:46:56.448474 => 13:46:56.464587
[0m13:46:56.464587 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m13:46:56.480235 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m13:46:56.489751 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m13:46:56.489751 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer_tier"} */
create or replace transient table PROD.CURATED.dim_customer_tier
         as
        (with snp_customer_customer_type as (
    select customer_id,
    cast(customer_type_id as integer) as customer_type_id,
    dbt_valid_from,
    dbt_valid_to
    from PROD.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from PROD.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
        );
[0m13:46:56.489751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:58.513893 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:46:58.513893 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 13:46:56.464587 => 13:46:58.513893
[0m13:46:58.513893 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m13:46:58.608287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F749B1EE0>]}
[0m13:46:58.608287 [info ] [Thread-1  ]: 10 of 14 OK created sql table model CURATED.dim_customer_tier .................. [[32mSUCCESS 1[0m in 2.16s]
[0m13:46:58.623952 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m13:46:58.623952 [debug] [Thread-1  ]: Began running node model.northwind.dim_product
[0m13:46:58.623952 [info ] [Thread-1  ]: 11 of 14 START sql table model CURATED.dim_product ............................. [RUN]
[0m13:46:58.623952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer_tier, now model.northwind.dim_product)
[0m13:46:58.623952 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_product
[0m13:46:58.655353 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_product"
[0m13:46:58.655353 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (compile): 13:46:58.623952 => 13:46:58.655353
[0m13:46:58.655353 [debug] [Thread-1  ]: Began executing node model.northwind.dim_product
[0m13:46:58.670957 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_product"
[0m13:46:58.670957 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_product"
[0m13:46:58.670957 [debug] [Thread-1  ]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_product"} */
create or replace transient table PROD.CURATED.dim_product
         as
        (with stg_product as (
    select cast(product_id as integer) as product_id,
    product_name,
    cast(unit_price as numeric(38,2)) as unit_price,
    cast(reorder_level as integer) as reorder_level,
    cast(discontinued as integer) as discontinued,
    cast(category_id as integer) as category_id,
    cast(units_in_stock as integer) as units_in_stock,
    cast(units_on_order as integer) as units_on_order,
    quantity_per_unit,
    cast(supplier_id as integer) as supplier_id
    from PROD.STAGING.stg_product
),

stg_category as(
    select cast(category_id as integer) as category_id,
    category_name,
    description
    from PROD.STAGING.stg_category
)

select
    
    
md5(cast(coalesce(cast(stg_product.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    stg_product.product_id,
    stg_product.product_name,
    stg_category.category_name,
    stg_product.reorder_level,
    stg_product.discontinued,
    stg_product.units_in_stock,
    stg_product.units_on_order,
    
    
md5(cast(coalesce(cast(stg_product.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key
from stg_product
left join stg_category on stg_product.category_id = stg_category.category_id
        );
[0m13:46:58.670957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:00.873953 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:47:00.878489 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (execute): 13:46:58.655353 => 13:47:00.877912
[0m13:47:00.879678 [debug] [Thread-1  ]: On model.northwind.dim_product: Close
[0m13:47:00.942278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7470F760>]}
[0m13:47:00.958399 [info ] [Thread-1  ]: 11 of 14 OK created sql table model CURATED.dim_product ........................ [[32mSUCCESS 1[0m in 2.32s]
[0m13:47:00.958399 [debug] [Thread-1  ]: Finished running node model.northwind.dim_product
[0m13:47:00.958399 [debug] [Thread-1  ]: Began running node model.northwind.dim_supplier
[0m13:47:00.958399 [info ] [Thread-1  ]: 12 of 14 START sql table model CURATED.dim_supplier ............................ [RUN]
[0m13:47:00.958399 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now model.northwind.dim_supplier)
[0m13:47:00.958399 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_supplier
[0m13:47:00.973414 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_supplier"
[0m13:47:00.973414 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (compile): 13:47:00.958399 => 13:47:00.973414
[0m13:47:00.973414 [debug] [Thread-1  ]: Began executing node model.northwind.dim_supplier
[0m13:47:00.989058 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_supplier"
[0m13:47:01.000571 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_supplier"
[0m13:47:01.000571 [debug] [Thread-1  ]: On model.northwind.dim_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_supplier"} */
create or replace transient table PROD.CURATED.dim_supplier
         as
        (with stg_supplier as (
    select cast(supplier_id as integer) as supplier_id,
    country,
    contact_name,
    address,
    city,
    phone,
    company_name,
    fax,
    region,
    postal_code,
    contact_title
    from PROD.STAGING.stg_supplier
)

select
    
    
md5(cast(coalesce(cast(stg_supplier.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key,
    stg_supplier.supplier_id,
    stg_supplier.company_name as supplier_company_name,
    stg_supplier.contact_name as supplier_contact_name,
    stg_supplier.contact_title as supplier_contact_title,
    stg_supplier.address as supplier_address,
    stg_supplier.city as supplier_city,
    stg_supplier.region as supplier_region,
    stg_supplier.postal_code as supplier_postal_code,
    stg_supplier.country as supplier_country,
    stg_supplier.phone as supplier_phone
    from stg_supplier
        );
[0m13:47:01.000571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:02.789042 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:47:02.789042 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (execute): 13:47:00.989058 => 13:47:02.789042
[0m13:47:02.789042 [debug] [Thread-1  ]: On model.northwind.dim_supplier: Close
[0m13:47:02.879061 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F74A06A00>]}
[0m13:47:02.879565 [info ] [Thread-1  ]: 12 of 14 OK created sql table model CURATED.dim_supplier ....................... [[32mSUCCESS 1[0m in 1.92s]
[0m13:47:02.879565 [debug] [Thread-1  ]: Finished running node model.northwind.dim_supplier
[0m13:47:02.879565 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m13:47:02.879565 [info ] [Thread-1  ]: 13 of 14 START sql incremental model CURATED.fact_order ........................ [RUN]
[0m13:47:02.879565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_supplier, now model.northwind.fact_order)
[0m13:47:02.879565 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m13:47:02.879565 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m13:47:02.879565 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 13:47:02.879565 => 13:47:02.879565
[0m13:47:02.879565 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m13:47:02.915080 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m13:47:02.915080 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:47:02.915080 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
create or replace transient table PROD.CURATED.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from PROD.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier,
    stg_order_detail.updated_at
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m13:47:02.915080 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:04.238715 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:47:04.254344 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:47:04.254344 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
drop view if exists PROD.CURATED.fact_order__dbt_tmp cascade
[0m13:47:04.317051 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:47:04.317051 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 13:47:02.879565 => 13:47:04.317051
[0m13:47:04.317051 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m13:47:04.409339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F74900B20>]}
[0m13:47:04.409339 [info ] [Thread-1  ]: 13 of 14 OK created sql incremental model CURATED.fact_order ................... [[32mSUCCESS 1[0m in 1.53s]
[0m13:47:04.409339 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m13:47:04.409339 [debug] [Thread-1  ]: Began running node model.northwind.preset_obt
[0m13:47:04.422446 [info ] [Thread-1  ]: 14 of 14 START sql table model CURATED.preset_obt .............................. [RUN]
[0m13:47:04.422446 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.fact_order, now model.northwind.preset_obt)
[0m13:47:04.422446 [debug] [Thread-1  ]: Began compiling node model.northwind.preset_obt
[0m13:47:04.440540 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:47:04.440540 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.fact_order
[0m13:47:04.440540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:05.030164 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 1.0 seconds
[0m13:47:05.037256 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:47:05.037256 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_product
[0m13:47:05.097337 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.0 seconds
[0m13:47:05.112984 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:47:05.112984 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_supplier
[0m13:47:05.175690 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:47:05.175690 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:47:05.175690 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_customer
[0m13:47:05.253855 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:47:05.253855 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.preset_obt"
[0m13:47:05.253855 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (compile): 13:47:04.422446 => 13:47:05.253855
[0m13:47:05.253855 [debug] [Thread-1  ]: Began executing node model.northwind.preset_obt
[0m13:47:05.269329 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.preset_obt"
[0m13:47:05.269329 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:47:05.269329 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
create or replace transient table PROD.CURATED.preset_obt
         as
        (with fact_order as (
    select * from PROD.CURATED.fact_order
),

dim_product as (
    select * from PROD.CURATED.dim_product
),

dim_supplier as (
    select * from PROD.CURATED.dim_supplier
),

dim_customer as (
    select * from PROD.CURATED.dim_customer
)

select
    fact_order."ORDER_ID",
  fact_order."UNIT_PRICE",
  fact_order."QUANTITY",
  fact_order."NORMAL_RETAIL_VALUE",
  fact_order."DISCOUNT",
  fact_order."DISCOUNT_VALUE",
  fact_order."ACTUAL_RETAIL_VALUE",
  fact_order."PRICE_TYPE",
  fact_order."ORDER_DATE",
  fact_order."SHIPPED_DATE",
  fact_order."REQUIRED_DATE",
  fact_order."DAYS_TO_SHIP",
  fact_order."CUSTOMER_TIER",
  fact_order."UPDATED_AT",
    dim_product."PRODUCT_NAME",
  dim_product."CATEGORY_NAME",
  dim_product."REORDER_LEVEL",
  dim_product."DISCONTINUED",
  dim_product."UNITS_IN_STOCK",
  dim_product."UNITS_ON_ORDER",
    dim_supplier."SUPPLIER_ID",
  dim_supplier."SUPPLIER_COMPANY_NAME",
  dim_supplier."SUPPLIER_CONTACT_NAME",
  dim_supplier."SUPPLIER_CONTACT_TITLE",
  dim_supplier."SUPPLIER_ADDRESS",
  dim_supplier."SUPPLIER_CITY",
  dim_supplier."SUPPLIER_REGION",
  dim_supplier."SUPPLIER_POSTAL_CODE",
  dim_supplier."SUPPLIER_COUNTRY",
  dim_supplier."SUPPLIER_PHONE",
    dim_customer."CUSTOMER_COMPANY_NAME",
  dim_customer."CUSTOMER_CONTACT_NAME",
  dim_customer."CUSTOMER_CONTACT_TITLE",
  dim_customer."CUSTOMER_ADDRESS",
  dim_customer."CUSTOMER_CITY",
  dim_customer."CUSTOMER_REGION",
  dim_customer."CUSTOMER_POSTAL_CODE",
  dim_customer."CUSTOMER_COUNTRY",
  dim_customer."CUSTOMER_PHONE"
from fact_order
left join dim_product on fact_order.product_key = dim_product.product_key
left join dim_supplier on dim_product.supplier_key = dim_supplier.supplier_key
left join dim_customer on fact_order.customer_key = dim_customer.customer_key
        );
[0m13:47:06.184764 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:47:06.200367 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (execute): 13:47:05.269329 => 13:47:06.200367
[0m13:47:06.200367 [debug] [Thread-1  ]: On model.northwind.preset_obt: Close
[0m13:47:06.278665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f03078-b4db-4811-b5d7-05342131335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F747B12B0>]}
[0m13:47:06.278665 [info ] [Thread-1  ]: 14 of 14 OK created sql table model CURATED.preset_obt ......................... [[32mSUCCESS 1[0m in 1.86s]
[0m13:47:06.278665 [debug] [Thread-1  ]: Finished running node model.northwind.preset_obt
[0m13:47:06.278665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:06.278665 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m13:47:06.278665 [debug] [MainThread]: Connection 'list_PROD_SNAPSHOT' was properly closed.
[0m13:47:06.278665 [debug] [MainThread]: Connection 'model.northwind.preset_obt' was properly closed.
[0m13:47:06.278665 [info ] [MainThread]: 
[0m13:47:06.278665 [info ] [MainThread]: Finished running 13 table models, 1 incremental model in 0 hours 0 minutes and 32.31 seconds (32.31s).
[0m13:47:06.289875 [debug] [MainThread]: Command end result
[0m13:47:06.293466 [info ] [MainThread]: 
[0m13:47:06.293466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:06.293466 [info ] [MainThread]: 
[0m13:47:06.293466 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m13:47:06.293466 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:06.293466 after 33.29 seconds
[0m13:47:06.293466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F4722C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F749EBBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F749F6550>]}
[0m13:47:06.293466 [debug] [MainThread]: Flushing usage events
[0m13:47:39.103158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7E10FC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7E5457FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7E5457F40>]}


============================== 13:47:39.103158 | 3a7a8f9f-85ba-4beb-900d-f3e59a31a79a ==============================
[0m13:47:39.103158 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:47:39.103158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:47:39.794071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7E5457EE0>]}
[0m13:47:39.794071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78DF84130>]}
[0m13:47:39.794071 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:47:39.809176 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:47:39.920863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:39.921972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:39.922954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m13:47:39.928199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E2BB0D0>]}
[0m13:47:39.942173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E17CE20>]}
[0m13:47:39.942173 [info ] [MainThread]: Found 14 models, 1 snapshot, 14 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:47:39.943199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E17CC10>]}
[0m13:47:39.945174 [info ] [MainThread]: 
[0m13:47:39.946175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:39.946702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m13:47:39.946702 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m13:47:39.946702 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m13:47:39.946702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:40.986993 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:47:40.986993 [debug] [ThreadPool]: On list_PROD: Close
[0m13:47:41.086127 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m13:47:41.086127 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m13:47:41.086127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:41.685258 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:47:41.686865 [debug] [ThreadPool]: On list_PROD: Close
[0m13:47:41.787094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_CURATED'
[0m13:47:41.792196 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m13:47:41.792196 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m13:47:41.792196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:42.643029 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:47:42.643029 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m13:47:42.716469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_CURATED, now list_PROD_STAGING)
[0m13:47:42.722667 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m13:47:42.722667 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m13:47:42.722667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:43.323412 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:47:43.323412 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m13:47:43.390428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_SNAPSHOT)
[0m13:47:43.390428 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m13:47:43.390428 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m13:47:43.390428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:44.166503 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:47:44.166503 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m13:47:44.229810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78DFCDE50>]}
[0m13:47:44.245278 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:47:44.245278 [info ] [MainThread]: 
[0m13:47:44.245278 [debug] [Thread-1  ]: Began running node model.northwind.stg_category
[0m13:47:44.245278 [info ] [Thread-1  ]: 1 of 14 START sql table model STAGING.stg_category ............................. [RUN]
[0m13:47:44.245278 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_category'
[0m13:47:44.245278 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_category
[0m13:47:44.245278 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_category"
[0m13:47:44.245278 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (compile): 13:47:44.245278 => 13:47:44.245278
[0m13:47:44.245278 [debug] [Thread-1  ]: Began executing node model.northwind.stg_category
[0m13:47:44.272339 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_category"
[0m13:47:44.272339 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_category"
[0m13:47:44.272339 [debug] [Thread-1  ]: On model.northwind.stg_category: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_category"} */
create or replace transient table PROD.STAGING.stg_category
         as
        (
select category_id,
category_name,
description
from airbyte_database.airbyte_schema.categories
        );
[0m13:47:44.272339 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:47:45.516863 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:47:45.532587 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (execute): 13:47:44.245278 => 13:47:45.532587
[0m13:47:45.532587 [debug] [Thread-1  ]: On model.northwind.stg_category: Close
[0m13:47:45.611065 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E2DE940>]}
[0m13:47:45.611065 [info ] [Thread-1  ]: 1 of 14 OK created sql table model STAGING.stg_category ........................ [[32mSUCCESS 1[0m in 1.37s]
[0m13:47:45.611065 [debug] [Thread-1  ]: Finished running node model.northwind.stg_category
[0m13:47:45.611065 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m13:47:45.611065 [info ] [Thread-1  ]: 2 of 14 START sql table model STAGING.stg_customer ............................. [RUN]
[0m13:47:45.611065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_category, now model.northwind.stg_customer)
[0m13:47:45.611065 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m13:47:45.626713 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m13:47:45.626713 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 13:47:45.611065 => 13:47:45.626713
[0m13:47:45.626713 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m13:47:45.626713 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m13:47:45.626713 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m13:47:45.626713 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer"} */
create or replace transient table PROD.STAGING.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m13:47:45.626713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:46.743107 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:47:46.743107 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 13:47:45.626713 => 13:47:46.743107
[0m13:47:46.743107 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m13:47:46.822072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E7EB040>]}
[0m13:47:46.822072 [info ] [Thread-1  ]: 2 of 14 OK created sql table model STAGING.stg_customer ........................ [[32mSUCCESS 1[0m in 1.21s]
[0m13:47:46.837595 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m13:47:46.837595 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_customer_type
[0m13:47:46.837595 [info ] [Thread-1  ]: 3 of 14 START sql table model STAGING.stg_customer_customer_type ............... [RUN]
[0m13:47:46.837595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer, now model.northwind.stg_customer_customer_type)
[0m13:47:46.837595 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_customer_type
[0m13:47:46.837595 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_customer_type"
[0m13:47:46.837595 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (compile): 13:47:46.837595 => 13:47:46.837595
[0m13:47:46.837595 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_customer_type
[0m13:47:46.837595 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_customer_type"
[0m13:47:46.837595 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_customer_type"
[0m13:47:46.837595 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_customer_type
         as
        (
select customer_id,
customer_type_id
from airbyte_database.airbyte_schema.customer_customer_type
        );
[0m13:47:46.837595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:48.177858 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:47:48.177858 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (execute): 13:47:46.837595 => 13:47:48.177858
[0m13:47:48.193524 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: Close
[0m13:47:48.272103 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E810D00>]}
[0m13:47:48.272103 [info ] [Thread-1  ]: 3 of 14 OK created sql table model STAGING.stg_customer_customer_type .......... [[32mSUCCESS 1[0m in 1.43s]
[0m13:47:48.272103 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_customer_type
[0m13:47:48.287727 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_type
[0m13:47:48.287727 [info ] [Thread-1  ]: 4 of 14 START sql table model STAGING.stg_customer_type ........................ [RUN]
[0m13:47:48.287727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_customer_type, now model.northwind.stg_customer_type)
[0m13:47:48.287727 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_type
[0m13:47:48.303811 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_type"
[0m13:47:48.303811 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (compile): 13:47:48.287727 => 13:47:48.303811
[0m13:47:48.303811 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_type
[0m13:47:48.319457 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_type"
[0m13:47:48.319457 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_type"
[0m13:47:48.319457 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m13:47:48.335110 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:50.223902 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:47:50.239582 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (execute): 13:47:48.303811 => 13:47:50.223902
[0m13:47:50.239582 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: Close
[0m13:47:50.644970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E79AA60>]}
[0m13:47:50.647408 [info ] [Thread-1  ]: 4 of 14 OK created sql table model STAGING.stg_customer_type ................... [[32mSUCCESS 1[0m in 2.36s]
[0m13:47:50.650282 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_type
[0m13:47:50.652046 [debug] [Thread-1  ]: Began running node model.northwind.stg_order
[0m13:47:50.654368 [info ] [Thread-1  ]: 5 of 14 START sql table model STAGING.stg_order ................................ [RUN]
[0m13:47:50.657853 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_type, now model.northwind.stg_order)
[0m13:47:50.658934 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order
[0m13:47:50.667068 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order"
[0m13:47:50.669731 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (compile): 13:47:50.660568 => 13:47:50.669193
[0m13:47:50.670801 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order
[0m13:47:50.679099 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order"
[0m13:47:50.683471 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order"
[0m13:47:50.685111 [debug] [Thread-1  ]: On model.northwind.stg_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order"} */
create or replace transient table PROD.STAGING.stg_order
         as
        (
select order_id,
customer_id,
ship_city,
ship_postal_code,
required_date,
freight,
ship_region,
order_date,
shipped_date,
ship_via,
ship_address,
ship_name,
ship_country,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.orders
where _ab_cdc_deleted_at is null
        );
[0m13:47:50.686171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:52.481106 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:47:52.481106 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (execute): 13:47:50.671855 => 13:47:52.481106
[0m13:47:52.481106 [debug] [Thread-1  ]: On model.northwind.stg_order: Close
[0m13:47:52.574484 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E2DDD30>]}
[0m13:47:52.574484 [info ] [Thread-1  ]: 5 of 14 OK created sql table model STAGING.stg_order ........................... [[32mSUCCESS 1[0m in 1.92s]
[0m13:47:52.574484 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order
[0m13:47:52.574484 [debug] [Thread-1  ]: Began running node model.northwind.stg_order_detail
[0m13:47:52.574484 [info ] [Thread-1  ]: 6 of 14 START sql table model STAGING.stg_order_detail ......................... [RUN]
[0m13:47:52.590170 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order, now model.northwind.stg_order_detail)
[0m13:47:52.590170 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order_detail
[0m13:47:52.605738 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order_detail"
[0m13:47:52.605738 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (compile): 13:47:52.590170 => 13:47:52.605738
[0m13:47:52.612255 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order_detail
[0m13:47:52.621824 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order_detail"
[0m13:47:52.621824 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order_detail"
[0m13:47:52.621824 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order_detail"} */
create or replace transient table PROD.STAGING.stg_order_detail
         as
        (
select order_id,
product_id,
unit_price,
quantity,
discount,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.order_details
        );
[0m13:47:52.621824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:54.727565 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:47:54.743214 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (execute): 13:47:52.612255 => 13:47:54.743214
[0m13:47:54.743214 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: Close
[0m13:47:54.821728 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E7F4490>]}
[0m13:47:54.821728 [info ] [Thread-1  ]: 6 of 14 OK created sql table model STAGING.stg_order_detail .................... [[32mSUCCESS 1[0m in 2.23s]
[0m13:47:54.837404 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order_detail
[0m13:47:54.837404 [debug] [Thread-1  ]: Began running node model.northwind.stg_product
[0m13:47:54.837404 [info ] [Thread-1  ]: 7 of 14 START sql table model STAGING.stg_product .............................. [RUN]
[0m13:47:54.837404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order_detail, now model.northwind.stg_product)
[0m13:47:54.837404 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_product
[0m13:47:54.853023 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_product"
[0m13:47:54.853023 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (compile): 13:47:54.837404 => 13:47:54.853023
[0m13:47:54.853023 [debug] [Thread-1  ]: Began executing node model.northwind.stg_product
[0m13:47:54.868664 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_product"
[0m13:47:54.884313 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_product"
[0m13:47:54.884313 [debug] [Thread-1  ]: On model.northwind.stg_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_product"} */
create or replace transient table PROD.STAGING.stg_product
         as
        (
select product_id,
product_name,
unit_price,
reorder_level,
discontinued,
category_id,
units_in_stock,
units_on_order,
quantity_per_unit,
supplier_id
from airbyte_database.airbyte_schema.products
        );
[0m13:47:54.884313 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:56.848817 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:47:56.864787 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (execute): 13:47:54.868664 => 13:47:56.864787
[0m13:47:56.864787 [debug] [Thread-1  ]: On model.northwind.stg_product: Close
[0m13:47:56.959037 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E8580D0>]}
[0m13:47:56.960045 [info ] [Thread-1  ]: 7 of 14 OK created sql table model STAGING.stg_product ......................... [[32mSUCCESS 1[0m in 2.12s]
[0m13:47:56.964037 [debug] [Thread-1  ]: Finished running node model.northwind.stg_product
[0m13:47:56.966043 [debug] [Thread-1  ]: Began running node model.northwind.stg_supplier
[0m13:47:56.968041 [info ] [Thread-1  ]: 8 of 14 START sql table model STAGING.stg_supplier ............................. [RUN]
[0m13:47:56.969037 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_product, now model.northwind.stg_supplier)
[0m13:47:56.970039 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_supplier
[0m13:47:56.972180 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_supplier"
[0m13:47:56.987805 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (compile): 13:47:56.972180 => 13:47:56.972180
[0m13:47:56.989485 [debug] [Thread-1  ]: Began executing node model.northwind.stg_supplier
[0m13:47:56.989485 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_supplier"
[0m13:47:57.003505 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_supplier"
[0m13:47:57.003505 [debug] [Thread-1  ]: On model.northwind.stg_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_supplier"} */
create or replace transient table PROD.STAGING.stg_supplier
         as
        (
select supplier_id,
country,
contact_name,
address,
city,
phone,
company_name,
fax,
region,
postal_code,
contact_title
from airbyte_database.airbyte_schema.suppliers
        );
[0m13:47:57.003505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:59.347270 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:47:59.347270 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (execute): 13:47:56.989485 => 13:47:59.347270
[0m13:47:59.347270 [debug] [Thread-1  ]: On model.northwind.stg_supplier: Close
[0m13:47:59.432201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E78B1C0>]}
[0m13:47:59.441267 [info ] [Thread-1  ]: 8 of 14 OK created sql table model STAGING.stg_supplier ........................ [[32mSUCCESS 1[0m in 2.46s]
[0m13:47:59.441267 [debug] [Thread-1  ]: Finished running node model.northwind.stg_supplier
[0m13:47:59.441267 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m13:47:59.441267 [info ] [Thread-1  ]: 9 of 14 START sql table model CURATED.dim_customer ............................. [RUN]
[0m13:47:59.441267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_supplier, now model.northwind.dim_customer)
[0m13:47:59.441267 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m13:47:59.488294 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer"
[0m13:47:59.503784 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 13:47:59.456915 => 13:47:59.503784
[0m13:47:59.503784 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer
[0m13:47:59.503784 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer"
[0m13:47:59.503784 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer"
[0m13:47:59.503784 [debug] [Thread-1  ]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer"} */
create or replace transient table PROD.CURATED.dim_customer
         as
        (with stg_customer as (
    select customer_id,
    company_name,
    contact_name,
    contact_title,
    address,
    city,
    region,
    postal_code,
    country,
    phone,
    fax
    from PROD.STAGING.stg_customer
)

select
    
    
md5(cast(coalesce(cast(stg_customer.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_customer.customer_id,
    stg_customer.company_name as customer_company_name,
    stg_customer.contact_name as customer_contact_name,
    stg_customer.contact_title as customer_contact_title,
    stg_customer.address as customer_address,
    stg_customer.city as customer_city,
    stg_customer.region as customer_region,
    stg_customer.postal_code as customer_postal_code,
    stg_customer.country as customer_country,
    stg_customer.phone as customer_phone
from stg_customer
        );
[0m13:47:59.503784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:48:01.383873 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:48:01.399476 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (execute): 13:47:59.503784 => 13:48:01.399476
[0m13:48:01.399476 [debug] [Thread-1  ]: On model.northwind.dim_customer: Close
[0m13:48:01.509151 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E7D4F10>]}
[0m13:48:01.509151 [info ] [Thread-1  ]: 9 of 14 OK created sql table model CURATED.dim_customer ........................ [[32mSUCCESS 1[0m in 2.07s]
[0m13:48:01.509151 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m13:48:01.509151 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m13:48:01.509151 [info ] [Thread-1  ]: 10 of 14 START sql table model CURATED.dim_customer_tier ....................... [RUN]
[0m13:48:01.524774 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.dim_customer_tier)
[0m13:48:01.524774 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m13:48:01.541224 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m13:48:01.541224 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 13:48:01.524774 => 13:48:01.541224
[0m13:48:01.541224 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m13:48:01.556371 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m13:48:01.572156 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m13:48:01.572156 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer_tier"} */
create or replace transient table PROD.CURATED.dim_customer_tier
         as
        (with snp_customer_customer_type as (
    select customer_id,
    cast(customer_type_id as integer) as customer_type_id,
    dbt_valid_from,
    dbt_valid_to
    from PROD.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from PROD.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
        );
[0m13:48:01.572156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:48:03.543756 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:48:03.548776 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 13:48:01.541224 => 13:48:03.547868
[0m13:48:03.548776 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m13:48:03.624377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E78B3A0>]}
[0m13:48:03.624377 [info ] [Thread-1  ]: 10 of 14 OK created sql table model CURATED.dim_customer_tier .................. [[32mSUCCESS 1[0m in 2.10s]
[0m13:48:03.626379 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m13:48:03.626379 [debug] [Thread-1  ]: Began running node model.northwind.dim_product
[0m13:48:03.627378 [info ] [Thread-1  ]: 11 of 14 START sql table model CURATED.dim_product ............................. [RUN]
[0m13:48:03.628379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer_tier, now model.northwind.dim_product)
[0m13:48:03.629388 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_product
[0m13:48:03.633388 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_product"
[0m13:48:03.634388 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (compile): 13:48:03.629388 => 13:48:03.634388
[0m13:48:03.635389 [debug] [Thread-1  ]: Began executing node model.northwind.dim_product
[0m13:48:03.637934 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_product"
[0m13:48:03.639399 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_product"
[0m13:48:03.639399 [debug] [Thread-1  ]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_product"} */
create or replace transient table PROD.CURATED.dim_product
         as
        (with stg_product as (
    select cast(product_id as integer) as product_id,
    product_name,
    cast(unit_price as numeric(38,2)) as unit_price,
    cast(reorder_level as integer) as reorder_level,
    cast(discontinued as integer) as discontinued,
    cast(category_id as integer) as category_id,
    cast(units_in_stock as integer) as units_in_stock,
    cast(units_on_order as integer) as units_on_order,
    quantity_per_unit,
    cast(supplier_id as integer) as supplier_id
    from PROD.STAGING.stg_product
),

stg_category as(
    select cast(category_id as integer) as category_id,
    category_name,
    description
    from PROD.STAGING.stg_category
)

select
    
    
md5(cast(coalesce(cast(stg_product.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    stg_product.product_id,
    stg_product.product_name,
    stg_category.category_name,
    stg_product.reorder_level,
    stg_product.discontinued,
    stg_product.units_in_stock,
    stg_product.units_on_order,
    
    
md5(cast(coalesce(cast(stg_product.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key
from stg_product
left join stg_category on stg_product.category_id = stg_category.category_id
        );
[0m13:48:03.639399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:48:04.872536 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:48:04.872536 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (execute): 13:48:03.635389 => 13:48:04.872536
[0m13:48:04.872536 [debug] [Thread-1  ]: On model.northwind.dim_product: Close
[0m13:48:04.971871 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E2DDD30>]}
[0m13:48:04.971871 [info ] [Thread-1  ]: 11 of 14 OK created sql table model CURATED.dim_product ........................ [[32mSUCCESS 1[0m in 1.34s]
[0m13:48:04.971871 [debug] [Thread-1  ]: Finished running node model.northwind.dim_product
[0m13:48:04.971871 [debug] [Thread-1  ]: Began running node model.northwind.dim_supplier
[0m13:48:04.971871 [info ] [Thread-1  ]: 12 of 14 START sql table model CURATED.dim_supplier ............................ [RUN]
[0m13:48:04.971871 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now model.northwind.dim_supplier)
[0m13:48:04.971871 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_supplier
[0m13:48:04.971871 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_supplier"
[0m13:48:04.971871 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (compile): 13:48:04.971871 => 13:48:04.971871
[0m13:48:04.971871 [debug] [Thread-1  ]: Began executing node model.northwind.dim_supplier
[0m13:48:04.971871 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_supplier"
[0m13:48:04.987541 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_supplier"
[0m13:48:04.989223 [debug] [Thread-1  ]: On model.northwind.dim_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_supplier"} */
create or replace transient table PROD.CURATED.dim_supplier
         as
        (with stg_supplier as (
    select cast(supplier_id as integer) as supplier_id,
    country,
    contact_name,
    address,
    city,
    phone,
    company_name,
    fax,
    region,
    postal_code,
    contact_title
    from PROD.STAGING.stg_supplier
)

select
    
    
md5(cast(coalesce(cast(stg_supplier.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key,
    stg_supplier.supplier_id,
    stg_supplier.company_name as supplier_company_name,
    stg_supplier.contact_name as supplier_contact_name,
    stg_supplier.contact_title as supplier_contact_title,
    stg_supplier.address as supplier_address,
    stg_supplier.city as supplier_city,
    stg_supplier.region as supplier_region,
    stg_supplier.postal_code as supplier_postal_code,
    stg_supplier.country as supplier_country,
    stg_supplier.phone as supplier_phone
    from stg_supplier
        );
[0m13:48:04.989726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:48:06.096575 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:48:06.096575 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (execute): 13:48:04.971871 => 13:48:06.096575
[0m13:48:06.112270 [debug] [Thread-1  ]: On model.northwind.dim_supplier: Close
[0m13:48:06.190786 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E8580D0>]}
[0m13:48:06.190786 [info ] [Thread-1  ]: 12 of 14 OK created sql table model CURATED.dim_supplier ....................... [[32mSUCCESS 1[0m in 1.22s]
[0m13:48:06.190786 [debug] [Thread-1  ]: Finished running node model.northwind.dim_supplier
[0m13:48:06.190786 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m13:48:06.190786 [info ] [Thread-1  ]: 13 of 14 START sql incremental model CURATED.fact_order ........................ [RUN]
[0m13:48:06.190786 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_supplier, now model.northwind.fact_order)
[0m13:48:06.190786 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m13:48:06.209395 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m13:48:06.209395 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 13:48:06.190786 => 13:48:06.209395
[0m13:48:06.209395 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m13:48:06.236130 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:48:06.236130 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
create or replace  temporary view PROD.CURATED.fact_order__dbt_tmp
  
   as (
    

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from PROD.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier,
    stg_order_detail.updated_at
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


    where stg_order_detail.updated_at > (select max(updated_at) from PROD.CURATED.fact_order)

  );
[0m13:48:06.236130 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:48:07.274828 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:48:07.290355 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:48:07.290355 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m13:48:07.353188 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m13:48:07.368942 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:48:07.368942 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order
[0m13:48:07.447099 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m13:48:07.463326 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:48:07.463326 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m13:48:07.525940 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m13:48:07.525940 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:48:07.525940 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table "PROD"."CURATED"."FACT_ORDER"
[0m13:48:07.596728 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m13:48:07.599115 [debug] [Thread-1  ]: 
    In "PROD"."CURATED"."FACT_ORDER":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:48:07.614870 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m13:48:07.614870 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:48:07.614870 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
-- back compat for old kwarg name
  
  begin;
[0m13:48:07.709138 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:48:07.709138 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:48:07.709138 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
merge into PROD.CURATED.fact_order as DBT_INTERNAL_DEST
        using PROD.CURATED.fact_order__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_key = DBT_INTERNAL_DEST.order_key
            )

    
    when matched then update set
        "ORDER_KEY" = DBT_INTERNAL_SOURCE."ORDER_KEY","PRODUCT_KEY" = DBT_INTERNAL_SOURCE."PRODUCT_KEY","CUSTOMER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_KEY","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","UNIT_PRICE" = DBT_INTERNAL_SOURCE."UNIT_PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","NORMAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."NORMAL_RETAIL_VALUE","DISCOUNT" = DBT_INTERNAL_SOURCE."DISCOUNT","DISCOUNT_VALUE" = DBT_INTERNAL_SOURCE."DISCOUNT_VALUE","ACTUAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."ACTUAL_RETAIL_VALUE","PRICE_TYPE" = DBT_INTERNAL_SOURCE."PRICE_TYPE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","SHIPPED_DATE" = DBT_INTERNAL_SOURCE."SHIPPED_DATE","REQUIRED_DATE" = DBT_INTERNAL_SOURCE."REQUIRED_DATE","DAYS_TO_SHIP" = DBT_INTERNAL_SOURCE."DAYS_TO_SHIP","CUSTOMER_TIER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER_KEY","CUSTOMER_TIER" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")
    values
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")

;
[0m13:48:08.554325 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:48:08.554325 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:48:08.565394 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
COMMIT
[0m13:48:08.869771 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:48:08.879882 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:48:08.879882 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
drop view if exists PROD.CURATED.fact_order__dbt_tmp cascade
[0m13:48:08.966919 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:48:08.966919 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 13:48:06.209395 => 13:48:08.966919
[0m13:48:08.966919 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m13:48:09.055516 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E8580D0>]}
[0m13:48:09.055516 [info ] [Thread-1  ]: 13 of 14 OK created sql incremental model CURATED.fact_order ................... [[32mSUCCESS 0[0m in 2.86s]
[0m13:48:09.055516 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m13:48:09.055516 [debug] [Thread-1  ]: Began running node model.northwind.preset_obt
[0m13:48:09.055516 [info ] [Thread-1  ]: 14 of 14 START sql table model CURATED.preset_obt .............................. [RUN]
[0m13:48:09.055516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.fact_order, now model.northwind.preset_obt)
[0m13:48:09.069168 [debug] [Thread-1  ]: Began compiling node model.northwind.preset_obt
[0m13:48:09.084917 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:48:09.084917 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.fact_order
[0m13:48:09.084917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:48:09.674804 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 1.0 seconds
[0m13:48:09.674804 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:48:09.674804 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_product
[0m13:48:09.756277 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.0 seconds
[0m13:48:09.764387 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:48:09.764387 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_supplier
[0m13:48:09.826902 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:48:09.842640 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:48:09.842640 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_customer
[0m13:48:09.908831 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:48:09.909841 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.preset_obt"
[0m13:48:09.910873 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (compile): 13:48:09.069168 => 13:48:09.910873
[0m13:48:09.911885 [debug] [Thread-1  ]: Began executing node model.northwind.preset_obt
[0m13:48:09.914876 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.preset_obt"
[0m13:48:09.916842 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:48:09.917876 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
create or replace transient table PROD.CURATED.preset_obt
         as
        (with fact_order as (
    select * from PROD.CURATED.fact_order
),

dim_product as (
    select * from PROD.CURATED.dim_product
),

dim_supplier as (
    select * from PROD.CURATED.dim_supplier
),

dim_customer as (
    select * from PROD.CURATED.dim_customer
)

select
    fact_order."ORDER_ID",
  fact_order."UNIT_PRICE",
  fact_order."QUANTITY",
  fact_order."NORMAL_RETAIL_VALUE",
  fact_order."DISCOUNT",
  fact_order."DISCOUNT_VALUE",
  fact_order."ACTUAL_RETAIL_VALUE",
  fact_order."PRICE_TYPE",
  fact_order."ORDER_DATE",
  fact_order."SHIPPED_DATE",
  fact_order."REQUIRED_DATE",
  fact_order."DAYS_TO_SHIP",
  fact_order."CUSTOMER_TIER",
  fact_order."UPDATED_AT",
    dim_product."PRODUCT_NAME",
  dim_product."CATEGORY_NAME",
  dim_product."REORDER_LEVEL",
  dim_product."DISCONTINUED",
  dim_product."UNITS_IN_STOCK",
  dim_product."UNITS_ON_ORDER",
    dim_supplier."SUPPLIER_ID",
  dim_supplier."SUPPLIER_COMPANY_NAME",
  dim_supplier."SUPPLIER_CONTACT_NAME",
  dim_supplier."SUPPLIER_CONTACT_TITLE",
  dim_supplier."SUPPLIER_ADDRESS",
  dim_supplier."SUPPLIER_CITY",
  dim_supplier."SUPPLIER_REGION",
  dim_supplier."SUPPLIER_POSTAL_CODE",
  dim_supplier."SUPPLIER_COUNTRY",
  dim_supplier."SUPPLIER_PHONE",
    dim_customer."CUSTOMER_COMPANY_NAME",
  dim_customer."CUSTOMER_CONTACT_NAME",
  dim_customer."CUSTOMER_CONTACT_TITLE",
  dim_customer."CUSTOMER_ADDRESS",
  dim_customer."CUSTOMER_CITY",
  dim_customer."CUSTOMER_REGION",
  dim_customer."CUSTOMER_POSTAL_CODE",
  dim_customer."CUSTOMER_COUNTRY",
  dim_customer."CUSTOMER_PHONE"
from fact_order
left join dim_product on fact_order.product_key = dim_product.product_key
left join dim_supplier on dim_product.supplier_key = dim_supplier.supplier_key
left join dim_customer on fact_order.customer_key = dim_customer.customer_key
        );
[0m13:48:11.020524 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:48:11.022763 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (execute): 13:48:09.911885 => 13:48:11.022763
[0m13:48:11.023346 [debug] [Thread-1  ]: On model.northwind.preset_obt: Close
[0m13:48:11.082207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7a8f9f-85ba-4beb-900d-f3e59a31a79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E2DDD30>]}
[0m13:48:11.082207 [info ] [Thread-1  ]: 14 of 14 OK created sql table model CURATED.preset_obt ......................... [[32mSUCCESS 1[0m in 2.03s]
[0m13:48:11.098007 [debug] [Thread-1  ]: Finished running node model.northwind.preset_obt
[0m13:48:11.098007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:11.098007 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m13:48:11.098007 [debug] [MainThread]: Connection 'list_PROD_SNAPSHOT' was properly closed.
[0m13:48:11.098007 [debug] [MainThread]: Connection 'model.northwind.preset_obt' was properly closed.
[0m13:48:11.098007 [info ] [MainThread]: 
[0m13:48:11.098007 [info ] [MainThread]: Finished running 13 table models, 1 incremental model in 0 hours 0 minutes and 31.15 seconds (31.15s).
[0m13:48:11.110865 [debug] [MainThread]: Command end result
[0m13:48:11.119016 [info ] [MainThread]: 
[0m13:48:11.124064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:48:11.124064 [info ] [MainThread]: 
[0m13:48:11.125117 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m13:48:11.126111 [debug] [MainThread]: Command `dbt run` succeeded at 13:48:11.125117 after 32.03 seconds
[0m13:48:11.126111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7E10FC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E92C850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78E9ABD90>]}
[0m13:48:11.127125 [debug] [MainThread]: Flushing usage events
[0m13:49:54.476801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2AFEC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2F347FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2F347F40>]}


============================== 13:49:54.480371 | 53b30dd5-f847-4d6b-aac3-3c81516da51b ==============================
[0m13:49:54.480371 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:49:54.481361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:55.174556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2F347EE0>]}
[0m13:49:55.181055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC57E74580>]}
[0m13:49:55.182011 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m13:49:55.195113 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:49:55.288940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:55.289940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:55.290933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m13:49:55.296931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC581AB0D0>]}
[0m13:49:55.309413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5806CE20>]}
[0m13:49:55.309413 [info ] [MainThread]: Found 14 models, 1 snapshot, 14 tests, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m13:49:55.310420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5806CC10>]}
[0m13:49:55.312412 [info ] [MainThread]: 
[0m13:49:55.314412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:49:55.316413 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m13:49:55.326412 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m13:49:55.326412 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m13:49:55.327412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:56.329647 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:49:56.332644 [debug] [ThreadPool]: On list_PROD: Close
[0m13:49:56.430255 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m13:49:56.430255 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m13:49:56.430255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:57.274547 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:49:57.274547 [debug] [ThreadPool]: On list_PROD: Close
[0m13:49:57.353197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_STAGING'
[0m13:49:57.353197 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m13:49:57.353197 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m13:49:57.353197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:58.214335 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:49:58.214335 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m13:49:58.308406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_SNAPSHOT)
[0m13:49:58.308406 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m13:49:58.308406 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m13:49:58.308406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:58.922854 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:49:58.922854 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m13:49:59.032676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_SNAPSHOT, now list_PROD_CURATED)
[0m13:49:59.032676 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m13:49:59.032676 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m13:49:59.032676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:59.832533 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m13:49:59.832533 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m13:49:59.911398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5806CB80>]}
[0m13:49:59.911398 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:49:59.911398 [info ] [MainThread]: 
[0m13:49:59.911398 [debug] [Thread-1  ]: Began running node model.northwind.stg_category
[0m13:49:59.926847 [info ] [Thread-1  ]: 1 of 14 START sql table model STAGING.stg_category ............................. [RUN]
[0m13:49:59.926847 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_category'
[0m13:49:59.926847 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_category
[0m13:49:59.931991 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_category"
[0m13:49:59.931991 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (compile): 13:49:59.928683 => 13:49:59.931991
[0m13:49:59.931991 [debug] [Thread-1  ]: Began executing node model.northwind.stg_category
[0m13:49:59.951286 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_category"
[0m13:49:59.951286 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_category"
[0m13:49:59.951286 [debug] [Thread-1  ]: On model.northwind.stg_category: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_category"} */
create or replace transient table PROD.STAGING.stg_category
         as
        (
select category_id,
category_name,
description
from airbyte_database.airbyte_schema.categories
        );
[0m13:49:59.951286 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:50:01.614571 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:50:01.620560 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (execute): 13:49:59.931991 => 13:50:01.620560
[0m13:50:01.620560 [debug] [Thread-1  ]: On model.northwind.stg_category: Close
[0m13:50:01.715001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5806C400>]}
[0m13:50:01.730446 [info ] [Thread-1  ]: 1 of 14 OK created sql table model STAGING.stg_category ........................ [[32mSUCCESS 1[0m in 1.79s]
[0m13:50:01.731425 [debug] [Thread-1  ]: Finished running node model.northwind.stg_category
[0m13:50:01.732529 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m13:50:01.734435 [info ] [Thread-1  ]: 2 of 14 START sql table model STAGING.stg_customer ............................. [RUN]
[0m13:50:01.735438 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_category, now model.northwind.stg_customer)
[0m13:50:01.736444 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m13:50:01.740431 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m13:50:01.741433 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 13:50:01.737434 => 13:50:01.741433
[0m13:50:01.741433 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m13:50:01.744431 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m13:50:01.745431 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m13:50:01.745431 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer"} */
create or replace transient table PROD.STAGING.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m13:50:01.745431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.150151 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:50:03.150151 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 13:50:01.742432 => 13:50:03.150151
[0m13:50:03.150151 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m13:50:03.228434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC585E93A0>]}
[0m13:50:03.228434 [info ] [Thread-1  ]: 2 of 14 OK created sql table model STAGING.stg_customer ........................ [[32mSUCCESS 1[0m in 1.49s]
[0m13:50:03.228434 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m13:50:03.228434 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_customer_type
[0m13:50:03.228434 [info ] [Thread-1  ]: 3 of 14 START sql table model STAGING.stg_customer_customer_type ............... [RUN]
[0m13:50:03.228434 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer, now model.northwind.stg_customer_customer_type)
[0m13:50:03.228434 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_customer_type
[0m13:50:03.245806 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_customer_type"
[0m13:50:03.247040 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (compile): 13:50:03.228434 => 13:50:03.247040
[0m13:50:03.247040 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_customer_type
[0m13:50:03.247040 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_customer_type"
[0m13:50:03.247040 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_customer_type"
[0m13:50:03.247040 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_customer_type
         as
        (
select customer_id,
customer_type_id
from airbyte_database.airbyte_schema.customer_customer_type
        );
[0m13:50:03.247040 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.679959 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:50:04.679959 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (execute): 13:50:03.247040 => 13:50:04.679959
[0m13:50:04.679959 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: Close
[0m13:50:04.758161 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC586FDF10>]}
[0m13:50:04.758161 [info ] [Thread-1  ]: 3 of 14 OK created sql table model STAGING.stg_customer_customer_type .......... [[32mSUCCESS 1[0m in 1.53s]
[0m13:50:04.758161 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_customer_type
[0m13:50:04.773705 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_type
[0m13:50:04.773705 [info ] [Thread-1  ]: 4 of 14 START sql table model STAGING.stg_customer_type ........................ [RUN]
[0m13:50:04.773705 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_customer_type, now model.northwind.stg_customer_type)
[0m13:50:04.773705 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_type
[0m13:50:04.773705 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_type"
[0m13:50:04.773705 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (compile): 13:50:04.773705 => 13:50:04.773705
[0m13:50:04.773705 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_type
[0m13:50:04.773705 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_type"
[0m13:50:04.773705 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_type"
[0m13:50:04.773705 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m13:50:04.773705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:05.805657 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:50:05.813779 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (execute): 13:50:04.773705 => 13:50:05.813779
[0m13:50:05.813779 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: Close
[0m13:50:05.892157 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC586EA400>]}
[0m13:50:05.892157 [info ] [Thread-1  ]: 4 of 14 OK created sql table model STAGING.stg_customer_type ................... [[32mSUCCESS 1[0m in 1.12s]
[0m13:50:05.892157 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_type
[0m13:50:05.892157 [debug] [Thread-1  ]: Began running node model.northwind.stg_order
[0m13:50:05.892157 [info ] [Thread-1  ]: 5 of 14 START sql table model STAGING.stg_order ................................ [RUN]
[0m13:50:05.892157 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_type, now model.northwind.stg_order)
[0m13:50:05.892157 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order
[0m13:50:05.905779 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order"
[0m13:50:05.905779 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (compile): 13:50:05.892157 => 13:50:05.905779
[0m13:50:05.905779 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order
[0m13:50:05.909964 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order"
[0m13:50:05.911974 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order"
[0m13:50:05.912619 [debug] [Thread-1  ]: On model.northwind.stg_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order"} */
create or replace transient table PROD.STAGING.stg_order
         as
        (
select order_id,
customer_id,
ship_city,
ship_postal_code,
required_date,
freight,
ship_region,
order_date,
shipped_date,
ship_via,
ship_address,
ship_name,
ship_country,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.orders
where _ab_cdc_deleted_at is null
        );
[0m13:50:05.912619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.440794 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:50:07.440794 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (execute): 13:50:05.905779 => 13:50:07.440794
[0m13:50:07.440794 [debug] [Thread-1  ]: On model.northwind.stg_order: Close
[0m13:50:07.566170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5870A070>]}
[0m13:50:07.566170 [info ] [Thread-1  ]: 5 of 14 OK created sql table model STAGING.stg_order ........................... [[32mSUCCESS 1[0m in 1.67s]
[0m13:50:07.566170 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order
[0m13:50:07.566170 [debug] [Thread-1  ]: Began running node model.northwind.stg_order_detail
[0m13:50:07.566170 [info ] [Thread-1  ]: 6 of 14 START sql table model STAGING.stg_order_detail ......................... [RUN]
[0m13:50:07.566170 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order, now model.northwind.stg_order_detail)
[0m13:50:07.566170 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order_detail
[0m13:50:07.566170 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order_detail"
[0m13:50:07.566170 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (compile): 13:50:07.566170 => 13:50:07.566170
[0m13:50:07.581787 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order_detail
[0m13:50:07.584115 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order_detail"
[0m13:50:07.584115 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order_detail"
[0m13:50:07.584115 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order_detail"} */
create or replace transient table PROD.STAGING.stg_order_detail
         as
        (
select order_id,
product_id,
unit_price,
quantity,
discount,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.order_details
        );
[0m13:50:07.584115 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:09.061636 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:50:09.061636 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (execute): 13:50:07.581787 => 13:50:09.061636
[0m13:50:09.061636 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: Close
[0m13:50:09.140502 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC585752B0>]}
[0m13:50:09.140502 [info ] [Thread-1  ]: 6 of 14 OK created sql table model STAGING.stg_order_detail .................... [[32mSUCCESS 1[0m in 1.57s]
[0m13:50:09.140502 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order_detail
[0m13:50:09.140502 [debug] [Thread-1  ]: Began running node model.northwind.stg_product
[0m13:50:09.140502 [info ] [Thread-1  ]: 7 of 14 START sql table model STAGING.stg_product .............................. [RUN]
[0m13:50:09.140502 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order_detail, now model.northwind.stg_product)
[0m13:50:09.140502 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_product
[0m13:50:09.140502 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_product"
[0m13:50:09.140502 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (compile): 13:50:09.140502 => 13:50:09.140502
[0m13:50:09.155436 [debug] [Thread-1  ]: Began executing node model.northwind.stg_product
[0m13:50:09.160460 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_product"
[0m13:50:09.162445 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_product"
[0m13:50:09.162445 [debug] [Thread-1  ]: On model.northwind.stg_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_product"} */
create or replace transient table PROD.STAGING.stg_product
         as
        (
select product_id,
product_name,
unit_price,
reorder_level,
discontinued,
category_id,
units_in_stock,
units_on_order,
quantity_per_unit,
supplier_id
from airbyte_database.airbyte_schema.products
        );
[0m13:50:09.163450 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:10.415523 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:50:10.424356 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (execute): 13:50:09.155436 => 13:50:10.423443
[0m13:50:10.424356 [debug] [Thread-1  ]: On model.northwind.stg_product: Close
[0m13:50:10.492846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC586F2DC0>]}
[0m13:50:10.492846 [info ] [Thread-1  ]: 7 of 14 OK created sql table model STAGING.stg_product ......................... [[32mSUCCESS 1[0m in 1.35s]
[0m13:50:10.492846 [debug] [Thread-1  ]: Finished running node model.northwind.stg_product
[0m13:50:10.492846 [debug] [Thread-1  ]: Began running node model.northwind.stg_supplier
[0m13:50:10.492846 [info ] [Thread-1  ]: 8 of 14 START sql table model STAGING.stg_supplier ............................. [RUN]
[0m13:50:10.505425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_product, now model.northwind.stg_supplier)
[0m13:50:10.506502 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_supplier
[0m13:50:10.510121 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_supplier"
[0m13:50:10.511168 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (compile): 13:50:10.506502 => 13:50:10.511168
[0m13:50:10.511168 [debug] [Thread-1  ]: Began executing node model.northwind.stg_supplier
[0m13:50:10.511168 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_supplier"
[0m13:50:10.515759 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_supplier"
[0m13:50:10.515759 [debug] [Thread-1  ]: On model.northwind.stg_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_supplier"} */
create or replace transient table PROD.STAGING.stg_supplier
         as
        (
select supplier_id,
country,
contact_name,
address,
city,
phone,
company_name,
fax,
region,
postal_code,
contact_title
from airbyte_database.airbyte_schema.suppliers
        );
[0m13:50:10.515759 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:11.750784 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:50:11.752783 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (execute): 13:50:10.511168 => 13:50:11.752783
[0m13:50:11.753785 [debug] [Thread-1  ]: On model.northwind.stg_supplier: Close
[0m13:50:11.816688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC585915E0>]}
[0m13:50:11.816688 [info ] [Thread-1  ]: 8 of 14 OK created sql table model STAGING.stg_supplier ........................ [[32mSUCCESS 1[0m in 1.31s]
[0m13:50:11.816688 [debug] [Thread-1  ]: Finished running node model.northwind.stg_supplier
[0m13:50:11.816688 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m13:50:11.816688 [info ] [Thread-1  ]: 9 of 14 START sql table model CURATED.dim_customer ............................. [RUN]
[0m13:50:11.831194 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_supplier, now model.northwind.dim_customer)
[0m13:50:11.831194 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m13:50:11.832666 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer"
[0m13:50:11.832666 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 13:50:11.831947 => 13:50:11.832666
[0m13:50:11.832666 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer
[0m13:50:11.832666 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer"
[0m13:50:11.848598 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer"
[0m13:50:11.848598 [debug] [Thread-1  ]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer"} */
create or replace transient table PROD.CURATED.dim_customer
         as
        (with stg_customer as (
    select customer_id,
    company_name,
    contact_name,
    contact_title,
    address,
    city,
    region,
    postal_code,
    country,
    phone,
    fax
    from PROD.STAGING.stg_customer
)

select
    
    
md5(cast(coalesce(cast(stg_customer.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_customer.customer_id,
    stg_customer.company_name as customer_company_name,
    stg_customer.contact_name as customer_contact_name,
    stg_customer.contact_title as customer_contact_title,
    stg_customer.address as customer_address,
    stg_customer.city as customer_city,
    stg_customer.region as customer_region,
    stg_customer.postal_code as customer_postal_code,
    stg_customer.country as customer_country,
    stg_customer.phone as customer_phone
from stg_customer
        );
[0m13:50:11.849611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:12.878060 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:50:12.882127 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (execute): 13:50:11.832666 => 13:50:12.882036
[0m13:50:12.882127 [debug] [Thread-1  ]: On model.northwind.dim_customer: Close
[0m13:50:12.948821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC586F9190>]}
[0m13:50:12.948821 [info ] [Thread-1  ]: 9 of 14 OK created sql table model CURATED.dim_customer ........................ [[32mSUCCESS 1[0m in 1.13s]
[0m13:50:12.948821 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m13:50:12.948821 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m13:50:12.965104 [info ] [Thread-1  ]: 10 of 14 START sql table model CURATED.dim_customer_tier ....................... [RUN]
[0m13:50:12.965104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.dim_customer_tier)
[0m13:50:12.965104 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m13:50:12.970412 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m13:50:12.971429 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 13:50:12.965104 => 13:50:12.971429
[0m13:50:12.972411 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m13:50:12.974429 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m13:50:12.976434 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m13:50:12.976434 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer_tier"} */
create or replace transient table PROD.CURATED.dim_customer_tier
         as
        (with snp_customer_customer_type as (
    select customer_id,
    cast(customer_type_id as integer) as customer_type_id,
    dbt_valid_from,
    dbt_valid_to
    from PROD.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from PROD.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
        );
[0m13:50:12.976434 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:14.502790 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:50:14.522530 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 13:50:12.972411 => 13:50:14.518358
[0m13:50:14.522530 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m13:50:14.596593 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC581D3CA0>]}
[0m13:50:14.596593 [info ] [Thread-1  ]: 10 of 14 OK created sql table model CURATED.dim_customer_tier .................. [[32mSUCCESS 1[0m in 1.63s]
[0m13:50:14.596593 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m13:50:14.596593 [debug] [Thread-1  ]: Began running node model.northwind.dim_product
[0m13:50:14.596593 [info ] [Thread-1  ]: 11 of 14 START sql table model CURATED.dim_product ............................. [RUN]
[0m13:50:14.596593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer_tier, now model.northwind.dim_product)
[0m13:50:14.596593 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_product
[0m13:50:14.614921 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_product"
[0m13:50:14.614921 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (compile): 13:50:14.596593 => 13:50:14.614921
[0m13:50:14.614921 [debug] [Thread-1  ]: Began executing node model.northwind.dim_product
[0m13:50:14.619267 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_product"
[0m13:50:14.619267 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_product"
[0m13:50:14.619267 [debug] [Thread-1  ]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_product"} */
create or replace transient table PROD.CURATED.dim_product
         as
        (with stg_product as (
    select cast(product_id as integer) as product_id,
    product_name,
    cast(unit_price as numeric(38,2)) as unit_price,
    cast(reorder_level as integer) as reorder_level,
    cast(discontinued as integer) as discontinued,
    cast(category_id as integer) as category_id,
    cast(units_in_stock as integer) as units_in_stock,
    cast(units_on_order as integer) as units_on_order,
    quantity_per_unit,
    cast(supplier_id as integer) as supplier_id
    from PROD.STAGING.stg_product
),

stg_category as(
    select cast(category_id as integer) as category_id,
    category_name,
    description
    from PROD.STAGING.stg_category
)

select
    
    
md5(cast(coalesce(cast(stg_product.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    stg_product.product_id,
    stg_product.product_name,
    stg_category.category_name,
    stg_product.reorder_level,
    stg_product.discontinued,
    stg_product.units_in_stock,
    stg_product.units_on_order,
    
    
md5(cast(coalesce(cast(stg_product.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key
from stg_product
left join stg_category on stg_product.category_id = stg_category.category_id
        );
[0m13:50:14.622773 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:15.846831 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:50:15.848824 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (execute): 13:50:14.614921 => 13:50:15.848824
[0m13:50:15.849346 [debug] [Thread-1  ]: On model.northwind.dim_product: Close
[0m13:50:15.921415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC586A4F70>]}
[0m13:50:15.921415 [info ] [Thread-1  ]: 11 of 14 OK created sql table model CURATED.dim_product ........................ [[32mSUCCESS 1[0m in 1.32s]
[0m13:50:15.924924 [debug] [Thread-1  ]: Finished running node model.northwind.dim_product
[0m13:50:15.924924 [debug] [Thread-1  ]: Began running node model.northwind.dim_supplier
[0m13:50:15.924924 [info ] [Thread-1  ]: 12 of 14 START sql table model CURATED.dim_supplier ............................ [RUN]
[0m13:50:15.924924 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now model.northwind.dim_supplier)
[0m13:50:15.924924 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_supplier
[0m13:50:15.924924 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_supplier"
[0m13:50:15.924924 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (compile): 13:50:15.924924 => 13:50:15.924924
[0m13:50:15.924924 [debug] [Thread-1  ]: Began executing node model.northwind.dim_supplier
[0m13:50:15.936931 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_supplier"
[0m13:50:15.939324 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_supplier"
[0m13:50:15.939715 [debug] [Thread-1  ]: On model.northwind.dim_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_supplier"} */
create or replace transient table PROD.CURATED.dim_supplier
         as
        (with stg_supplier as (
    select cast(supplier_id as integer) as supplier_id,
    country,
    contact_name,
    address,
    city,
    phone,
    company_name,
    fax,
    region,
    postal_code,
    contact_title
    from PROD.STAGING.stg_supplier
)

select
    
    
md5(cast(coalesce(cast(stg_supplier.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key,
    stg_supplier.supplier_id,
    stg_supplier.company_name as supplier_company_name,
    stg_supplier.contact_name as supplier_contact_name,
    stg_supplier.contact_title as supplier_contact_title,
    stg_supplier.address as supplier_address,
    stg_supplier.city as supplier_city,
    stg_supplier.region as supplier_region,
    stg_supplier.postal_code as supplier_postal_code,
    stg_supplier.country as supplier_country,
    stg_supplier.phone as supplier_phone
    from stg_supplier
        );
[0m13:50:15.939715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:17.274874 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:50:17.274874 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (execute): 13:50:15.924924 => 13:50:17.274874
[0m13:50:17.274874 [debug] [Thread-1  ]: On model.northwind.dim_supplier: Close
[0m13:50:17.372870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC587A7070>]}
[0m13:50:17.373858 [info ] [Thread-1  ]: 12 of 14 OK created sql table model CURATED.dim_supplier ....................... [[32mSUCCESS 1[0m in 1.45s]
[0m13:50:17.374802 [debug] [Thread-1  ]: Finished running node model.northwind.dim_supplier
[0m13:50:17.375828 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m13:50:17.376823 [info ] [Thread-1  ]: 13 of 14 START sql incremental model CURATED.fact_order ........................ [RUN]
[0m13:50:17.377112 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_supplier, now model.northwind.fact_order)
[0m13:50:17.377112 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m13:50:17.377112 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m13:50:17.377112 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 13:50:17.377112 => 13:50:17.377112
[0m13:50:17.377112 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m13:50:17.413319 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m13:50:17.416342 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:50:17.416342 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
create or replace transient table PROD.CURATED.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from PROD.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier,
    stg_order_detail.updated_at
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m13:50:17.417305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:18.818837 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:50:18.828828 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m13:50:18.830332 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
drop view if exists PROD.CURATED.fact_order__dbt_tmp cascade
[0m13:50:18.881485 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:50:18.881485 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 13:50:17.377112 => 13:50:18.881485
[0m13:50:18.881485 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m13:50:18.966713 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC587AADF0>]}
[0m13:50:18.966713 [info ] [Thread-1  ]: 13 of 14 OK created sql incremental model CURATED.fact_order ................... [[32mSUCCESS 1[0m in 1.59s]
[0m13:50:18.968713 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m13:50:18.969711 [debug] [Thread-1  ]: Began running node model.northwind.preset_obt
[0m13:50:18.970709 [info ] [Thread-1  ]: 14 of 14 START sql table model CURATED.preset_obt .............................. [RUN]
[0m13:50:18.971111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.fact_order, now model.northwind.preset_obt)
[0m13:50:18.971111 [debug] [Thread-1  ]: Began compiling node model.northwind.preset_obt
[0m13:50:18.996798 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:50:18.996798 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.fact_order
[0m13:50:18.998154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:19.923444 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 1.0 seconds
[0m13:50:19.928456 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:50:19.928456 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_product
[0m13:50:19.984525 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.0 seconds
[0m13:50:19.984525 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:50:19.984525 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_supplier
[0m13:50:20.050661 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:50:20.050661 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:50:20.050661 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_customer
[0m13:50:20.134828 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:50:20.135209 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.preset_obt"
[0m13:50:20.135209 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (compile): 13:50:18.971111 => 13:50:20.135209
[0m13:50:20.135209 [debug] [Thread-1  ]: Began executing node model.northwind.preset_obt
[0m13:50:20.135209 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.preset_obt"
[0m13:50:20.135209 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m13:50:20.135209 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
create or replace transient table PROD.CURATED.preset_obt
         as
        (with fact_order as (
    select * from PROD.CURATED.fact_order
),

dim_product as (
    select * from PROD.CURATED.dim_product
),

dim_supplier as (
    select * from PROD.CURATED.dim_supplier
),

dim_customer as (
    select * from PROD.CURATED.dim_customer
)

select
    fact_order."ORDER_ID",
  fact_order."UNIT_PRICE",
  fact_order."QUANTITY",
  fact_order."NORMAL_RETAIL_VALUE",
  fact_order."DISCOUNT",
  fact_order."DISCOUNT_VALUE",
  fact_order."ACTUAL_RETAIL_VALUE",
  fact_order."PRICE_TYPE",
  fact_order."ORDER_DATE",
  fact_order."SHIPPED_DATE",
  fact_order."REQUIRED_DATE",
  fact_order."DAYS_TO_SHIP",
  fact_order."CUSTOMER_TIER",
  fact_order."UPDATED_AT",
    dim_product."PRODUCT_NAME",
  dim_product."CATEGORY_NAME",
  dim_product."REORDER_LEVEL",
  dim_product."DISCONTINUED",
  dim_product."UNITS_IN_STOCK",
  dim_product."UNITS_ON_ORDER",
    dim_supplier."SUPPLIER_ID",
  dim_supplier."SUPPLIER_COMPANY_NAME",
  dim_supplier."SUPPLIER_CONTACT_NAME",
  dim_supplier."SUPPLIER_CONTACT_TITLE",
  dim_supplier."SUPPLIER_ADDRESS",
  dim_supplier."SUPPLIER_CITY",
  dim_supplier."SUPPLIER_REGION",
  dim_supplier."SUPPLIER_POSTAL_CODE",
  dim_supplier."SUPPLIER_COUNTRY",
  dim_supplier."SUPPLIER_PHONE",
    dim_customer."CUSTOMER_COMPANY_NAME",
  dim_customer."CUSTOMER_CONTACT_NAME",
  dim_customer."CUSTOMER_CONTACT_TITLE",
  dim_customer."CUSTOMER_ADDRESS",
  dim_customer."CUSTOMER_CITY",
  dim_customer."CUSTOMER_REGION",
  dim_customer."CUSTOMER_POSTAL_CODE",
  dim_customer."CUSTOMER_COUNTRY",
  dim_customer."CUSTOMER_PHONE"
from fact_order
left join dim_product on fact_order.product_key = dim_product.product_key
left join dim_supplier on dim_product.supplier_key = dim_supplier.supplier_key
left join dim_customer on fact_order.customer_key = dim_customer.customer_key
        );
[0m13:50:21.162329 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:50:21.162329 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (execute): 13:50:20.135209 => 13:50:21.162329
[0m13:50:21.162329 [debug] [Thread-1  ]: On model.northwind.preset_obt: Close
[0m13:50:21.239978 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53b30dd5-f847-4d6b-aac3-3c81516da51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5879CD30>]}
[0m13:50:21.255667 [info ] [Thread-1  ]: 14 of 14 OK created sql table model CURATED.preset_obt ......................... [[32mSUCCESS 1[0m in 2.27s]
[0m13:50:21.255667 [debug] [Thread-1  ]: Finished running node model.northwind.preset_obt
[0m13:50:21.255667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:21.255667 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m13:50:21.255667 [debug] [MainThread]: Connection 'list_PROD_CURATED' was properly closed.
[0m13:50:21.255667 [debug] [MainThread]: Connection 'model.northwind.preset_obt' was properly closed.
[0m13:50:21.255667 [info ] [MainThread]: 
[0m13:50:21.255667 [info ] [MainThread]: Finished running 13 table models, 1 incremental model in 0 hours 0 minutes and 25.94 seconds (25.94s).
[0m13:50:21.264558 [debug] [MainThread]: Command end result
[0m13:50:21.276190 [info ] [MainThread]: 
[0m13:50:21.277190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:21.277190 [info ] [MainThread]: 
[0m13:50:21.278507 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m13:50:21.279513 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:21.279513 after 26.82 seconds
[0m13:50:21.279513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2AFEC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC586811C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC587EA4F0>]}
[0m13:50:21.280634 [debug] [MainThread]: Flushing usage events
[0m22:13:55.199255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF92B0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BFD617FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BFD64D040>]}


============================== 22:13:55.202332 | b47e56cf-2885-4866-ae5f-40cd238abf88 ==============================
[0m22:13:55.202332 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:13:55.206827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_order', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:13:56.811769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b47e56cf-2885-4866-ae5f-40cd238abf88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BFD617FA0>]}
[0m22:13:56.821561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b47e56cf-2885-4866-ae5f-40cd238abf88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA6132F40>]}
[0m22:13:56.824729 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:13:56.861764 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:13:57.746949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:13:57.746949 [debug] [MainThread]: Partial parsing: updated file: northwind://snapshots\snp_customer_customer_type.yml
[0m22:13:57.746949 [debug] [MainThread]: Partial parsing: updated file: northwind://snapshots\snp_customer_customer_type.sql
[0m22:13:57.772692 [debug] [MainThread]: Setting Default Schema: prod
[0m22:13:57.789556 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.northwind.snp_customer_customer_type' (snapshots\snp_customer_customer_type.sql) depends on a source named 'staging.stg_customer_customer_type' which was not found
[0m22:13:57.791565 [debug] [MainThread]: Command `dbt run` failed at 22:13:57.791565 after 2.65 seconds
[0m22:13:57.791565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF92B0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA636CE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA645A040>]}
[0m22:13:57.791565 [debug] [MainThread]: Flushing usage events
[0m22:16:18.982561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3E8FC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F42C57FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F42C57FD0>]}


============================== 22:16:19.001211 | ea82c13d-6d80-41b6-97b0-44621b126603 ==============================
[0m22:16:19.001211 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:16:19.002180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fact_order', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:16:20.317311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea82c13d-6d80-41b6-97b0-44621b126603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F42C57F70>]}
[0m22:16:20.319367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea82c13d-6d80-41b6-97b0-44621b126603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6B7B76D0>]}
[0m22:16:20.319367 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:16:20.349203 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:16:20.500799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:16:20.501801 [debug] [MainThread]: Partial parsing: updated file: northwind://snapshots\snp_customer_customer_type.yml
[0m22:16:20.501801 [debug] [MainThread]: Partial parsing: updated file: northwind://snapshots\snp_customer_customer_type.sql
[0m22:16:20.519760 [debug] [MainThread]: Setting Default Schema: prod
[0m22:16:20.538917 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m22:16:20.538917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea82c13d-6d80-41b6-97b0-44621b126603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6BB7AFA0>]}
[0m22:16:20.604040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea82c13d-6d80-41b6-97b0-44621b126603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F42289D00>]}
[0m22:16:20.604040 [info ] [MainThread]: Found 14 models, 14 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m22:16:20.604040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea82c13d-6d80-41b6-97b0-44621b126603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F40A713D0>]}
[0m22:16:20.604040 [info ] [MainThread]: 
[0m22:16:20.604040 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:16:20.618396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m22:16:20.619938 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m22:16:20.619938 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m22:16:20.619938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:21.677915 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:16:21.677915 [debug] [ThreadPool]: On list_PROD: Close
[0m22:16:21.756834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_SNAPSHOT'
[0m22:16:21.756834 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m22:16:21.756834 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m22:16:21.756834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:22.329410 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:16:22.329410 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m22:16:22.408210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_SNAPSHOT, now list_PROD_CURATED)
[0m22:16:22.408210 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m22:16:22.408210 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m22:16:22.416416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:23.187367 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m22:16:23.187367 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m22:16:23.250641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_CURATED, now list_PROD_STAGING)
[0m22:16:23.250641 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m22:16:23.250641 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m22:16:23.250641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:23.824631 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:16:23.838246 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m22:16:23.916642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea82c13d-6d80-41b6-97b0-44621b126603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F42259EE0>]}
[0m22:16:23.916642 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:16:23.916642 [info ] [MainThread]: 
[0m22:16:23.925576 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m22:16:23.925576 [info ] [Thread-1  ]: 1 of 1 START sql incremental model CURATED.fact_order .......................... [RUN]
[0m22:16:23.925576 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m22:16:23.930420 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m22:16:23.954536 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m22:16:23.955352 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 22:16:23.930420 => 22:16:23.955352
[0m22:16:23.955352 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m22:16:23.994720 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:16:23.994720 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
create or replace  temporary view PROD.CURATED.fact_order__dbt_tmp
  
   as (
    

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from PROD.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier,
    stg_order_detail.updated_at
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


    where stg_order_detail.updated_at > (select max(updated_at) from PROD.CURATED.fact_order)

  );
[0m22:16:23.995718 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:16:24.718792 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:16:24.718792 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:16:24.718792 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m22:16:24.781944 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:16:24.797676 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:16:24.797676 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order
[0m22:16:24.845302 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:16:24.860885 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:16:24.860885 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m22:16:24.926450 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:16:24.926450 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:16:24.926450 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table "PROD"."CURATED"."FACT_ORDER"
[0m22:16:24.988691 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:16:24.988691 [debug] [Thread-1  ]: 
    In "PROD"."CURATED"."FACT_ORDER":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:16:25.017961 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m22:16:25.017961 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:16:25.017961 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
-- back compat for old kwarg name
  
  begin;
[0m22:16:25.096799 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:16:25.096799 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:16:25.096799 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
merge into PROD.CURATED.fact_order as DBT_INTERNAL_DEST
        using PROD.CURATED.fact_order__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_key = DBT_INTERNAL_DEST.order_key
            )

    
    when matched then update set
        "ORDER_KEY" = DBT_INTERNAL_SOURCE."ORDER_KEY","PRODUCT_KEY" = DBT_INTERNAL_SOURCE."PRODUCT_KEY","CUSTOMER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_KEY","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","UNIT_PRICE" = DBT_INTERNAL_SOURCE."UNIT_PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","NORMAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."NORMAL_RETAIL_VALUE","DISCOUNT" = DBT_INTERNAL_SOURCE."DISCOUNT","DISCOUNT_VALUE" = DBT_INTERNAL_SOURCE."DISCOUNT_VALUE","ACTUAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."ACTUAL_RETAIL_VALUE","PRICE_TYPE" = DBT_INTERNAL_SOURCE."PRICE_TYPE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","SHIPPED_DATE" = DBT_INTERNAL_SOURCE."SHIPPED_DATE","REQUIRED_DATE" = DBT_INTERNAL_SOURCE."REQUIRED_DATE","DAYS_TO_SHIP" = DBT_INTERNAL_SOURCE."DAYS_TO_SHIP","CUSTOMER_TIER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER_KEY","CUSTOMER_TIER" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")
    values
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")

;
[0m22:16:26.171093 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m22:16:26.171093 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:16:26.171093 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
COMMIT
[0m22:16:26.328740 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:16:26.337749 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:16:26.337749 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
drop view if exists PROD.CURATED.fact_order__dbt_tmp cascade
[0m22:16:26.432373 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:16:26.448553 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 22:16:23.955352 => 22:16:26.448553
[0m22:16:26.448553 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m22:16:26.511651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea82c13d-6d80-41b6-97b0-44621b126603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6C04EC40>]}
[0m22:16:26.511651 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model CURATED.fact_order ..................... [[32mSUCCESS 0[0m in 2.59s]
[0m22:16:26.511651 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m22:16:26.523770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:26.523770 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m22:16:26.523770 [debug] [MainThread]: Connection 'list_PROD_STAGING' was properly closed.
[0m22:16:26.523770 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m22:16:26.523770 [info ] [MainThread]: 
[0m22:16:26.526778 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m22:16:26.527966 [debug] [MainThread]: Command end result
[0m22:16:26.547136 [info ] [MainThread]: 
[0m22:16:26.548718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:16:26.548718 [info ] [MainThread]: 
[0m22:16:26.548718 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:16:26.548718 [debug] [MainThread]: Command `dbt run` succeeded at 22:16:26.548718 after 7.58 seconds
[0m22:16:26.548718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F3E8FC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F42289D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F42D124C0>]}
[0m22:16:26.548718 [debug] [MainThread]: Flushing usage events
[0m22:17:03.054248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001326D06C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132713C7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132713FD040>]}


============================== 22:17:03.054248 | 59e36691-464f-44f8-8086-7e76b14f0436 ==============================
[0m22:17:03.054248 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:17:03.059757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_customer_tier', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:17:03.902384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59e36691-464f-44f8-8086-7e76b14f0436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132713C7FA0>]}
[0m22:17:03.910108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59e36691-464f-44f8-8086-7e76b14f0436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013219F3E0A0>]}
[0m22:17:03.911117 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:17:03.927476 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:17:04.081952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:04.082968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:04.083954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m22:17:04.089691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59e36691-464f-44f8-8086-7e76b14f0436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001321A22B0D0>]}
[0m22:17:04.106644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59e36691-464f-44f8-8086-7e76b14f0436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013219F79370>]}
[0m22:17:04.107659 [info ] [MainThread]: Found 14 models, 14 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m22:17:04.108656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59e36691-464f-44f8-8086-7e76b14f0436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013219F790D0>]}
[0m22:17:04.109653 [info ] [MainThread]: 
[0m22:17:04.110713 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:17:04.112721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m22:17:04.119734 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m22:17:04.119734 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m22:17:04.119734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:05.099603 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:17:05.105892 [debug] [ThreadPool]: On list_PROD: Close
[0m22:17:05.169884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_STAGING'
[0m22:17:05.179773 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m22:17:05.179773 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m22:17:05.179773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:06.019986 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:17:06.029652 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m22:17:06.089693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_SNAPSHOT)
[0m22:17:06.099561 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m22:17:06.099561 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m22:17:06.099561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:06.729848 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:17:06.739606 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m22:17:06.803475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_SNAPSHOT, now list_PROD_CURATED)
[0m22:17:06.809562 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m22:17:06.809562 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m22:17:06.809562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:07.446855 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m22:17:07.446855 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m22:17:07.519895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59e36691-464f-44f8-8086-7e76b14f0436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132199C9FD0>]}
[0m22:17:07.519895 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:17:07.519895 [info ] [MainThread]: 
[0m22:17:07.526651 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m22:17:07.528180 [info ] [Thread-1  ]: 1 of 1 START sql table model CURATED.dim_customer_tier ......................... [RUN]
[0m22:17:07.528180 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.dim_customer_tier'
[0m22:17:07.530065 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m22:17:07.546354 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m22:17:07.549865 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 22:17:07.530065 => 22:17:07.549865
[0m22:17:07.549865 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m22:17:07.569654 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m22:17:07.579643 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m22:17:07.580157 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer_tier"} */
create or replace transient table PROD.CURATED.dim_customer_tier
         as
        (with snp_customer_customer_type as (
    select customer_id,
    cast(customer_type_id as integer) as customer_type_id,
    dbt_valid_from,
    dbt_valid_to
    from PROD.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from PROD.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
        );
[0m22:17:07.581482 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:17:09.018102 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:17:09.033969 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 22:17:07.549865 => 22:17:09.033969
[0m22:17:09.034997 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m22:17:09.115402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59e36691-464f-44f8-8086-7e76b14f0436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001321A663C40>]}
[0m22:17:09.120215 [info ] [Thread-1  ]: 1 of 1 OK created sql table model CURATED.dim_customer_tier .................... [[32mSUCCESS 1[0m in 1.59s]
[0m22:17:09.120215 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m22:17:09.120215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:09.120215 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m22:17:09.120215 [debug] [MainThread]: Connection 'list_PROD_CURATED' was properly closed.
[0m22:17:09.124829 [debug] [MainThread]: Connection 'model.northwind.dim_customer_tier' was properly closed.
[0m22:17:09.124829 [info ] [MainThread]: 
[0m22:17:09.124829 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m22:17:09.127389 [debug] [MainThread]: Command end result
[0m22:17:09.133933 [info ] [MainThread]: 
[0m22:17:09.140223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:09.140223 [info ] [MainThread]: 
[0m22:17:09.140223 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:17:09.140223 [debug] [MainThread]: Command `dbt run` succeeded at 22:17:09.140223 after 6.10 seconds
[0m22:17:09.140223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001326D06C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001321A0E3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013219F3E0A0>]}
[0m22:17:09.140223 [debug] [MainThread]: Flushing usage events
[0m22:17:13.694291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F153F105E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F158277FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1582AD070>]}


============================== 22:17:13.694291 | 424a9cbb-d8be-4c40-ad81-035ae1f8a88c ==============================
[0m22:17:13.694291 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:17:13.694291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_order', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:17:14.679493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '424a9cbb-d8be-4c40-ad81-035ae1f8a88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F158277400>]}
[0m22:17:14.679493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '424a9cbb-d8be-4c40-ad81-035ae1f8a88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17FE1F100>]}
[0m22:17:14.679493 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:17:14.695222 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:17:14.811817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:14.811817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:14.826280 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m22:17:14.829748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '424a9cbb-d8be-4c40-ad81-035ae1f8a88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10110A0D0>]}
[0m22:17:14.845103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '424a9cbb-d8be-4c40-ad81-035ae1f8a88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17FE50310>]}
[0m22:17:14.845103 [info ] [MainThread]: Found 14 models, 14 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m22:17:14.845103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '424a9cbb-d8be-4c40-ad81-035ae1f8a88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17FE50070>]}
[0m22:17:14.845103 [info ] [MainThread]: 
[0m22:17:14.845103 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:17:14.845103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m22:17:14.862683 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m22:17:14.862683 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m22:17:14.862683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:15.586168 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:17:15.586168 [debug] [ThreadPool]: On list_PROD: Close
[0m22:17:15.669929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_SNAPSHOT'
[0m22:17:15.677180 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m22:17:15.677732 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m22:17:15.678273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:16.550007 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:17:16.550007 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m22:17:16.624994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_SNAPSHOT, now list_PROD_CURATED)
[0m22:17:16.624994 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m22:17:16.624994 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m22:17:16.624994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:17.314357 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m22:17:17.314357 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m22:17:17.424370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_CURATED, now list_PROD_STAGING)
[0m22:17:17.439907 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m22:17:17.439907 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m22:17:17.439907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:18.227593 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:17:18.228712 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m22:17:18.544213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '424a9cbb-d8be-4c40-ad81-035ae1f8a88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17F8B3040>]}
[0m22:17:18.544213 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:17:18.544213 [info ] [MainThread]: 
[0m22:17:18.544213 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m22:17:18.544213 [info ] [Thread-1  ]: 1 of 1 START sql incremental model CURATED.fact_order .......................... [RUN]
[0m22:17:18.559220 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m22:17:18.559861 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m22:17:18.572020 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m22:17:18.587436 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 22:17:18.559861 => 22:17:18.587436
[0m22:17:18.587436 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m22:17:18.627905 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:17:18.627905 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
create or replace  temporary view PROD.CURATED.fact_order__dbt_tmp
  
   as (
    

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from PROD.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier,
    stg_order_detail.updated_at
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


    where stg_order_detail.updated_at > (select max(updated_at) from PROD.CURATED.fact_order)

  );
[0m22:17:18.628924 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:17:19.370391 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:17:19.370391 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:17:19.370391 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m22:17:19.433390 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:17:19.433390 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:17:19.433390 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order
[0m22:17:19.495960 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:17:19.511762 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:17:19.511762 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m22:17:19.574440 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:17:19.574440 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:17:19.574440 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table "PROD"."CURATED"."FACT_ORDER"
[0m22:17:19.637202 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:17:19.652872 [debug] [Thread-1  ]: 
    In "PROD"."CURATED"."FACT_ORDER":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:17:19.699738 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m22:17:19.699738 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:17:19.699738 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
-- back compat for old kwarg name
  
  begin;
[0m22:17:19.768917 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:17:19.768917 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:17:19.768917 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
merge into PROD.CURATED.fact_order as DBT_INTERNAL_DEST
        using PROD.CURATED.fact_order__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_key = DBT_INTERNAL_DEST.order_key
            )

    
    when matched then update set
        "ORDER_KEY" = DBT_INTERNAL_SOURCE."ORDER_KEY","PRODUCT_KEY" = DBT_INTERNAL_SOURCE."PRODUCT_KEY","CUSTOMER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_KEY","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","UNIT_PRICE" = DBT_INTERNAL_SOURCE."UNIT_PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","NORMAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."NORMAL_RETAIL_VALUE","DISCOUNT" = DBT_INTERNAL_SOURCE."DISCOUNT","DISCOUNT_VALUE" = DBT_INTERNAL_SOURCE."DISCOUNT_VALUE","ACTUAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."ACTUAL_RETAIL_VALUE","PRICE_TYPE" = DBT_INTERNAL_SOURCE."PRICE_TYPE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","SHIPPED_DATE" = DBT_INTERNAL_SOURCE."SHIPPED_DATE","REQUIRED_DATE" = DBT_INTERNAL_SOURCE."REQUIRED_DATE","DAYS_TO_SHIP" = DBT_INTERNAL_SOURCE."DAYS_TO_SHIP","CUSTOMER_TIER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER_KEY","CUSTOMER_TIER" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")
    values
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")

;
[0m22:17:20.482436 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m22:17:20.482436 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:17:20.497969 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
COMMIT
[0m22:17:20.656898 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:17:20.671928 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:17:20.671928 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
drop view if exists PROD.CURATED.fact_order__dbt_tmp cascade
[0m22:17:20.783903 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:17:20.819564 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 22:17:18.587436 => 22:17:20.819564
[0m22:17:20.820564 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m22:17:20.938058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424a9cbb-d8be-4c40-ad81-035ae1f8a88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1011275E0>]}
[0m22:17:20.939080 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model CURATED.fact_order ..................... [[32mSUCCESS 0[0m in 2.39s]
[0m22:17:20.940588 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m22:17:20.943200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:20.945314 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m22:17:20.946301 [debug] [MainThread]: Connection 'list_PROD_STAGING' was properly closed.
[0m22:17:20.947339 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m22:17:20.949342 [info ] [MainThread]: 
[0m22:17:20.949972 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.10 seconds (6.10s).
[0m22:17:20.951023 [debug] [MainThread]: Command end result
[0m22:17:20.969312 [info ] [MainThread]: 
[0m22:17:20.970243 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:20.970243 [info ] [MainThread]: 
[0m22:17:20.971205 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:17:20.972206 [debug] [MainThread]: Command `dbt run` succeeded at 22:17:20.972206 after 7.29 seconds
[0m22:17:20.973204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F153F105E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17FE1F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F17FFBF040>]}
[0m22:17:20.974209 [debug] [MainThread]: Flushing usage events
[0m22:18:51.075613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B42DC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B8617F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B8617F70>]}


============================== 22:18:51.079596 | 22667ed8-a34a-424b-8a68-c13328f7dc98 ==============================
[0m22:18:51.079596 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:18:51.079596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_order', 'send_anonymous_usage_stats': 'True'}
[0m22:18:52.061331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22667ed8-a34a-424b-8a68-c13328f7dc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B8617F10>]}
[0m22:18:52.076965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22667ed8-a34a-424b-8a68-c13328f7dc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175E11A9FD0>]}
[0m22:18:52.076965 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:18:52.095238 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:18:52.214594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:52.215570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:52.216532 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m22:18:52.222905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22667ed8-a34a-424b-8a68-c13328f7dc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175E14AB0D0>]}
[0m22:18:52.222905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22667ed8-a34a-424b-8a68-c13328f7dc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175E136FE80>]}
[0m22:18:52.222905 [info ] [MainThread]: Found 14 models, 14 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m22:18:52.222905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22667ed8-a34a-424b-8a68-c13328f7dc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175E136FC70>]}
[0m22:18:52.222905 [info ] [MainThread]: 
[0m22:18:52.238662 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:18:52.240456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m22:18:52.241087 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m22:18:52.241087 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m22:18:52.241087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:53.248967 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:18:53.248967 [debug] [ThreadPool]: On list_PROD: Close
[0m22:18:53.326219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_CURATED'
[0m22:18:53.336357 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m22:18:53.336357 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m22:18:53.336357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:54.106163 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m22:18:54.106163 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m22:18:54.184716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_CURATED, now list_PROD_STAGING)
[0m22:18:54.184716 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m22:18:54.184716 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m22:18:54.184716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:54.770664 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:18:54.770664 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m22:18:54.851289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_SNAPSHOT)
[0m22:18:54.851289 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m22:18:54.851289 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m22:18:54.858069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:55.414076 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:18:55.414076 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m22:18:55.477117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22667ed8-a34a-424b-8a68-c13328f7dc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175E0C4BF40>]}
[0m22:18:55.477117 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:18:55.477117 [info ] [MainThread]: 
[0m22:18:55.477117 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m22:18:55.477117 [info ] [Thread-1  ]: 1 of 1 START sql incremental model CURATED.fact_order .......................... [RUN]
[0m22:18:55.477117 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m22:18:55.477117 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m22:18:55.502536 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m22:18:55.502536 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 22:18:55.492280 => 22:18:55.502536
[0m22:18:55.515264 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m22:18:55.534011 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:18:55.548778 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
create or replace  temporary view PROD.CURATED.fact_order__dbt_tmp
  
   as (
    

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from PROD.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier,
    stg_order_detail.updated_at
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


    where stg_order_detail.updated_at > (select max(updated_at) from PROD.CURATED.fact_order)

  );
[0m22:18:55.549847 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:18:56.241977 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:18:56.241977 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:18:56.241977 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m22:18:56.320272 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:18:56.320272 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:18:56.320272 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order
[0m22:18:56.367416 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:18:56.383133 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:18:56.383133 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m22:18:56.452357 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:18:56.452357 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:18:56.452357 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table "PROD"."CURATED"."FACT_ORDER"
[0m22:18:56.498950 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:18:56.517855 [debug] [Thread-1  ]: 
    In "PROD"."CURATED"."FACT_ORDER":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:18:56.536415 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m22:18:56.536415 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:18:56.536415 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
-- back compat for old kwarg name
  
  begin;
[0m22:18:56.609567 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:18:56.609567 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:18:56.609567 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
merge into PROD.CURATED.fact_order as DBT_INTERNAL_DEST
        using PROD.CURATED.fact_order__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_key = DBT_INTERNAL_DEST.order_key
            )

    
    when matched then update set
        "ORDER_KEY" = DBT_INTERNAL_SOURCE."ORDER_KEY","PRODUCT_KEY" = DBT_INTERNAL_SOURCE."PRODUCT_KEY","CUSTOMER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_KEY","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","UNIT_PRICE" = DBT_INTERNAL_SOURCE."UNIT_PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","NORMAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."NORMAL_RETAIL_VALUE","DISCOUNT" = DBT_INTERNAL_SOURCE."DISCOUNT","DISCOUNT_VALUE" = DBT_INTERNAL_SOURCE."DISCOUNT_VALUE","ACTUAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."ACTUAL_RETAIL_VALUE","PRICE_TYPE" = DBT_INTERNAL_SOURCE."PRICE_TYPE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","SHIPPED_DATE" = DBT_INTERNAL_SOURCE."SHIPPED_DATE","REQUIRED_DATE" = DBT_INTERNAL_SOURCE."REQUIRED_DATE","DAYS_TO_SHIP" = DBT_INTERNAL_SOURCE."DAYS_TO_SHIP","CUSTOMER_TIER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER_KEY","CUSTOMER_TIER" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")
    values
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")

;
[0m22:18:57.134166 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m22:18:57.142196 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:18:57.142196 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
COMMIT
[0m22:18:57.319567 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:18:57.326700 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:18:57.326700 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
drop view if exists PROD.CURATED.fact_order__dbt_tmp cascade
[0m22:18:57.419356 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:18:57.435034 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 22:18:55.515264 => 22:18:57.435034
[0m22:18:57.435034 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m22:18:57.507113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22667ed8-a34a-424b-8a68-c13328f7dc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175E17D98B0>]}
[0m22:18:57.508117 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model CURATED.fact_order ..................... [[32mSUCCESS 0[0m in 2.03s]
[0m22:18:57.510009 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m22:18:57.512010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:57.512010 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m22:18:57.513023 [debug] [MainThread]: Connection 'list_PROD_SNAPSHOT' was properly closed.
[0m22:18:57.513023 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m22:18:57.513732 [info ] [MainThread]: 
[0m22:18:57.513732 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m22:18:57.513732 [debug] [MainThread]: Command end result
[0m22:18:57.530319 [info ] [MainThread]: 
[0m22:18:57.531500 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:18:57.532540 [info ] [MainThread]: 
[0m22:18:57.533107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:18:57.534164 [debug] [MainThread]: Command `dbt run` succeeded at 22:18:57.534164 after 6.47 seconds
[0m22:18:57.534683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B42DC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175E11A9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175E19C69D0>]}
[0m22:18:57.535192 [debug] [MainThread]: Flushing usage events
[0m22:28:07.949274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F2AA90100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F2EDF7FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F2EE2C370>]}


============================== 22:28:07.955050 | 513da4bf-654d-46a0-94bf-3f4cdf632b09 ==============================
[0m22:28:07.955050 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:28:07.957013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:28:09.287383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F2EDF7430>]}
[0m22:28:09.287383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F57968DF0>]}
[0m22:28:09.287383 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:28:09.310185 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:28:09.444964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:28:09.445875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:28:09.446836 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m22:28:09.452921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F57C580D0>]}
[0m22:28:09.461400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F579B02B0>]}
[0m22:28:09.461400 [info ] [MainThread]: Found 14 models, 14 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m22:28:09.461400 [info ] [MainThread]: 
[0m22:28:09.475081 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:28:09.476981 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m22:28:09.480311 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m22:28:09.480311 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m22:28:09.480311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:10.630229 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:28:10.630229 [debug] [ThreadPool]: On list_PROD: Close
[0m22:28:10.771462 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m22:28:10.771462 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m22:28:10.771462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:11.605967 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:28:11.605967 [debug] [ThreadPool]: On list_PROD: Close
[0m22:28:11.707037 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m22:28:11.707037 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m22:28:11.707037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:12.311132 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:28:12.311132 [debug] [ThreadPool]: On list_PROD: Close
[0m22:28:12.389679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_SNAPSHOT'
[0m22:28:12.405349 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m22:28:12.405349 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m22:28:12.405349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:13.022009 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:13.022009 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m22:28:13.084950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_SNAPSHOT, now list_PROD_STAGING)
[0m22:28:13.100637 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m22:28:13.100637 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m22:28:13.100637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:13.694391 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:28:13.694391 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m22:28:13.756852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_CURATED)
[0m22:28:13.767367 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m22:28:13.772915 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m22:28:13.773887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:14.399611 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m22:28:14.399611 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m22:28:14.509487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F57981430>]}
[0m22:28:14.525170 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:28:14.525170 [info ] [MainThread]: 
[0m22:28:14.525170 [debug] [Thread-1  ]: Began running node model.northwind.stg_category
[0m22:28:14.525170 [info ] [Thread-1  ]: 1 of 29 START sql table model STAGING.stg_category ............................. [RUN]
[0m22:28:14.525170 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.stg_category'
[0m22:28:14.535271 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_category
[0m22:28:14.539330 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_category"
[0m22:28:14.539330 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (compile): 22:28:14.535271 => 22:28:14.539330
[0m22:28:14.539330 [debug] [Thread-1  ]: Began executing node model.northwind.stg_category
[0m22:28:14.557664 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_category"
[0m22:28:14.557664 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_category"
[0m22:28:14.557664 [debug] [Thread-1  ]: On model.northwind.stg_category: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_category"} */
create or replace transient table PROD.STAGING.stg_category
         as
        (
select category_id,
category_name,
description
from airbyte_database.airbyte_schema.categories
        );
[0m22:28:14.557664 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:28:15.957672 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:15.973722 [debug] [Thread-1  ]: Timing info for model.northwind.stg_category (execute): 22:28:14.539330 => 22:28:15.973722
[0m22:28:15.973722 [debug] [Thread-1  ]: On model.northwind.stg_category: Close
[0m22:28:16.036237 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F58146C70>]}
[0m22:28:16.036237 [info ] [Thread-1  ]: 1 of 29 OK created sql table model STAGING.stg_category ........................ [[32mSUCCESS 1[0m in 1.51s]
[0m22:28:16.036237 [debug] [Thread-1  ]: Finished running node model.northwind.stg_category
[0m22:28:16.036237 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer
[0m22:28:16.036237 [info ] [Thread-1  ]: 2 of 29 START sql table model STAGING.stg_customer ............................. [RUN]
[0m22:28:16.036237 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_category, now model.northwind.stg_customer)
[0m22:28:16.036237 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer
[0m22:28:16.053245 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer"
[0m22:28:16.054263 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (compile): 22:28:16.036237 => 22:28:16.054263
[0m22:28:16.054856 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer
[0m22:28:16.054856 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer"
[0m22:28:16.054856 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer"
[0m22:28:16.054856 [debug] [Thread-1  ]: On model.northwind.stg_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer"} */
create or replace transient table PROD.STAGING.stg_customer
         as
        (
select customer_id,
company_name,
contact_name,
contact_title,
address,
city,
region,
postal_code,
country,
phone,
fax
from airbyte_database.airbyte_schema.customers
        );
[0m22:28:16.054856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:17.495123 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:17.495123 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer (execute): 22:28:16.054856 => 22:28:17.495123
[0m22:28:17.495123 [debug] [Thread-1  ]: On model.northwind.stg_customer: Close
[0m22:28:17.651797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F581908E0>]}
[0m22:28:17.651797 [info ] [Thread-1  ]: 2 of 29 OK created sql table model STAGING.stg_customer ........................ [[32mSUCCESS 1[0m in 1.62s]
[0m22:28:17.651797 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer
[0m22:28:17.651797 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_customer_type
[0m22:28:17.651797 [info ] [Thread-1  ]: 3 of 29 START sql table model STAGING.stg_customer_customer_type ............... [RUN]
[0m22:28:17.651797 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer, now model.northwind.stg_customer_customer_type)
[0m22:28:17.651797 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_customer_type
[0m22:28:17.667416 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_customer_type"
[0m22:28:17.669077 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (compile): 22:28:17.651797 => 22:28:17.669077
[0m22:28:17.669077 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_customer_type
[0m22:28:17.670420 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_customer_type"
[0m22:28:17.670420 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_customer_type"
[0m22:28:17.670420 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_customer_type
         as
        (
select customer_id,
customer_type_id
from airbyte_database.airbyte_schema.customer_customer_type
        );
[0m22:28:17.670420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:18.854480 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:18.870178 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_customer_type (execute): 22:28:17.670420 => 22:28:18.870178
[0m22:28:18.870178 [debug] [Thread-1  ]: On model.northwind.stg_customer_customer_type: Close
[0m22:28:19.028313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F58140490>]}
[0m22:28:19.028313 [info ] [Thread-1  ]: 3 of 29 OK created sql table model STAGING.stg_customer_customer_type .......... [[32mSUCCESS 1[0m in 1.38s]
[0m22:28:19.028313 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_customer_type
[0m22:28:19.028313 [debug] [Thread-1  ]: Began running node model.northwind.stg_customer_type
[0m22:28:19.043956 [info ] [Thread-1  ]: 4 of 29 START sql table model STAGING.stg_customer_type ........................ [RUN]
[0m22:28:19.043956 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_customer_type, now model.northwind.stg_customer_type)
[0m22:28:19.043956 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_customer_type
[0m22:28:19.043956 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_customer_type"
[0m22:28:19.043956 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (compile): 22:28:19.043956 => 22:28:19.043956
[0m22:28:19.043956 [debug] [Thread-1  ]: Began executing node model.northwind.stg_customer_type
[0m22:28:19.043956 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_customer_type"
[0m22:28:19.043956 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_customer_type"
[0m22:28:19.043956 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_customer_type"} */
create or replace transient table PROD.STAGING.stg_customer_type
         as
        (
select customer_type_id,
customer_desc
from airbyte_database.airbyte_schema.customer_type
        );
[0m22:28:19.043956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:20.528549 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:20.528549 [debug] [Thread-1  ]: Timing info for model.northwind.stg_customer_type (execute): 22:28:19.043956 => 22:28:20.528549
[0m22:28:20.528549 [debug] [Thread-1  ]: On model.northwind.stg_customer_type: Close
[0m22:28:20.706427 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F581CD820>]}
[0m22:28:20.706427 [info ] [Thread-1  ]: 4 of 29 OK created sql table model STAGING.stg_customer_type ................... [[32mSUCCESS 1[0m in 1.66s]
[0m22:28:20.706427 [debug] [Thread-1  ]: Finished running node model.northwind.stg_customer_type
[0m22:28:20.706427 [debug] [Thread-1  ]: Began running node model.northwind.stg_order
[0m22:28:20.706427 [info ] [Thread-1  ]: 5 of 29 START sql table model STAGING.stg_order ................................ [RUN]
[0m22:28:20.706427 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_customer_type, now model.northwind.stg_order)
[0m22:28:20.706427 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order
[0m22:28:20.706427 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order"
[0m22:28:20.706427 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (compile): 22:28:20.706427 => 22:28:20.706427
[0m22:28:20.706427 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order
[0m22:28:20.706427 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order"
[0m22:28:20.706427 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order"
[0m22:28:20.722008 [debug] [Thread-1  ]: On model.northwind.stg_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order"} */
create or replace transient table PROD.STAGING.stg_order
         as
        (
select order_id,
customer_id,
ship_city,
ship_postal_code,
required_date,
freight,
ship_region,
order_date,
shipped_date,
ship_via,
ship_address,
ship_name,
ship_country,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.orders
where _ab_cdc_deleted_at is null
        );
[0m22:28:20.722008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:22.362739 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:28:22.362739 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order (execute): 22:28:20.706427 => 22:28:22.362739
[0m22:28:22.362739 [debug] [Thread-1  ]: On model.northwind.stg_order: Close
[0m22:28:22.505296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F581A2220>]}
[0m22:28:22.505296 [info ] [Thread-1  ]: 5 of 29 OK created sql table model STAGING.stg_order ........................... [[32mSUCCESS 1[0m in 1.80s]
[0m22:28:22.505296 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order
[0m22:28:22.505296 [debug] [Thread-1  ]: Began running node model.northwind.stg_order_detail
[0m22:28:22.520929 [info ] [Thread-1  ]: 6 of 29 START sql table model STAGING.stg_order_detail ......................... [RUN]
[0m22:28:22.520929 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order, now model.northwind.stg_order_detail)
[0m22:28:22.520929 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_order_detail
[0m22:28:22.520929 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_order_detail"
[0m22:28:22.520929 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (compile): 22:28:22.520929 => 22:28:22.520929
[0m22:28:22.520929 [debug] [Thread-1  ]: Began executing node model.northwind.stg_order_detail
[0m22:28:22.520929 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_order_detail"
[0m22:28:22.520929 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_order_detail"
[0m22:28:22.520929 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_order_detail"} */
create or replace transient table PROD.STAGING.stg_order_detail
         as
        (
select order_id,
product_id,
unit_price,
quantity,
discount,
_ab_cdc_updated_at as updated_at
from airbyte_database.airbyte_schema.order_details
        );
[0m22:28:22.520929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:23.614076 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:23.614076 [debug] [Thread-1  ]: Timing info for model.northwind.stg_order_detail (execute): 22:28:22.520929 => 22:28:23.614076
[0m22:28:23.614076 [debug] [Thread-1  ]: On model.northwind.stg_order_detail: Close
[0m22:28:23.739549 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F581A2D90>]}
[0m22:28:23.739549 [info ] [Thread-1  ]: 6 of 29 OK created sql table model STAGING.stg_order_detail .................... [[32mSUCCESS 1[0m in 1.22s]
[0m22:28:23.739549 [debug] [Thread-1  ]: Finished running node model.northwind.stg_order_detail
[0m22:28:23.739549 [debug] [Thread-1  ]: Began running node model.northwind.stg_product
[0m22:28:23.739549 [info ] [Thread-1  ]: 7 of 29 START sql table model STAGING.stg_product .............................. [RUN]
[0m22:28:23.755241 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_order_detail, now model.northwind.stg_product)
[0m22:28:23.755241 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_product
[0m22:28:23.755241 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_product"
[0m22:28:23.755241 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (compile): 22:28:23.755241 => 22:28:23.755241
[0m22:28:23.755241 [debug] [Thread-1  ]: Began executing node model.northwind.stg_product
[0m22:28:23.755241 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_product"
[0m22:28:23.755241 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_product"
[0m22:28:23.755241 [debug] [Thread-1  ]: On model.northwind.stg_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_product"} */
create or replace transient table PROD.STAGING.stg_product
         as
        (
select product_id,
product_name,
unit_price,
reorder_level,
discontinued,
category_id,
units_in_stock,
units_on_order,
quantity_per_unit,
supplier_id
from airbyte_database.airbyte_schema.products
        );
[0m22:28:23.755241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:24.998516 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:25.002480 [debug] [Thread-1  ]: Timing info for model.northwind.stg_product (execute): 22:28:23.755241 => 22:28:25.002480
[0m22:28:25.003493 [debug] [Thread-1  ]: On model.northwind.stg_product: Close
[0m22:28:25.067145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F58183040>]}
[0m22:28:25.067145 [info ] [Thread-1  ]: 7 of 29 OK created sql table model STAGING.stg_product ......................... [[32mSUCCESS 1[0m in 1.31s]
[0m22:28:25.067145 [debug] [Thread-1  ]: Finished running node model.northwind.stg_product
[0m22:28:25.067145 [debug] [Thread-1  ]: Began running node model.northwind.stg_supplier
[0m22:28:25.067145 [info ] [Thread-1  ]: 8 of 29 START sql table model STAGING.stg_supplier ............................. [RUN]
[0m22:28:25.067145 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_product, now model.northwind.stg_supplier)
[0m22:28:25.067145 [debug] [Thread-1  ]: Began compiling node model.northwind.stg_supplier
[0m22:28:25.067145 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.stg_supplier"
[0m22:28:25.067145 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (compile): 22:28:25.067145 => 22:28:25.067145
[0m22:28:25.067145 [debug] [Thread-1  ]: Began executing node model.northwind.stg_supplier
[0m22:28:25.085041 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.stg_supplier"
[0m22:28:25.086101 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.stg_supplier"
[0m22:28:25.087073 [debug] [Thread-1  ]: On model.northwind.stg_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.stg_supplier"} */
create or replace transient table PROD.STAGING.stg_supplier
         as
        (
select supplier_id,
country,
contact_name,
address,
city,
phone,
company_name,
fax,
region,
postal_code,
contact_title
from airbyte_database.airbyte_schema.suppliers
        );
[0m22:28:25.087558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:26.158292 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:26.160545 [debug] [Thread-1  ]: Timing info for model.northwind.stg_supplier (execute): 22:28:25.067145 => 22:28:26.160416
[0m22:28:26.160545 [debug] [Thread-1  ]: On model.northwind.stg_supplier: Close
[0m22:28:26.252754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F581D1BE0>]}
[0m22:28:26.254341 [info ] [Thread-1  ]: 8 of 29 OK created sql table model STAGING.stg_supplier ........................ [[32mSUCCESS 1[0m in 1.19s]
[0m22:28:26.256567 [debug] [Thread-1  ]: Finished running node model.northwind.stg_supplier
[0m22:28:26.257165 [debug] [Thread-1  ]: Began running node snapshot.northwind.snp_customer_customer_type
[0m22:28:26.258396 [info ] [Thread-1  ]: 9 of 29 START snapshot SNAPSHOT.snp_customer_customer_type ..................... [RUN]
[0m22:28:26.259488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.stg_supplier, now snapshot.northwind.snp_customer_customer_type)
[0m22:28:26.260049 [debug] [Thread-1  ]: Began compiling node snapshot.northwind.snp_customer_customer_type
[0m22:28:26.263064 [debug] [Thread-1  ]: Timing info for snapshot.northwind.snp_customer_customer_type (compile): 22:28:26.260630 => 22:28:26.263064
[0m22:28:26.263597 [debug] [Thread-1  ]: Began executing node snapshot.northwind.snp_customer_customer_type
[0m22:28:26.306759 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:26.307270 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
select * from (
        select customer_type_id from (
                



select * from prod.staging.stg_customer_customer_type

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m22:28:26.307806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:26.970633 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m22:28:26.970633 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:26.970633 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
describe table "PROD"."SNAPSHOT"."SNP_CUSTOMER_CUSTOMER_TYPE"
[0m22:28:27.039233 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m22:28:27.054300 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:27.054300 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
describe table "PROD"."SNAPSHOT"."SNP_CUSTOMER_CUSTOMER_TYPE"
[0m22:28:27.101688 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m22:28:27.117331 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:27.117331 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
create or replace temporary table "PROD"."SNAPSHOT"."SNP_CUSTOMER_CUSTOMER_TYPE__dbt_tmp"
         as
        (with snapshot_query as (

        



select * from prod.staging.stg_customer_customer_type


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "PROD"."SNAPSHOT"."SNP_CUSTOMER_CUSTOMER_TYPE"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."CUSTOMER_TYPE_ID" != source_data."CUSTOMER_TYPE_ID"
        or
        (
            ((snapshotted_data."CUSTOMER_TYPE_ID" is null) and not (source_data."CUSTOMER_TYPE_ID" is null))
            or
            ((not snapshotted_data."CUSTOMER_TYPE_ID" is null) and (source_data."CUSTOMER_TYPE_ID" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."CUSTOMER_TYPE_ID" != source_data."CUSTOMER_TYPE_ID"
        or
        (
            ((snapshotted_data."CUSTOMER_TYPE_ID" is null) and not (source_data."CUSTOMER_TYPE_ID" is null))
            or
            ((not snapshotted_data."CUSTOMER_TYPE_ID" is null) and (source_data."CUSTOMER_TYPE_ID" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m22:28:27.510484 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:28:27.526177 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:27.526177 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
describe table "PROD"."SNAPSHOT"."SNP_CUSTOMER_CUSTOMER_TYPE__dbt_tmp"
[0m22:28:27.582512 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.0 seconds
[0m22:28:27.582512 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:27.582512 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
describe table "PROD"."SNAPSHOT"."SNP_CUSTOMER_CUSTOMER_TYPE"
[0m22:28:27.630203 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m22:28:27.646423 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:27.646423 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
describe table "PROD"."SNAPSHOT"."SNP_CUSTOMER_CUSTOMER_TYPE__dbt_tmp"
[0m22:28:27.698771 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.0 seconds
[0m22:28:27.709514 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:27.709514 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
describe table "PROD"."SNAPSHOT"."SNP_CUSTOMER_CUSTOMER_TYPE"
[0m22:28:27.771036 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m22:28:27.771036 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:27.771036 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
describe table "PROD"."SNAPSHOT"."SNP_CUSTOMER_CUSTOMER_TYPE__dbt_tmp"
[0m22:28:27.818805 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.0 seconds
[0m22:28:27.834466 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.northwind.snp_customer_customer_type"
[0m22:28:27.834466 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:27.834466 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
BEGIN
[0m22:28:27.913706 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:28:27.913706 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:27.913706 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
merge into "PROD"."SNAPSHOT"."SNP_CUSTOMER_CUSTOMER_TYPE" as DBT_INTERNAL_DEST
    using "PROD"."SNAPSHOT"."SNP_CUSTOMER_CUSTOMER_TYPE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CUSTOMER_ID", "CUSTOMER_TYPE_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CUSTOMER_ID", "CUSTOMER_TYPE_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m22:28:28.288320 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.0 seconds
[0m22:28:28.290230 [debug] [Thread-1  ]: Using snowflake connection "snapshot.northwind.snp_customer_customer_type"
[0m22:28:28.292075 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "snapshot.northwind.snp_customer_customer_type"} */
COMMIT
[0m22:28:28.460759 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:28:28.476447 [debug] [Thread-1  ]: Timing info for snapshot.northwind.snp_customer_customer_type (execute): 22:28:26.264247 => 22:28:28.476447
[0m22:28:28.476447 [debug] [Thread-1  ]: On snapshot.northwind.snp_customer_customer_type: Close
[0m22:28:28.555157 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F58153D60>]}
[0m22:28:28.555157 [info ] [Thread-1  ]: 9 of 29 OK snapshotted SNAPSHOT.snp_customer_customer_type ..................... [[32msuccess[0m in 2.30s]
[0m22:28:28.555157 [debug] [Thread-1  ]: Finished running node snapshot.northwind.snp_customer_customer_type
[0m22:28:28.555157 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer
[0m22:28:28.555157 [info ] [Thread-1  ]: 10 of 29 START sql table model CURATED.dim_customer ............................ [RUN]
[0m22:28:28.570733 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly snapshot.northwind.snp_customer_customer_type, now model.northwind.dim_customer)
[0m22:28:28.573560 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer
[0m22:28:28.584861 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer"
[0m22:28:28.585748 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (compile): 22:28:28.573560 => 22:28:28.585748
[0m22:28:28.585748 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer
[0m22:28:28.585748 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer"
[0m22:28:28.585748 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer"
[0m22:28:28.585748 [debug] [Thread-1  ]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer"} */
create or replace transient table PROD.CURATED.dim_customer
         as
        (with stg_customer as (
    select customer_id,
    company_name,
    contact_name,
    contact_title,
    address,
    city,
    region,
    postal_code,
    country,
    phone,
    fax
    from PROD.STAGING.stg_customer
)

select
    
    
md5(cast(coalesce(cast(stg_customer.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_customer.customer_id,
    stg_customer.company_name as customer_company_name,
    stg_customer.contact_name as customer_contact_name,
    stg_customer.contact_title as customer_contact_title,
    stg_customer.address as customer_address,
    stg_customer.city as customer_city,
    stg_customer.region as customer_region,
    stg_customer.postal_code as customer_postal_code,
    stg_customer.country as customer_country,
    stg_customer.phone as customer_phone
from stg_customer
        );
[0m22:28:28.585748 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:29.551775 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:29.551775 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer (execute): 22:28:28.585748 => 22:28:29.551775
[0m22:28:29.551775 [debug] [Thread-1  ]: On model.northwind.dim_customer: Close
[0m22:28:29.630324 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F58316C40>]}
[0m22:28:29.630324 [info ] [Thread-1  ]: 10 of 29 OK created sql table model CURATED.dim_customer ....................... [[32mSUCCESS 1[0m in 1.06s]
[0m22:28:29.645938 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer
[0m22:28:29.645938 [debug] [Thread-1  ]: Began running node test.northwind.discount_range
[0m22:28:29.645938 [info ] [Thread-1  ]: 11 of 29 START test discount_range ............................................. [RUN]
[0m22:28:29.645938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.discount_range)
[0m22:28:29.645938 [debug] [Thread-1  ]: Began compiling node test.northwind.discount_range
[0m22:28:29.645938 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.discount_range"
[0m22:28:29.645938 [debug] [Thread-1  ]: Timing info for test.northwind.discount_range (compile): 22:28:29.645938 => 22:28:29.645938
[0m22:28:29.645938 [debug] [Thread-1  ]: Began executing node test.northwind.discount_range
[0m22:28:29.667518 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.discount_range"
[0m22:28:29.669596 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.discount_range"
[0m22:28:29.670727 [debug] [Thread-1  ]: On test.northwind.discount_range: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.discount_range"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select
    *
from PROD.STAGING.stg_order_detail 
where
    discount < 0 or discount > 1
      
    ) dbt_internal_test
[0m22:28:29.670727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:30.304057 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:30.304057 [debug] [Thread-1  ]: Timing info for test.northwind.discount_range (execute): 22:28:29.645938 => 22:28:30.304057
[0m22:28:30.304057 [debug] [Thread-1  ]: On test.northwind.discount_range: Close
[0m22:28:30.366592 [info ] [Thread-1  ]: 11 of 29 PASS discount_range ................................................... [[32mPASS[0m in 0.72s]
[0m22:28:30.366592 [debug] [Thread-1  ]: Finished running node test.northwind.discount_range
[0m22:28:30.366592 [debug] [Thread-1  ]: Began running node model.northwind.dim_product
[0m22:28:30.366592 [info ] [Thread-1  ]: 12 of 29 START sql table model CURATED.dim_product ............................. [RUN]
[0m22:28:30.366592 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.discount_range, now model.northwind.dim_product)
[0m22:28:30.382395 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_product
[0m22:28:30.390691 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_product"
[0m22:28:30.391310 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (compile): 22:28:30.382395 => 22:28:30.391310
[0m22:28:30.391310 [debug] [Thread-1  ]: Began executing node model.northwind.dim_product
[0m22:28:30.391310 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_product"
[0m22:28:30.391310 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_product"
[0m22:28:30.391310 [debug] [Thread-1  ]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_product"} */
create or replace transient table PROD.CURATED.dim_product
         as
        (with stg_product as (
    select cast(product_id as integer) as product_id,
    product_name,
    cast(unit_price as numeric(38,2)) as unit_price,
    cast(reorder_level as integer) as reorder_level,
    cast(discontinued as integer) as discontinued,
    cast(category_id as integer) as category_id,
    cast(units_in_stock as integer) as units_in_stock,
    cast(units_on_order as integer) as units_on_order,
    quantity_per_unit,
    cast(supplier_id as integer) as supplier_id
    from PROD.STAGING.stg_product
),

stg_category as(
    select cast(category_id as integer) as category_id,
    category_name,
    description
    from PROD.STAGING.stg_category
)

select
    
    
md5(cast(coalesce(cast(stg_product.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    stg_product.product_id,
    stg_product.product_name,
    stg_category.category_name,
    stg_product.reorder_level,
    stg_product.discontinued,
    stg_product.units_in_stock,
    stg_product.units_on_order,
    
    
md5(cast(coalesce(cast(stg_product.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key
from stg_product
left join stg_category on stg_product.category_id = stg_category.category_id
        );
[0m22:28:30.391310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:31.405980 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:31.405980 [debug] [Thread-1  ]: Timing info for model.northwind.dim_product (execute): 22:28:30.391310 => 22:28:31.405980
[0m22:28:31.405980 [debug] [Thread-1  ]: On model.northwind.dim_product: Close
[0m22:28:31.476021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F582A7E20>]}
[0m22:28:31.476021 [info ] [Thread-1  ]: 12 of 29 OK created sql table model CURATED.dim_product ........................ [[32mSUCCESS 1[0m in 1.11s]
[0m22:28:31.476021 [debug] [Thread-1  ]: Finished running node model.northwind.dim_product
[0m22:28:31.476021 [debug] [Thread-1  ]: Began running node model.northwind.dim_supplier
[0m22:28:31.476021 [info ] [Thread-1  ]: 13 of 29 START sql table model CURATED.dim_supplier ............................ [RUN]
[0m22:28:31.491714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now model.northwind.dim_supplier)
[0m22:28:31.491714 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_supplier
[0m22:28:31.491714 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_supplier"
[0m22:28:31.491714 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (compile): 22:28:31.491714 => 22:28:31.491714
[0m22:28:31.491714 [debug] [Thread-1  ]: Began executing node model.northwind.dim_supplier
[0m22:28:31.498794 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_supplier"
[0m22:28:31.498794 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_supplier"
[0m22:28:31.498794 [debug] [Thread-1  ]: On model.northwind.dim_supplier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_supplier"} */
create or replace transient table PROD.CURATED.dim_supplier
         as
        (with stg_supplier as (
    select cast(supplier_id as integer) as supplier_id,
    country,
    contact_name,
    address,
    city,
    phone,
    company_name,
    fax,
    region,
    postal_code,
    contact_title
    from PROD.STAGING.stg_supplier
)

select
    
    
md5(cast(coalesce(cast(stg_supplier.supplier_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as supplier_key,
    stg_supplier.supplier_id,
    stg_supplier.company_name as supplier_company_name,
    stg_supplier.contact_name as supplier_contact_name,
    stg_supplier.contact_title as supplier_contact_title,
    stg_supplier.address as supplier_address,
    stg_supplier.city as supplier_city,
    stg_supplier.region as supplier_region,
    stg_supplier.postal_code as supplier_postal_code,
    stg_supplier.country as supplier_country,
    stg_supplier.phone as supplier_phone
    from stg_supplier
        );
[0m22:28:31.498794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:32.475091 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:32.475091 [debug] [Thread-1  ]: Timing info for model.northwind.dim_supplier (execute): 22:28:31.498794 => 22:28:32.475091
[0m22:28:32.490608 [debug] [Thread-1  ]: On model.northwind.dim_supplier: Close
[0m22:28:32.553321 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F583509D0>]}
[0m22:28:32.553321 [info ] [Thread-1  ]: 13 of 29 OK created sql table model CURATED.dim_supplier ....................... [[32mSUCCESS 1[0m in 1.06s]
[0m22:28:32.568810 [debug] [Thread-1  ]: Finished running node model.northwind.dim_supplier
[0m22:28:32.568810 [debug] [Thread-1  ]: Began running node model.northwind.dim_customer_tier
[0m22:28:32.568810 [info ] [Thread-1  ]: 14 of 29 START sql table model CURATED.dim_customer_tier ....................... [RUN]
[0m22:28:32.568810 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_supplier, now model.northwind.dim_customer_tier)
[0m22:28:32.576064 [debug] [Thread-1  ]: Began compiling node model.northwind.dim_customer_tier
[0m22:28:32.577894 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.dim_customer_tier"
[0m22:28:32.577894 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (compile): 22:28:32.576064 => 22:28:32.577894
[0m22:28:32.577894 [debug] [Thread-1  ]: Began executing node model.northwind.dim_customer_tier
[0m22:28:32.585992 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.dim_customer_tier"
[0m22:28:32.585992 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.dim_customer_tier"
[0m22:28:32.585992 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.dim_customer_tier"} */
create or replace transient table PROD.CURATED.dim_customer_tier
         as
        (with snp_customer_customer_type as (
    select customer_id,
    cast(customer_type_id as integer) as customer_type_id,
    dbt_valid_from,
    dbt_valid_to
    from PROD.SNAPSHOT.snp_customer_customer_type
),

stg_customer_type as (
    select *
    from PROD.STAGING.stg_customer_type
)

select
    
    
md5(cast(coalesce(cast(snp_customer_customer_type.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.customer_type_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(snp_customer_customer_type.dbt_valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_tier_key,
    snp_customer_customer_type.customer_id,
    snp_customer_customer_type.customer_type_id as customer_tier_id,
    stg_customer_type.customer_desc as customer_tier,
    snp_customer_customer_type.dbt_valid_from as valid_from, 
    snp_customer_customer_type.dbt_valid_to as valid_to
from snp_customer_customer_type
left join stg_customer_type on snp_customer_customer_type.customer_type_id=stg_customer_type.customer_type_id
        );
[0m22:28:32.585992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:33.827936 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:33.827936 [debug] [Thread-1  ]: Timing info for model.northwind.dim_customer_tier (execute): 22:28:32.583606 => 22:28:33.827936
[0m22:28:33.827936 [debug] [Thread-1  ]: On model.northwind.dim_customer_tier: Close
[0m22:28:33.890552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5836DC70>]}
[0m22:28:33.890552 [info ] [Thread-1  ]: 14 of 29 OK created sql table model CURATED.dim_customer_tier .................. [[32mSUCCESS 1[0m in 1.32s]
[0m22:28:33.890552 [debug] [Thread-1  ]: Finished running node model.northwind.dim_customer_tier
[0m22:28:33.906155 [debug] [Thread-1  ]: Began running node test.northwind.not_null_dim_customer_customer_key.c289fe4d1f
[0m22:28:33.906922 [info ] [Thread-1  ]: 15 of 29 START test not_null_dim_customer_customer_key ......................... [RUN]
[0m22:28:33.909985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.dim_customer_tier, now test.northwind.not_null_dim_customer_customer_key.c289fe4d1f)
[0m22:28:33.909985 [debug] [Thread-1  ]: Began compiling node test.northwind.not_null_dim_customer_customer_key.c289fe4d1f
[0m22:28:33.917219 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customer_key.c289fe4d1f"
[0m22:28:33.919169 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_dim_customer_customer_key.c289fe4d1f (compile): 22:28:33.909985 => 22:28:33.919169
[0m22:28:33.919169 [debug] [Thread-1  ]: Began executing node test.northwind.not_null_dim_customer_customer_key.c289fe4d1f
[0m22:28:33.921167 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customer_key.c289fe4d1f"
[0m22:28:33.923174 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.not_null_dim_customer_customer_key.c289fe4d1f"
[0m22:28:33.924173 [debug] [Thread-1  ]: On test.northwind.not_null_dim_customer_customer_key.c289fe4d1f: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.not_null_dim_customer_customer_key.c289fe4d1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from PROD.CURATED.dim_customer
where customer_key is null



      
    ) dbt_internal_test
[0m22:28:33.925268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:34.567372 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:34.567372 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_dim_customer_customer_key.c289fe4d1f (execute): 22:28:33.919169 => 22:28:34.567372
[0m22:28:34.567372 [debug] [Thread-1  ]: On test.northwind.not_null_dim_customer_customer_key.c289fe4d1f: Close
[0m22:28:34.649154 [info ] [Thread-1  ]: 15 of 29 PASS not_null_dim_customer_customer_key ............................... [[32mPASS[0m in 0.74s]
[0m22:28:34.649154 [debug] [Thread-1  ]: Finished running node test.northwind.not_null_dim_customer_customer_key.c289fe4d1f
[0m22:28:34.649154 [debug] [Thread-1  ]: Began running node test.northwind.unique_dim_customer_customer_key.7b0683cc6e
[0m22:28:34.649154 [info ] [Thread-1  ]: 16 of 29 START test unique_dim_customer_customer_key ........................... [RUN]
[0m22:28:34.649154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customer_key.c289fe4d1f, now test.northwind.unique_dim_customer_customer_key.7b0683cc6e)
[0m22:28:34.649154 [debug] [Thread-1  ]: Began compiling node test.northwind.unique_dim_customer_customer_key.7b0683cc6e
[0m22:28:34.666558 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.unique_dim_customer_customer_key.7b0683cc6e"
[0m22:28:34.666558 [debug] [Thread-1  ]: Timing info for test.northwind.unique_dim_customer_customer_key.7b0683cc6e (compile): 22:28:34.649154 => 22:28:34.666558
[0m22:28:34.666558 [debug] [Thread-1  ]: Began executing node test.northwind.unique_dim_customer_customer_key.7b0683cc6e
[0m22:28:34.666558 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.unique_dim_customer_customer_key.7b0683cc6e"
[0m22:28:34.674253 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.unique_dim_customer_customer_key.7b0683cc6e"
[0m22:28:34.675113 [debug] [Thread-1  ]: On test.northwind.unique_dim_customer_customer_key.7b0683cc6e: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.unique_dim_customer_customer_key.7b0683cc6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_key as unique_field,
    count(*) as n_records

from PROD.CURATED.dim_customer
where customer_key is not null
group by customer_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:28:34.675812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:35.342969 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:35.342969 [debug] [Thread-1  ]: Timing info for test.northwind.unique_dim_customer_customer_key.7b0683cc6e (execute): 22:28:34.666558 => 22:28:35.342969
[0m22:28:35.342969 [debug] [Thread-1  ]: On test.northwind.unique_dim_customer_customer_key.7b0683cc6e: Close
[0m22:28:35.433730 [info ] [Thread-1  ]: 16 of 29 PASS unique_dim_customer_customer_key ................................. [[32mPASS[0m in 0.78s]
[0m22:28:35.435752 [debug] [Thread-1  ]: Finished running node test.northwind.unique_dim_customer_customer_key.7b0683cc6e
[0m22:28:35.436732 [debug] [Thread-1  ]: Began running node test.northwind.not_null_dim_product_product_key.f0e1d838d3
[0m22:28:35.438725 [info ] [Thread-1  ]: 17 of 29 START test not_null_dim_product_product_key ........................... [RUN]
[0m22:28:35.439693 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customer_key.7b0683cc6e, now test.northwind.not_null_dim_product_product_key.f0e1d838d3)
[0m22:28:35.440730 [debug] [Thread-1  ]: Began compiling node test.northwind.not_null_dim_product_product_key.f0e1d838d3
[0m22:28:35.445383 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.not_null_dim_product_product_key.f0e1d838d3"
[0m22:28:35.448521 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_dim_product_product_key.f0e1d838d3 (compile): 22:28:35.440730 => 22:28:35.447802
[0m22:28:35.448521 [debug] [Thread-1  ]: Began executing node test.northwind.not_null_dim_product_product_key.f0e1d838d3
[0m22:28:35.448521 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.not_null_dim_product_product_key.f0e1d838d3"
[0m22:28:35.448521 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.not_null_dim_product_product_key.f0e1d838d3"
[0m22:28:35.448521 [debug] [Thread-1  ]: On test.northwind.not_null_dim_product_product_key.f0e1d838d3: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.not_null_dim_product_product_key.f0e1d838d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from PROD.CURATED.dim_product
where product_key is null



      
    ) dbt_internal_test
[0m22:28:35.448521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:36.104541 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:36.104541 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_dim_product_product_key.f0e1d838d3 (execute): 22:28:35.448521 => 22:28:36.104541
[0m22:28:36.104541 [debug] [Thread-1  ]: On test.northwind.not_null_dim_product_product_key.f0e1d838d3: Close
[0m22:28:36.183571 [info ] [Thread-1  ]: 17 of 29 PASS not_null_dim_product_product_key ................................. [[32mPASS[0m in 0.74s]
[0m22:28:36.184608 [debug] [Thread-1  ]: Finished running node test.northwind.not_null_dim_product_product_key.f0e1d838d3
[0m22:28:36.185191 [debug] [Thread-1  ]: Began running node test.northwind.unique_dim_product_product_key.1753236bd0
[0m22:28:36.186418 [info ] [Thread-1  ]: 18 of 29 START test unique_dim_product_product_key ............................. [RUN]
[0m22:28:36.186652 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_product_key.f0e1d838d3, now test.northwind.unique_dim_product_product_key.1753236bd0)
[0m22:28:36.186652 [debug] [Thread-1  ]: Began compiling node test.northwind.unique_dim_product_product_key.1753236bd0
[0m22:28:36.191525 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.unique_dim_product_product_key.1753236bd0"
[0m22:28:36.192647 [debug] [Thread-1  ]: Timing info for test.northwind.unique_dim_product_product_key.1753236bd0 (compile): 22:28:36.186652 => 22:28:36.192535
[0m22:28:36.193231 [debug] [Thread-1  ]: Began executing node test.northwind.unique_dim_product_product_key.1753236bd0
[0m22:28:36.194673 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.unique_dim_product_product_key.1753236bd0"
[0m22:28:36.194673 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.unique_dim_product_product_key.1753236bd0"
[0m22:28:36.194673 [debug] [Thread-1  ]: On test.northwind.unique_dim_product_product_key.1753236bd0: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.unique_dim_product_product_key.1753236bd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from PROD.CURATED.dim_product
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:28:36.194673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:37.051047 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:37.051047 [debug] [Thread-1  ]: Timing info for test.northwind.unique_dim_product_product_key.1753236bd0 (execute): 22:28:36.193336 => 22:28:37.051047
[0m22:28:37.051047 [debug] [Thread-1  ]: On test.northwind.unique_dim_product_product_key.1753236bd0: Close
[0m22:28:37.117900 [info ] [Thread-1  ]: 18 of 29 PASS unique_dim_product_product_key ................................... [[32mPASS[0m in 0.93s]
[0m22:28:37.117900 [debug] [Thread-1  ]: Finished running node test.northwind.unique_dim_product_product_key.1753236bd0
[0m22:28:37.117900 [debug] [Thread-1  ]: Began running node test.northwind.not_null_dim_supplier_supplier_key.418602551c
[0m22:28:37.117900 [info ] [Thread-1  ]: 19 of 29 START test not_null_dim_supplier_supplier_key ......................... [RUN]
[0m22:28:37.117900 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_product_key.1753236bd0, now test.northwind.not_null_dim_supplier_supplier_key.418602551c)
[0m22:28:37.117900 [debug] [Thread-1  ]: Began compiling node test.northwind.not_null_dim_supplier_supplier_key.418602551c
[0m22:28:37.136276 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.not_null_dim_supplier_supplier_key.418602551c"
[0m22:28:37.137666 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_dim_supplier_supplier_key.418602551c (compile): 22:28:37.117900 => 22:28:37.137666
[0m22:28:37.137666 [debug] [Thread-1  ]: Began executing node test.northwind.not_null_dim_supplier_supplier_key.418602551c
[0m22:28:37.137666 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.not_null_dim_supplier_supplier_key.418602551c"
[0m22:28:37.137666 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.not_null_dim_supplier_supplier_key.418602551c"
[0m22:28:37.137666 [debug] [Thread-1  ]: On test.northwind.not_null_dim_supplier_supplier_key.418602551c: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.not_null_dim_supplier_supplier_key.418602551c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select supplier_key
from PROD.CURATED.dim_supplier
where supplier_key is null



      
    ) dbt_internal_test
[0m22:28:37.137666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:37.768943 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:37.768943 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_dim_supplier_supplier_key.418602551c (execute): 22:28:37.137666 => 22:28:37.768943
[0m22:28:37.768943 [debug] [Thread-1  ]: On test.northwind.not_null_dim_supplier_supplier_key.418602551c: Close
[0m22:28:37.847282 [info ] [Thread-1  ]: 19 of 29 PASS not_null_dim_supplier_supplier_key ............................... [[32mPASS[0m in 0.73s]
[0m22:28:37.847282 [debug] [Thread-1  ]: Finished running node test.northwind.not_null_dim_supplier_supplier_key.418602551c
[0m22:28:37.847282 [debug] [Thread-1  ]: Began running node test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e
[0m22:28:37.847282 [info ] [Thread-1  ]: 20 of 29 START test unique_dim_supplier_supplier_key ........................... [RUN]
[0m22:28:37.847282 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_supplier_supplier_key.418602551c, now test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e)
[0m22:28:37.847282 [debug] [Thread-1  ]: Began compiling node test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e
[0m22:28:37.847282 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e"
[0m22:28:37.847282 [debug] [Thread-1  ]: Timing info for test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e (compile): 22:28:37.847282 => 22:28:37.847282
[0m22:28:37.847282 [debug] [Thread-1  ]: Began executing node test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e
[0m22:28:37.864288 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e"
[0m22:28:37.865307 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e"
[0m22:28:37.866294 [debug] [Thread-1  ]: On test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    supplier_key as unique_field,
    count(*) as n_records

from PROD.CURATED.dim_supplier
where supplier_key is not null
group by supplier_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:28:37.866294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:38.503702 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:38.503702 [debug] [Thread-1  ]: Timing info for test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e (execute): 22:28:37.847282 => 22:28:38.503702
[0m22:28:38.503702 [debug] [Thread-1  ]: On test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e: Close
[0m22:28:38.582412 [info ] [Thread-1  ]: 20 of 29 PASS unique_dim_supplier_supplier_key ................................. [[32mPASS[0m in 0.74s]
[0m22:28:38.582412 [debug] [Thread-1  ]: Finished running node test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e
[0m22:28:38.582412 [debug] [Thread-1  ]: Began running node test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51
[0m22:28:38.582412 [info ] [Thread-1  ]: 21 of 29 START test accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier  [RUN]
[0m22:28:38.582412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_supplier_supplier_key.cd6bf9072e, now test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51)
[0m22:28:38.582412 [debug] [Thread-1  ]: Began compiling node test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51
[0m22:28:38.582412 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51"
[0m22:28:38.599154 [debug] [Thread-1  ]: Timing info for test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51 (compile): 22:28:38.582412 => 22:28:38.599154
[0m22:28:38.599600 [debug] [Thread-1  ]: Began executing node test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51
[0m22:28:38.603937 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51"
[0m22:28:38.605806 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51"
[0m22:28:38.606856 [debug] [Thread-1  ]: On test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from PROD.CURATED.dim_customer_tier
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'Basic Tier','Premium Tier'
)



      
    ) dbt_internal_test
[0m22:28:38.606856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:39.244945 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:39.244945 [debug] [Thread-1  ]: Timing info for test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51 (execute): 22:28:38.600609 => 22:28:39.244945
[0m22:28:39.244945 [debug] [Thread-1  ]: On test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51: Close
[0m22:28:39.307563 [info ] [Thread-1  ]: 21 of 29 PASS accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier  [[32mPASS[0m in 0.73s]
[0m22:28:39.307563 [debug] [Thread-1  ]: Finished running node test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51
[0m22:28:39.307563 [debug] [Thread-1  ]: Began running node test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7
[0m22:28:39.307563 [info ] [Thread-1  ]: 22 of 29 START test accepted_values_dim_customer_tier_customer_tier_id__1__2 ... [RUN]
[0m22:28:39.307563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.accepted_values_dim_customer_tier_customer_tier__Basic_Tier__Premium_Tier.ca03827a51, now test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7)
[0m22:28:39.307563 [debug] [Thread-1  ]: Began compiling node test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7
[0m22:28:39.326328 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7"
[0m22:28:39.329412 [debug] [Thread-1  ]: Timing info for test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7 (compile): 22:28:39.307563 => 22:28:39.326328
[0m22:28:39.329412 [debug] [Thread-1  ]: Began executing node test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7
[0m22:28:39.331043 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7"
[0m22:28:39.331043 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7"
[0m22:28:39.331043 [debug] [Thread-1  ]: On test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_tier_id as value_field,
        count(*) as n_records

    from PROD.CURATED.dim_customer_tier
    group by customer_tier_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m22:28:39.331043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:39.960026 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:39.960026 [debug] [Thread-1  ]: Timing info for test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7 (execute): 22:28:39.330419 => 22:28:39.960026
[0m22:28:39.960026 [debug] [Thread-1  ]: On test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7: Close
[0m22:28:40.038634 [info ] [Thread-1  ]: 22 of 29 PASS accepted_values_dim_customer_tier_customer_tier_id__1__2 ......... [[32mPASS[0m in 0.73s]
[0m22:28:40.038634 [debug] [Thread-1  ]: Finished running node test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7
[0m22:28:40.038634 [debug] [Thread-1  ]: Began running node test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385
[0m22:28:40.038634 [info ] [Thread-1  ]: 23 of 29 START test not_null_dim_customer_tier_customer_tier_key ............... [RUN]
[0m22:28:40.038634 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.accepted_values_dim_customer_tier_customer_tier_id__1__2.48f54a25f7, now test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385)
[0m22:28:40.038634 [debug] [Thread-1  ]: Began compiling node test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385
[0m22:28:40.054388 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385"
[0m22:28:40.056141 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385 (compile): 22:28:40.038634 => 22:28:40.056141
[0m22:28:40.057149 [debug] [Thread-1  ]: Began executing node test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385
[0m22:28:40.059932 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385"
[0m22:28:40.061089 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385"
[0m22:28:40.061089 [debug] [Thread-1  ]: On test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_tier_key
from PROD.CURATED.dim_customer_tier
where customer_tier_key is null



      
    ) dbt_internal_test
[0m22:28:40.061089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:40.653687 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:40.653687 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385 (execute): 22:28:40.057835 => 22:28:40.653687
[0m22:28:40.653687 [debug] [Thread-1  ]: On test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385: Close
[0m22:28:40.747445 [info ] [Thread-1  ]: 23 of 29 PASS not_null_dim_customer_tier_customer_tier_key ..................... [[32mPASS[0m in 0.71s]
[0m22:28:40.747445 [debug] [Thread-1  ]: Finished running node test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385
[0m22:28:40.747445 [debug] [Thread-1  ]: Began running node test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c
[0m22:28:40.747445 [info ] [Thread-1  ]: 24 of 29 START test not_null_dim_customer_tier_valid_from ...................... [RUN]
[0m22:28:40.747445 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_tier_customer_tier_key.37aa38a385, now test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c)
[0m22:28:40.747445 [debug] [Thread-1  ]: Began compiling node test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c
[0m22:28:40.747445 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c"
[0m22:28:40.747445 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c (compile): 22:28:40.747445 => 22:28:40.747445
[0m22:28:40.747445 [debug] [Thread-1  ]: Began executing node test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c
[0m22:28:40.747445 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c"
[0m22:28:40.763066 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c"
[0m22:28:40.763066 [debug] [Thread-1  ]: On test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_from
from PROD.CURATED.dim_customer_tier
where valid_from is null



      
    ) dbt_internal_test
[0m22:28:40.764797 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:41.397053 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:41.397053 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c (execute): 22:28:40.747445 => 22:28:41.397053
[0m22:28:41.397053 [debug] [Thread-1  ]: On test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c: Close
[0m22:28:41.475604 [info ] [Thread-1  ]: 24 of 29 PASS not_null_dim_customer_tier_valid_from ............................ [[32mPASS[0m in 0.73s]
[0m22:28:41.475604 [debug] [Thread-1  ]: Finished running node test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c
[0m22:28:41.475604 [debug] [Thread-1  ]: Began running node test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26
[0m22:28:41.475604 [info ] [Thread-1  ]: 25 of 29 START test unique_dim_customer_tier_customer_tier_key ................. [RUN]
[0m22:28:41.475604 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_tier_valid_from.db36cacc9c, now test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26)
[0m22:28:41.475604 [debug] [Thread-1  ]: Began compiling node test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26
[0m22:28:41.475604 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26"
[0m22:28:41.491231 [debug] [Thread-1  ]: Timing info for test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26 (compile): 22:28:41.475604 => 22:28:41.491231
[0m22:28:41.491231 [debug] [Thread-1  ]: Began executing node test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26
[0m22:28:41.494624 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26"
[0m22:28:41.494624 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26"
[0m22:28:41.494624 [debug] [Thread-1  ]: On test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_tier_key as unique_field,
    count(*) as n_records

from PROD.CURATED.dim_customer_tier
where customer_tier_key is not null
group by customer_tier_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:28:41.494624 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:42.076583 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:42.092207 [debug] [Thread-1  ]: Timing info for test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26 (execute): 22:28:41.492899 => 22:28:42.092207
[0m22:28:42.092207 [debug] [Thread-1  ]: On test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26: Close
[0m22:28:42.154969 [info ] [Thread-1  ]: 25 of 29 PASS unique_dim_customer_tier_customer_tier_key ....................... [[32mPASS[0m in 0.68s]
[0m22:28:42.154969 [debug] [Thread-1  ]: Finished running node test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26
[0m22:28:42.154969 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m22:28:42.154969 [info ] [Thread-1  ]: 26 of 29 START sql incremental model CURATED.fact_order ........................ [RUN]
[0m22:28:42.170737 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_tier_customer_tier_key.71160adb26, now model.northwind.fact_order)
[0m22:28:42.170737 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m22:28:42.170737 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m22:28:42.170737 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 22:28:42.170737 => 22:28:42.170737
[0m22:28:42.186360 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m22:28:42.216292 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:28:42.216292 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
create or replace  temporary view PROD.CURATED.fact_order__dbt_tmp
  
   as (
    

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from PROD.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier,
    stg_order_detail.updated_at
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


    where stg_order_detail.updated_at > (select max(updated_at) from PROD.CURATED.fact_order)

  );
[0m22:28:42.216292 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:42.884195 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:42.884195 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:28:42.884195 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m22:28:42.950959 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:28:42.950959 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:28:42.950959 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order
[0m22:28:42.997853 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:28:43.013625 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:28:43.013625 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m22:28:43.092482 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:28:43.092482 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:28:43.092482 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table "PROD"."CURATED"."FACT_ORDER"
[0m22:28:43.155630 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:28:43.171242 [debug] [Thread-1  ]: 
    In "PROD"."CURATED"."FACT_ORDER":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:28:43.186866 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m22:28:43.186866 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:28:43.186866 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
-- back compat for old kwarg name
  
  begin;
[0m22:28:43.265423 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:28:43.265423 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:28:43.265423 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
merge into PROD.CURATED.fact_order as DBT_INTERNAL_DEST
        using PROD.CURATED.fact_order__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_key = DBT_INTERNAL_DEST.order_key
            )

    
    when matched then update set
        "ORDER_KEY" = DBT_INTERNAL_SOURCE."ORDER_KEY","PRODUCT_KEY" = DBT_INTERNAL_SOURCE."PRODUCT_KEY","CUSTOMER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_KEY","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","UNIT_PRICE" = DBT_INTERNAL_SOURCE."UNIT_PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","NORMAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."NORMAL_RETAIL_VALUE","DISCOUNT" = DBT_INTERNAL_SOURCE."DISCOUNT","DISCOUNT_VALUE" = DBT_INTERNAL_SOURCE."DISCOUNT_VALUE","ACTUAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."ACTUAL_RETAIL_VALUE","PRICE_TYPE" = DBT_INTERNAL_SOURCE."PRICE_TYPE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","SHIPPED_DATE" = DBT_INTERNAL_SOURCE."SHIPPED_DATE","REQUIRED_DATE" = DBT_INTERNAL_SOURCE."REQUIRED_DATE","DAYS_TO_SHIP" = DBT_INTERNAL_SOURCE."DAYS_TO_SHIP","CUSTOMER_TIER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER_KEY","CUSTOMER_TIER" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")
    values
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")

;
[0m22:28:43.840760 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m22:28:43.840760 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:28:43.840760 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
COMMIT
[0m22:28:44.001359 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:28:44.016498 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:28:44.016498 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
drop view if exists PROD.CURATED.fact_order__dbt_tmp cascade
[0m22:28:44.095146 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:28:44.095146 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 22:28:42.186360 => 22:28:44.095146
[0m22:28:44.095146 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m22:28:44.173536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F583AB0A0>]}
[0m22:28:44.173536 [info ] [Thread-1  ]: 26 of 29 OK created sql incremental model CURATED.fact_order ................... [[32mSUCCESS 0[0m in 2.00s]
[0m22:28:44.173536 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m22:28:44.189186 [debug] [Thread-1  ]: Began running node test.northwind.not_null_fact_order_order_key.c4d3d75f90
[0m22:28:44.189186 [info ] [Thread-1  ]: 27 of 29 START test not_null_fact_order_order_key .............................. [RUN]
[0m22:28:44.189186 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.northwind.fact_order, now test.northwind.not_null_fact_order_order_key.c4d3d75f90)
[0m22:28:44.189186 [debug] [Thread-1  ]: Began compiling node test.northwind.not_null_fact_order_order_key.c4d3d75f90
[0m22:28:44.196246 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.not_null_fact_order_order_key.c4d3d75f90"
[0m22:28:44.197296 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_fact_order_order_key.c4d3d75f90 (compile): 22:28:44.192102 => 22:28:44.197296
[0m22:28:44.198269 [debug] [Thread-1  ]: Began executing node test.northwind.not_null_fact_order_order_key.c4d3d75f90
[0m22:28:44.200247 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.not_null_fact_order_order_key.c4d3d75f90"
[0m22:28:44.201244 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.not_null_fact_order_order_key.c4d3d75f90"
[0m22:28:44.202286 [debug] [Thread-1  ]: On test.northwind.not_null_fact_order_order_key.c4d3d75f90: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.not_null_fact_order_order_key.c4d3d75f90"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from PROD.CURATED.fact_order
where order_key is null



      
    ) dbt_internal_test
[0m22:28:44.202286 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:45.013015 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:45.013015 [debug] [Thread-1  ]: Timing info for test.northwind.not_null_fact_order_order_key.c4d3d75f90 (execute): 22:28:44.198269 => 22:28:45.013015
[0m22:28:45.013015 [debug] [Thread-1  ]: On test.northwind.not_null_fact_order_order_key.c4d3d75f90: Close
[0m22:28:45.094361 [info ] [Thread-1  ]: 27 of 29 PASS not_null_fact_order_order_key .................................... [[32mPASS[0m in 0.91s]
[0m22:28:45.094361 [debug] [Thread-1  ]: Finished running node test.northwind.not_null_fact_order_order_key.c4d3d75f90
[0m22:28:45.094361 [debug] [Thread-1  ]: Began running node test.northwind.unique_fact_order_order_key.cc684b4c44
[0m22:28:45.094361 [info ] [Thread-1  ]: 28 of 29 START test unique_fact_order_order_key ................................ [RUN]
[0m22:28:45.094361 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.not_null_fact_order_order_key.c4d3d75f90, now test.northwind.unique_fact_order_order_key.cc684b4c44)
[0m22:28:45.094361 [debug] [Thread-1  ]: Began compiling node test.northwind.unique_fact_order_order_key.cc684b4c44
[0m22:28:45.115522 [debug] [Thread-1  ]: Writing injected SQL for node "test.northwind.unique_fact_order_order_key.cc684b4c44"
[0m22:28:45.116388 [debug] [Thread-1  ]: Timing info for test.northwind.unique_fact_order_order_key.cc684b4c44 (compile): 22:28:45.109935 => 22:28:45.116388
[0m22:28:45.116388 [debug] [Thread-1  ]: Began executing node test.northwind.unique_fact_order_order_key.cc684b4c44
[0m22:28:45.116388 [debug] [Thread-1  ]: Writing runtime sql for node "test.northwind.unique_fact_order_order_key.cc684b4c44"
[0m22:28:45.116388 [debug] [Thread-1  ]: Using snowflake connection "test.northwind.unique_fact_order_order_key.cc684b4c44"
[0m22:28:45.116388 [debug] [Thread-1  ]: On test.northwind.unique_fact_order_order_key.cc684b4c44: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "test.northwind.unique_fact_order_order_key.cc684b4c44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from PROD.CURATED.fact_order
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:28:45.116388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:45.713829 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:45.713829 [debug] [Thread-1  ]: Timing info for test.northwind.unique_fact_order_order_key.cc684b4c44 (execute): 22:28:45.116388 => 22:28:45.713829
[0m22:28:45.713829 [debug] [Thread-1  ]: On test.northwind.unique_fact_order_order_key.cc684b4c44: Close
[0m22:28:45.776821 [info ] [Thread-1  ]: 28 of 29 PASS unique_fact_order_order_key ...................................... [[32mPASS[0m in 0.68s]
[0m22:28:45.776821 [debug] [Thread-1  ]: Finished running node test.northwind.unique_fact_order_order_key.cc684b4c44
[0m22:28:45.792445 [debug] [Thread-1  ]: Began running node model.northwind.preset_obt
[0m22:28:45.792445 [info ] [Thread-1  ]: 29 of 29 START sql table model CURATED.preset_obt .............................. [RUN]
[0m22:28:45.792445 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.northwind.unique_fact_order_order_key.cc684b4c44, now model.northwind.preset_obt)
[0m22:28:45.792445 [debug] [Thread-1  ]: Began compiling node model.northwind.preset_obt
[0m22:28:45.806603 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m22:28:45.806603 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.fact_order
[0m22:28:45.806603 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:28:46.359088 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 1.0 seconds
[0m22:28:46.415815 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m22:28:46.416464 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_product
[0m22:28:46.471560 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.0 seconds
[0m22:28:46.474288 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m22:28:46.474288 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_supplier
[0m22:28:46.531956 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:28:46.539594 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m22:28:46.539594 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_customer
[0m22:28:46.596487 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:28:46.598743 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.preset_obt"
[0m22:28:46.600221 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (compile): 22:28:45.795956 => 22:28:46.599938
[0m22:28:46.600887 [debug] [Thread-1  ]: Began executing node model.northwind.preset_obt
[0m22:28:46.601203 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.preset_obt"
[0m22:28:46.606348 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m22:28:46.608161 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
create or replace transient table PROD.CURATED.preset_obt
         as
        (with fact_order as (
    select * from PROD.CURATED.fact_order
),

dim_product as (
    select * from PROD.CURATED.dim_product
),

dim_supplier as (
    select * from PROD.CURATED.dim_supplier
),

dim_customer as (
    select * from PROD.CURATED.dim_customer
)

select
    fact_order."ORDER_ID",
  fact_order."UNIT_PRICE",
  fact_order."QUANTITY",
  fact_order."NORMAL_RETAIL_VALUE",
  fact_order."DISCOUNT",
  fact_order."DISCOUNT_VALUE",
  fact_order."ACTUAL_RETAIL_VALUE",
  fact_order."PRICE_TYPE",
  fact_order."ORDER_DATE",
  fact_order."SHIPPED_DATE",
  fact_order."REQUIRED_DATE",
  fact_order."DAYS_TO_SHIP",
  fact_order."CUSTOMER_TIER",
  fact_order."UPDATED_AT",
    dim_product."PRODUCT_NAME",
  dim_product."CATEGORY_NAME",
  dim_product."REORDER_LEVEL",
  dim_product."DISCONTINUED",
  dim_product."UNITS_IN_STOCK",
  dim_product."UNITS_ON_ORDER",
    dim_supplier."SUPPLIER_ID",
  dim_supplier."SUPPLIER_COMPANY_NAME",
  dim_supplier."SUPPLIER_CONTACT_NAME",
  dim_supplier."SUPPLIER_CONTACT_TITLE",
  dim_supplier."SUPPLIER_ADDRESS",
  dim_supplier."SUPPLIER_CITY",
  dim_supplier."SUPPLIER_REGION",
  dim_supplier."SUPPLIER_POSTAL_CODE",
  dim_supplier."SUPPLIER_COUNTRY",
  dim_supplier."SUPPLIER_PHONE",
    dim_customer."CUSTOMER_COMPANY_NAME",
  dim_customer."CUSTOMER_CONTACT_NAME",
  dim_customer."CUSTOMER_CONTACT_TITLE",
  dim_customer."CUSTOMER_ADDRESS",
  dim_customer."CUSTOMER_CITY",
  dim_customer."CUSTOMER_REGION",
  dim_customer."CUSTOMER_POSTAL_CODE",
  dim_customer."CUSTOMER_COUNTRY",
  dim_customer."CUSTOMER_PHONE"
from fact_order
left join dim_product on fact_order.product_key = dim_product.product_key
left join dim_supplier on dim_product.supplier_key = dim_supplier.supplier_key
left join dim_customer on fact_order.customer_key = dim_customer.customer_key
        );
[0m22:28:47.222553 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:47.240845 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (execute): 22:28:46.601203 => 22:28:47.238193
[0m22:28:47.240845 [debug] [Thread-1  ]: On model.northwind.preset_obt: Close
[0m22:28:47.300774 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513da4bf-654d-46a0-94bf-3f4cdf632b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5815AD90>]}
[0m22:28:47.300774 [info ] [Thread-1  ]: 29 of 29 OK created sql table model CURATED.preset_obt ......................... [[32mSUCCESS 1[0m in 1.51s]
[0m22:28:47.300774 [debug] [Thread-1  ]: Finished running node model.northwind.preset_obt
[0m22:28:47.300774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:47.316399 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m22:28:47.316399 [debug] [MainThread]: Connection 'list_PROD_CURATED' was properly closed.
[0m22:28:47.316399 [debug] [MainThread]: Connection 'model.northwind.preset_obt' was properly closed.
[0m22:28:47.316399 [info ] [MainThread]: 
[0m22:28:47.316399 [info ] [MainThread]: Finished running 13 table models, 1 snapshot, 14 tests, 1 incremental model in 0 hours 0 minutes and 37.84 seconds (37.84s).
[0m22:28:47.319981 [debug] [MainThread]: Command end result
[0m22:28:47.325514 [info ] [MainThread]: 
[0m22:28:47.325514 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:28:47.325514 [info ] [MainThread]: 
[0m22:28:47.325514 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 TOTAL=29
[0m22:28:47.325514 [debug] [MainThread]: Command `dbt build` succeeded at 22:28:47.325514 after 39.41 seconds
[0m22:28:47.325514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F2AA90100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F57B190A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F57B19040>]}
[0m22:28:47.325514 [debug] [MainThread]: Flushing usage events
[0m22:29:20.299583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A39D7C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E0A7FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E0A7FD0>]}


============================== 22:29:20.299583 | 7fa7f8fc-a415-48a0-b3d5-e292354413ff ==============================
[0m22:29:20.299583 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:29:20.299583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fact_order', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:29:21.221801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fa7f8fc-a415-48a0-b3d5-e292354413ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3E0A7F70>]}
[0m22:29:21.239237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fa7f8fc-a415-48a0-b3d5-e292354413ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A66C386D0>]}
[0m22:29:21.239237 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:29:21.255711 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:29:21.362591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:29:21.377649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:29:21.377649 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.serving
[0m22:29:21.377649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fa7f8fc-a415-48a0-b3d5-e292354413ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A66F3B0D0>]}
[0m22:29:21.397696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fa7f8fc-a415-48a0-b3d5-e292354413ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A66C862E0>]}
[0m22:29:21.397696 [info ] [MainThread]: Found 14 models, 14 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m22:29:21.397696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fa7f8fc-a415-48a0-b3d5-e292354413ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A66C86FD0>]}
[0m22:29:21.401248 [info ] [MainThread]: 
[0m22:29:21.401248 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:29:21.401248 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m22:29:21.414116 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m22:29:21.414116 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m22:29:21.414116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:22.343565 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:29:22.343565 [debug] [ThreadPool]: On list_PROD: Close
[0m22:29:22.405880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_CURATED'
[0m22:29:22.421588 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m22:29:22.421588 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m22:29:22.421588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:23.226151 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m22:29:23.226151 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m22:29:23.304965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_CURATED, now list_PROD_STAGING)
[0m22:29:23.304965 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m22:29:23.304965 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m22:29:23.304965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:23.860425 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:29:23.860425 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m22:29:23.927059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_SNAPSHOT)
[0m22:29:23.927059 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m22:29:23.927059 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m22:29:23.927059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:24.495595 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:29:24.495595 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m22:29:24.574144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fa7f8fc-a415-48a0-b3d5-e292354413ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A666DAFA0>]}
[0m22:29:24.574144 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:29:24.574144 [info ] [MainThread]: 
[0m22:29:24.589770 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m22:29:24.589770 [info ] [Thread-1  ]: 1 of 1 START sql incremental model CURATED.fact_order .......................... [RUN]
[0m22:29:24.589770 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m22:29:24.597041 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m22:29:24.617420 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m22:29:24.617420 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 22:29:24.597041 => 22:29:24.617420
[0m22:29:24.617420 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m22:29:24.650932 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:29:24.650932 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
create or replace  temporary view PROD.CURATED.fact_order__dbt_tmp
  
   as (
    

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from PROD.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier,
    stg_order_detail.updated_at
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


    where stg_order_detail.updated_at > (select max(updated_at) from PROD.CURATED.fact_order)

  );
[0m22:29:24.650932 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:29:25.333638 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:29:25.349309 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:29:25.349309 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m22:29:25.412320 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:29:25.412320 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:29:25.412320 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order
[0m22:29:25.479991 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:29:25.489937 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:29:25.490978 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table PROD.CURATED.fact_order__dbt_tmp
[0m22:29:25.543844 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:29:25.543844 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:29:25.543844 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
describe table "PROD"."CURATED"."FACT_ORDER"
[0m22:29:25.590664 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 0.0 seconds
[0m22:29:25.609302 [debug] [Thread-1  ]: 
    In "PROD"."CURATED"."FACT_ORDER":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:29:25.622311 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m22:29:25.622311 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:29:25.622311 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
-- back compat for old kwarg name
  
  begin;
[0m22:29:25.732127 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:29:25.732127 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:29:25.732127 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
merge into PROD.CURATED.fact_order as DBT_INTERNAL_DEST
        using PROD.CURATED.fact_order__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_key = DBT_INTERNAL_DEST.order_key
            )

    
    when matched then update set
        "ORDER_KEY" = DBT_INTERNAL_SOURCE."ORDER_KEY","PRODUCT_KEY" = DBT_INTERNAL_SOURCE."PRODUCT_KEY","CUSTOMER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_KEY","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","UNIT_PRICE" = DBT_INTERNAL_SOURCE."UNIT_PRICE","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","NORMAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."NORMAL_RETAIL_VALUE","DISCOUNT" = DBT_INTERNAL_SOURCE."DISCOUNT","DISCOUNT_VALUE" = DBT_INTERNAL_SOURCE."DISCOUNT_VALUE","ACTUAL_RETAIL_VALUE" = DBT_INTERNAL_SOURCE."ACTUAL_RETAIL_VALUE","PRICE_TYPE" = DBT_INTERNAL_SOURCE."PRICE_TYPE","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","SHIPPED_DATE" = DBT_INTERNAL_SOURCE."SHIPPED_DATE","REQUIRED_DATE" = DBT_INTERNAL_SOURCE."REQUIRED_DATE","DAYS_TO_SHIP" = DBT_INTERNAL_SOURCE."DAYS_TO_SHIP","CUSTOMER_TIER_KEY" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER_KEY","CUSTOMER_TIER" = DBT_INTERNAL_SOURCE."CUSTOMER_TIER","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")
    values
        ("ORDER_KEY", "PRODUCT_KEY", "CUSTOMER_KEY", "ORDER_ID", "PRODUCT_ID", "UNIT_PRICE", "QUANTITY", "NORMAL_RETAIL_VALUE", "DISCOUNT", "DISCOUNT_VALUE", "ACTUAL_RETAIL_VALUE", "PRICE_TYPE", "ORDER_DATE", "SHIPPED_DATE", "REQUIRED_DATE", "DAYS_TO_SHIP", "CUSTOMER_TIER_KEY", "CUSTOMER_TIER", "UPDATED_AT")

;
[0m22:29:26.297748 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m22:29:26.298492 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:29:26.298716 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
COMMIT
[0m22:29:26.478653 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:29:26.488763 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:29:26.489339 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
drop view if exists PROD.CURATED.fact_order__dbt_tmp cascade
[0m22:29:26.556619 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:29:26.571253 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 22:29:24.617420 => 22:29:26.571045
[0m22:29:26.571689 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m22:29:26.636085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa7f8fc-a415-48a0-b3d5-e292354413ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A66F03550>]}
[0m22:29:26.636085 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model CURATED.fact_order ..................... [[32mSUCCESS 0[0m in 2.05s]
[0m22:29:26.636085 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m22:29:26.641979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:26.641979 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m22:29:26.641979 [debug] [MainThread]: Connection 'list_PROD_SNAPSHOT' was properly closed.
[0m22:29:26.641979 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m22:29:26.641979 [info ] [MainThread]: 
[0m22:29:26.641979 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m22:29:26.647724 [debug] [MainThread]: Command end result
[0m22:29:26.656021 [info ] [MainThread]: 
[0m22:29:26.656021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:29:26.656021 [info ] [MainThread]: 
[0m22:29:26.656021 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:29:26.664523 [debug] [MainThread]: Command `dbt run` succeeded at 22:29:26.664523 after 6.38 seconds
[0m22:29:26.664523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A39D7C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A66C386D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6748E520>]}
[0m22:29:26.664523 [debug] [MainThread]: Flushing usage events
[0m22:30:52.442293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296FB2EC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296FF647FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296FF647FD0>]}


============================== 22:30:52.449425 | 1f13d994-f924-4dac-a9b9-0afbacf27d04 ==============================
[0m22:30:52.449425 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:30:52.449425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_order', 'send_anonymous_usage_stats': 'True'}
[0m22:30:53.764354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f13d994-f924-4dac-a9b9-0afbacf27d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296FF647F70>]}
[0m22:30:53.764354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f13d994-f924-4dac-a9b9-0afbacf27d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296A8181F40>]}
[0m22:30:53.764354 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:30:53.780009 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:30:53.918355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:30:53.919359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:30:53.920345 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m22:30:53.925350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f13d994-f924-4dac-a9b9-0afbacf27d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296A84AB0D0>]}
[0m22:30:53.937269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f13d994-f924-4dac-a9b9-0afbacf27d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296A81F72E0>]}
[0m22:30:53.937269 [info ] [MainThread]: Found 14 models, 14 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m22:30:53.937269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f13d994-f924-4dac-a9b9-0afbacf27d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296A81F7FD0>]}
[0m22:30:53.937269 [info ] [MainThread]: 
[0m22:30:53.937269 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:30:53.937269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m22:30:53.953988 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m22:30:53.953988 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m22:30:53.953988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:55.255783 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:30:55.255783 [debug] [ThreadPool]: On list_PROD: Close
[0m22:30:55.334373 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_CURATED'
[0m22:30:55.350092 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m22:30:55.350092 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m22:30:55.350092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:56.001343 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:30:56.001343 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m22:30:56.080609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_CURATED, now list_PROD_STAGING)
[0m22:30:56.096232 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m22:30:56.096232 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m22:30:56.096232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:56.709905 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:30:56.724926 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m22:30:56.788204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_SNAPSHOT)
[0m22:30:56.788204 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m22:30:56.795963 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m22:30:56.795963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:57.403324 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:30:57.403324 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m22:30:57.481572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f13d994-f924-4dac-a9b9-0afbacf27d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296A81818E0>]}
[0m22:30:57.481572 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:30:57.481572 [info ] [MainThread]: 
[0m22:30:57.501314 [debug] [Thread-1  ]: Began running node model.northwind.fact_order
[0m22:30:57.501314 [info ] [Thread-1  ]: 1 of 1 START sql incremental model CURATED.fact_order .......................... [RUN]
[0m22:30:57.501314 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.fact_order'
[0m22:30:57.501314 [debug] [Thread-1  ]: Began compiling node model.northwind.fact_order
[0m22:30:57.524982 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.fact_order"
[0m22:30:57.524982 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (compile): 22:30:57.501314 => 22:30:57.524982
[0m22:30:57.524982 [debug] [Thread-1  ]: Began executing node model.northwind.fact_order
[0m22:30:57.558811 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.fact_order"
[0m22:30:57.574673 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:30:57.574673 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
create or replace transient table PROD.CURATED.fact_order
         as
        (

with stg_order as (
    select
        cast(order_id as integer) as order_id,
        customer_id,
        ship_city,
        ship_postal_code,
        date(required_date) as required_date,
        freight,
        ship_region,
        date(order_date) as order_date,
        date(shipped_date) as shipped_date,
        ship_via,
        ship_address,
        ship_name,
        ship_country,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order
),

stg_order_detail as (
    select
        cast(order_id as integer) as order_id,
        cast(product_id as integer) as product_id,
        cast(unit_price as numeric(38,2)) as unit_price,
        cast(quantity as integer) as quantity,
        cast(discount as numeric(38,2)) as discount,
        cast(updated_at as timestamp) as updated_at
    from PROD.STAGING.stg_order_detail
),

dim_customer_tier as (
    select 
        customer_tier_key,
        customer_id,
        customer_tier_id,
        customer_tier,
        valid_from,
        valid_to
    from PROD.CURATED.dim_customer_tier
)

select
    
    
md5(cast(coalesce(cast(stg_order.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_key,
    
    
md5(cast(coalesce(cast(stg_order_detail.product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    
    
md5(cast(coalesce(cast(stg_order.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    stg_order.order_id,
    stg_order_detail.product_id,
    stg_order_detail.unit_price,
    stg_order_detail.quantity,
    stg_order_detail.unit_price * stg_order_detail.quantity as normal_retail_value,
    stg_order_detail.discount,
    stg_order_detail.discount * stg_order_detail.unit_price * stg_order_detail.quantity as discount_value,
    stg_order_detail.unit_price * stg_order_detail.quantity * (1 - stg_order_detail.discount) as actual_retail_value,
    case when stg_order_detail.discount > 0 then 'Discounted' else 'Regular' end as price_type,
    stg_order.order_date,
    stg_order.shipped_date,
    stg_order.required_date,
    datediff(day, order_date, shipped_date) as days_to_ship,
    dim_customer_tier.customer_tier_key,
    dim_customer_tier.customer_tier,
    stg_order_detail.updated_at
from stg_order
inner join stg_order_detail on stg_order.order_id = stg_order_detail.order_id
left join dim_customer_tier on stg_order.customer_id = dim_customer_tier.customer_id
and stg_order.order_date >= dim_customer_tier.valid_from
and stg_order.order_date < coalesce(dim_customer_tier.valid_to, cast('2999-01-01' as date)) 


        );
[0m22:30:57.575743 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:30:59.464695 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:30:59.475691 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.fact_order"
[0m22:30:59.475691 [debug] [Thread-1  ]: On model.northwind.fact_order: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.fact_order"} */
drop view if exists PROD.CURATED.fact_order__dbt_tmp cascade
[0m22:30:59.534327 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:30:59.549863 [debug] [Thread-1  ]: Timing info for model.northwind.fact_order (execute): 22:30:57.524982 => 22:30:59.549863
[0m22:30:59.549863 [debug] [Thread-1  ]: On model.northwind.fact_order: Close
[0m22:30:59.629048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f13d994-f924-4dac-a9b9-0afbacf27d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296A885C0A0>]}
[0m22:30:59.629048 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model CURATED.fact_order ..................... [[32mSUCCESS 1[0m in 2.13s]
[0m22:30:59.629048 [debug] [Thread-1  ]: Finished running node model.northwind.fact_order
[0m22:30:59.629048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:59.629048 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m22:30:59.629048 [debug] [MainThread]: Connection 'list_PROD_SNAPSHOT' was properly closed.
[0m22:30:59.629048 [debug] [MainThread]: Connection 'model.northwind.fact_order' was properly closed.
[0m22:30:59.629048 [info ] [MainThread]: 
[0m22:30:59.640843 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.69 seconds (5.69s).
[0m22:30:59.641832 [debug] [MainThread]: Command end result
[0m22:30:59.654126 [info ] [MainThread]: 
[0m22:30:59.654126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:30:59.654126 [info ] [MainThread]: 
[0m22:30:59.654126 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:30:59.654126 [debug] [MainThread]: Command `dbt run` succeeded at 22:30:59.654126 after 7.25 seconds
[0m22:30:59.654126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296FB2EC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296A8474E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296A84748E0>]}
[0m22:30:59.654126 [debug] [MainThread]: Flushing usage events
[0m22:32:11.899983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911F38C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191236E7FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191236E7FD0>]}


============================== 22:32:11.904076 | 41d97dfb-9690-4223-8227-07ca22c6ba23 ==============================
[0m22:32:11.904076 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:32:11.904076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind\\logs', 'profiles_dir': 'C:\\Users\\maryc\\Code\\dec_northwind\\transform\\dbt\\northwind', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select preset_obt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:32:12.872186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41d97dfb-9690-4223-8227-07ca22c6ba23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191236E7F70>]}
[0m22:32:12.876806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41d97dfb-9690-4223-8227-07ca22c6ba23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914C220A60>]}
[0m22:32:12.876806 [info ] [MainThread]: Registered adapter: snowflake=1.6.2
[0m22:32:12.897205 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:32:13.039764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:32:13.040793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:32:13.041763 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.serving
- models.staging
[0m22:32:13.047849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41d97dfb-9690-4223-8227-07ca22c6ba23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914C54A0D0>]}
[0m22:32:13.064181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41d97dfb-9690-4223-8227-07ca22c6ba23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914C2992E0>]}
[0m22:32:13.064181 [info ] [MainThread]: Found 14 models, 14 tests, 1 snapshot, 22 sources, 0 exposures, 0 metrics, 605 macros, 0 groups, 0 semantic models
[0m22:32:13.065182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41d97dfb-9690-4223-8227-07ca22c6ba23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914C299FD0>]}
[0m22:32:13.066746 [info ] [MainThread]: 
[0m22:32:13.067692 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:32:13.069811 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD'
[0m22:32:13.081394 [debug] [ThreadPool]: Using snowflake connection "list_PROD"
[0m22:32:13.082374 [debug] [ThreadPool]: On list_PROD: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD"} */
show terse schemas in database PROD
    limit 10000
[0m22:32:13.083393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:14.180830 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:32:14.180830 [debug] [ThreadPool]: On list_PROD: Close
[0m22:32:14.257033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROD_CURATED'
[0m22:32:14.259539 [debug] [ThreadPool]: Using snowflake connection "list_PROD_CURATED"
[0m22:32:14.259539 [debug] [ThreadPool]: On list_PROD_CURATED: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_CURATED"} */
show terse objects in PROD.CURATED limit 10000
[0m22:32:14.267046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:14.897270 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m22:32:14.906841 [debug] [ThreadPool]: On list_PROD_CURATED: Close
[0m22:32:14.968622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_CURATED, now list_PROD_STAGING)
[0m22:32:14.968622 [debug] [ThreadPool]: Using snowflake connection "list_PROD_STAGING"
[0m22:32:14.968622 [debug] [ThreadPool]: On list_PROD_STAGING: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_STAGING"} */
show terse objects in PROD.STAGING limit 10000
[0m22:32:14.968622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:32:15.607872 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:32:15.616781 [debug] [ThreadPool]: On list_PROD_STAGING: Close
[0m22:32:15.687782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROD_STAGING, now list_PROD_SNAPSHOT)
[0m22:32:15.687782 [debug] [ThreadPool]: Using snowflake connection "list_PROD_SNAPSHOT"
[0m22:32:15.687782 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "connection_name": "list_PROD_SNAPSHOT"} */
show terse objects in PROD.SNAPSHOT limit 10000
[0m22:32:15.687782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:32:16.973219 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:16.973219 [debug] [ThreadPool]: On list_PROD_SNAPSHOT: Close
[0m22:32:17.036325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41d97dfb-9690-4223-8227-07ca22c6ba23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914C2208E0>]}
[0m22:32:17.036325 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:32:17.051949 [info ] [MainThread]: 
[0m22:32:17.051949 [debug] [Thread-1  ]: Began running node model.northwind.preset_obt
[0m22:32:17.051949 [info ] [Thread-1  ]: 1 of 1 START sql table model CURATED.preset_obt ................................ [RUN]
[0m22:32:17.051949 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.northwind.preset_obt'
[0m22:32:17.051949 [debug] [Thread-1  ]: Began compiling node model.northwind.preset_obt
[0m22:32:17.081110 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m22:32:17.090722 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.fact_order
[0m22:32:17.090722 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:32:17.728994 [debug] [Thread-1  ]: SQL status: SUCCESS 19 in 1.0 seconds
[0m22:32:17.744104 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m22:32:17.744104 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_product
[0m22:32:17.811032 [debug] [Thread-1  ]: SQL status: SUCCESS 9 in 0.0 seconds
[0m22:32:17.811032 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m22:32:17.811032 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_supplier
[0m22:32:17.879242 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:32:17.897962 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m22:32:17.898933 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
describe table PROD.CURATED.dim_customer
[0m22:32:17.959297 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m22:32:17.962078 [debug] [Thread-1  ]: Writing injected SQL for node "model.northwind.preset_obt"
[0m22:32:17.964226 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (compile): 22:32:17.061366 => 22:32:17.963098
[0m22:32:17.965190 [debug] [Thread-1  ]: Began executing node model.northwind.preset_obt
[0m22:32:17.994291 [debug] [Thread-1  ]: Writing runtime sql for node "model.northwind.preset_obt"
[0m22:32:18.011369 [debug] [Thread-1  ]: Using snowflake connection "model.northwind.preset_obt"
[0m22:32:18.011369 [debug] [Thread-1  ]: On model.northwind.preset_obt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "northwind", "target_name": "prod", "node_id": "model.northwind.preset_obt"} */
create or replace transient table PROD.CURATED.preset_obt
         as
        (with fact_order as (
    select * from PROD.CURATED.fact_order
),

dim_product as (
    select * from PROD.CURATED.dim_product
),

dim_supplier as (
    select * from PROD.CURATED.dim_supplier
),

dim_customer as (
    select * from PROD.CURATED.dim_customer
)

select
    fact_order."ORDER_ID",
  fact_order."UNIT_PRICE",
  fact_order."QUANTITY",
  fact_order."NORMAL_RETAIL_VALUE",
  fact_order."DISCOUNT",
  fact_order."DISCOUNT_VALUE",
  fact_order."ACTUAL_RETAIL_VALUE",
  fact_order."PRICE_TYPE",
  fact_order."ORDER_DATE",
  fact_order."SHIPPED_DATE",
  fact_order."REQUIRED_DATE",
  fact_order."DAYS_TO_SHIP",
  fact_order."CUSTOMER_TIER",
  fact_order."UPDATED_AT",
    dim_product."PRODUCT_NAME",
  dim_product."CATEGORY_NAME",
  dim_product."REORDER_LEVEL",
  dim_product."DISCONTINUED",
  dim_product."UNITS_IN_STOCK",
  dim_product."UNITS_ON_ORDER",
    dim_supplier."SUPPLIER_ID",
  dim_supplier."SUPPLIER_COMPANY_NAME",
  dim_supplier."SUPPLIER_CONTACT_NAME",
  dim_supplier."SUPPLIER_CONTACT_TITLE",
  dim_supplier."SUPPLIER_ADDRESS",
  dim_supplier."SUPPLIER_CITY",
  dim_supplier."SUPPLIER_REGION",
  dim_supplier."SUPPLIER_POSTAL_CODE",
  dim_supplier."SUPPLIER_COUNTRY",
  dim_supplier."SUPPLIER_PHONE",
    dim_customer."CUSTOMER_COMPANY_NAME",
  dim_customer."CUSTOMER_CONTACT_NAME",
  dim_customer."CUSTOMER_CONTACT_TITLE",
  dim_customer."CUSTOMER_ADDRESS",
  dim_customer."CUSTOMER_CITY",
  dim_customer."CUSTOMER_REGION",
  dim_customer."CUSTOMER_POSTAL_CODE",
  dim_customer."CUSTOMER_COUNTRY",
  dim_customer."CUSTOMER_PHONE"
from fact_order
left join dim_product on fact_order.product_key = dim_product.product_key
left join dim_supplier on dim_product.supplier_key = dim_supplier.supplier_key
left join dim_customer on fact_order.customer_key = dim_customer.customer_key
        );
[0m22:32:19.408778 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:19.455765 [debug] [Thread-1  ]: Timing info for model.northwind.preset_obt (execute): 22:32:17.966098 => 22:32:19.455765
[0m22:32:19.455765 [debug] [Thread-1  ]: On model.northwind.preset_obt: Close
[0m22:32:19.534352 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41d97dfb-9690-4223-8227-07ca22c6ba23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914CA68BE0>]}
[0m22:32:19.534352 [info ] [Thread-1  ]: 1 of 1 OK created sql table model CURATED.preset_obt ........................... [[32mSUCCESS 1[0m in 2.48s]
[0m22:32:19.534352 [debug] [Thread-1  ]: Finished running node model.northwind.preset_obt
[0m22:32:19.534352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:32:19.550070 [debug] [MainThread]: Connection 'list_PROD' was properly closed.
[0m22:32:19.553672 [debug] [MainThread]: Connection 'list_PROD_SNAPSHOT' was properly closed.
[0m22:32:19.554567 [debug] [MainThread]: Connection 'model.northwind.preset_obt' was properly closed.
[0m22:32:19.554567 [info ] [MainThread]: 
[0m22:32:19.554567 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.49 seconds (6.49s).
[0m22:32:19.554567 [debug] [MainThread]: Command end result
[0m22:32:19.585936 [info ] [MainThread]: 
[0m22:32:19.596057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:32:19.596057 [info ] [MainThread]: 
[0m22:32:19.596057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:32:19.602170 [debug] [MainThread]: Command `dbt run` succeeded at 22:32:19.602170 after 7.72 seconds
[0m22:32:19.602170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911F38C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914CA1C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001914CA1CF10>]}
[0m22:32:19.602170 [debug] [MainThread]: Flushing usage events
